{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"OPNsense Configuration Processor","text":"<p>Welcome to the OPNsense Configuration Processor documentation! This CLI tool helps you process OPNsense <code>config.xml</code> files and convert them to human-readable markdown format.</p>"},{"location":"#features","title":"Features","text":"<ul> <li>\ud83d\udd27 Parse OPNsense XML configurations - Process complex configuration files with ease</li> <li>\u2705 Configuration Validation - Comprehensive validation with detailed error reporting</li> <li>\ud83d\udcdd Convert to Markdown - Generate human-readable documentation</li> <li>\ud83c\udfa8 Terminal Display - View results with syntax highlighting in your terminal</li> <li>\ud83d\udcbe Export to Files - Save processed configurations to markdown files</li> <li>\ud83d\udd0c Offline Operation - Works completely offline, no external dependencies</li> <li>\ud83d\ude80 Streaming Processing - Memory-efficient handling of large configuration files</li> </ul>"},{"location":"#quick-start","title":"Quick Start","text":"<pre><code># Convert a configuration file to markdown\nopndossier convert config.xml -o output.md\n\n# Display the result in terminal with syntax highlighting\nopndossier display config.xml\n\n# Get help for any command\nopndossier --help\n</code></pre>"},{"location":"#project-philosophy","title":"Project Philosophy","text":"<p>This tool follows the operator-focused philosophy:</p> <ul> <li>Built for operators, by operators - Intuitive workflows designed for network administrators</li> <li>Offline-first architecture - Functions in airgapped environments</li> <li>Structured data approach - Versioned, portable, and auditable outputs</li> <li>Framework-first development - Leverages established Go libraries and patterns</li> </ul>"},{"location":"#architecture","title":"Architecture","text":"<p>The tool uses a layered CLI architecture built with modern Go libraries:</p> Component Technology Purpose CLI Framework Cobra Command structure &amp; argument parsing Configuration Viper Layered configuration (files, env, flags) CLI Enhancement Charm Fang Enhanced UX layer (styled help, completion) Structured Logging Charm Log Structured, leveled logging Terminal Styling Charm Lipgloss Styled terminal output formatting Markdown Rendering Charm Glamour Markdown rendering in terminal XML Processing Go's built-in <code>encoding/xml</code> Native XML parsing and validation"},{"location":"#data-model-architecture","title":"Data Model Architecture","text":"<p>opnDossier uses a hierarchical model structure that organizes OPNsense configuration into logical domains:</p> <ul> <li>System Domain: Core system settings, users, groups, system services</li> <li>Network Domain: Interfaces, routing, VLANs, network addressing</li> <li>Security Domain: Firewall rules, NAT, VPN, certificates</li> <li>Services Domain: DNS, DHCP, monitoring, web services</li> </ul> <p>This hierarchical approach provides logical organization, improved maintainability, domain-specific validation, and better extensibility. See the Model Refactor Documentation for detailed information.</p>"},{"location":"#processor-workflow","title":"Processor Workflow","text":"<p>The processor implements a comprehensive four-phase pipeline:</p> <ol> <li>Normalize: Fill defaults, canonicalize addresses, sort for determinism</li> <li>Validate: Struct tag validation, custom checks, cross-field validation</li> <li>Analyze: Dead rule detection, security analysis, performance checks</li> <li>Transform: Multi-format output (Markdown, JSON, YAML)</li> </ol> <p>See the Sample Report for an example of the comprehensive analysis output.</p>"},{"location":"#configuration-management","title":"Configuration Management","text":"<p>opnDossier implements comprehensive configuration management with Viper:</p> <p>Precedence Order (highest to lowest):</p> <ol> <li>Command-line flags</li> <li>Environment variables (<code>OPNDOSSIER_*</code>)</li> <li>Configuration file (<code>~/.opnDossier.yaml</code>)</li> <li>Default values</li> </ol> <p>Configuration Options:</p> <ul> <li><code>verbose</code>: Enable debug logging</li> <li><code>quiet</code>: Suppress all output except errors</li> <li><code>log_level</code>: Set log level (debug, info, warn, error)</li> <li><code>log_format</code>: Set log format (text, json)</li> <li><code>input_file</code>: Default input file path</li> <li><code>output_file</code>: Default output file path</li> </ul>"},{"location":"#validation-error-handling","title":"Validation &amp; Error Handling","text":"<p>opnDossier includes comprehensive validation capabilities:</p>"},{"location":"#validation-features","title":"Validation Features","text":"<ul> <li>Structure Validation - Ensures required fields are present (hostname, domain, etc.)</li> <li>Data Type Validation - Verifies IP addresses, subnet masks, and network configurations</li> <li>Cross-Field Validation - Checks relationships between configuration elements</li> <li>Streaming Limits - Handles large files efficiently with memory-conscious processing</li> </ul>"},{"location":"#error-output-examples","title":"Error Output Examples","text":"<p>Parse Error:</p> <pre><code>parse error at line 45, column 12: XML syntax error: expected element name after &lt;\n</code></pre> <p>Validation Error:</p> <pre><code>validation error at opnsense.system.hostname: hostname is required\n</code></pre> <p>Aggregated Report:</p> <pre><code>validation failed with 3 errors: hostname is required (and 2 more)\n  - opnsense.system.hostname: hostname is required\n  - opnsense.system.domain: domain is required\n  - opnsense.interfaces.lan.subnet: subnet mask '35' must be valid (0-32)\n</code></pre>"},{"location":"#getting-started","title":"Getting Started","text":"<p>Check out the Installation Guide to get started, or dive into the Usage Guide to learn how to use the tool effectively.</p>"},{"location":"#documentation","title":"Documentation","text":""},{"location":"#user-documentation","title":"User Documentation","text":"<ul> <li>User Guide - Installation, configuration, and usage instructions</li> <li>Examples - Comprehensive usage examples and common workflows</li> <li>About - Project overview and features</li> <li>API Reference - Command-line interface and API documentation</li> </ul>"},{"location":"#developer-documentation","title":"Developer Documentation","text":"<ul> <li>Architecture - System design and component interactions</li> <li>Development Standards - Go coding standards and project structure</li> <li>Release Process - How to prepare and release new versions</li> <li>Developer Guide - Additional development resources</li> </ul> <p>For AI agent coding standards and workflows, see AGENTS.md in the root directory.</p>"},{"location":"#migration-compliance","title":"Migration &amp; Compliance","text":"<ul> <li>Migration Guide - General migration instructions</li> <li>Migration - Version-specific migration details</li> <li>Migration Guide v3.7 - Migration guide for v3.7 release</li> <li>Template Function Migration - Template engine migration</li> <li>Compliance Standards - Security and compliance framework documentation</li> <li>CIS-like Firewall Reference - Firewall configuration reference</li> </ul>"},{"location":"#technical-research","title":"Technical Research","text":"<ul> <li>Charmbracelet Ecosystem Compatibility Research - Dependency analysis, version matrix, breaking changes, and upgrade recommendations for the Charmbracelet package ecosystem</li> </ul>"},{"location":"#contributing","title":"Contributing","text":"<p>Interested in contributing? See our Contributing Guide for information on how to get involved with the project.</p> <p>This documentation is built with MkDocs Material and follows our established documentation standards.</p>"},{"location":"about/","title":"About OPNsense Configuration Processor","text":""},{"location":"about/#project-overview","title":"Project Overview","text":"<p>The OPNsense Configuration Processor is a command-line tool designed to bridge the gap between complex XML configuration files and human-readable documentation. Built specifically for network operators and administrators working with OPNsense firewalls, this tool transforms cryptic XML configurations into clear, structured markdown documentation.</p>"},{"location":"about/#why-this-tool-exists","title":"Why This Tool Exists","text":"<p>Network administrators often need to:</p> <ul> <li>Understand complex configurations quickly during troubleshooting</li> <li>Document network setups for compliance and knowledge sharing</li> <li>Review configuration changes in a human-readable format</li> <li>Work in offline environments where web-based tools aren't available</li> </ul> <p>Traditional approaches involve manually parsing XML files or using web-based converters that require internet connectivity. This tool solves these problems by providing a fast, offline, command-line solution.</p>"},{"location":"about/#core-principles","title":"Core Principles","text":""},{"location":"about/#operator-focused-design","title":"Operator-Focused Design","text":"<p>Every feature is designed with the network operator in mind. Commands are intuitive, output is clear, and workflows match real-world operational needs.</p>"},{"location":"about/#offline-first-architecture","title":"Offline-First Architecture","text":"<p>The tool functions completely offline, making it suitable for secure, airgapped environments where many network operations take place.</p>"},{"location":"about/#structured-data-philosophy","title":"Structured Data Philosophy","text":"<p>All output is structured, versioned, and portable, enabling automated processing and reliable documentation workflows.</p>"},{"location":"about/#framework-first-development","title":"Framework-First Development","text":"<p>Rather than reinventing the wheel, the tool leverages established Go libraries and follows proven architectural patterns.</p>"},{"location":"about/#technology-stack","title":"Technology Stack","text":"<p>Built with modern Go practices and established libraries:</p> <ul> <li>Go - Primary programming language</li> <li>Cobra - CLI framework for command organization</li> <li>Viper - Configuration management</li> <li>Fang - Enhanced CLI experience</li> <li>Lipgloss - Terminal styling and formatting</li> <li>Glamour - Markdown rendering in terminal</li> </ul>"},{"location":"about/#development-standards","title":"Development Standards","text":"<p>The project follows comprehensive coding standards outlined in our AGENTS.md file, including:</p> <ul> <li>Google Go Style Guide compliance</li> <li>Comprehensive testing with &gt;80% coverage</li> <li>Structured logging and error handling</li> <li>Security-first development practices</li> <li>Offline-first architecture principles</li> </ul>"},{"location":"about/#license","title":"License","text":"<p>This project is open source and available under the MIT License.</p>"},{"location":"about/#contributing","title":"Contributing","text":"<p>We welcome contributions! Please see our Contributing Guide for details on how to get involved.</p> <p>Built with care for network operators everywhere.</p>"},{"location":"api/","title":"Markdown Builder API Reference","text":""},{"location":"api/#overview","title":"Overview","text":"<p>The MarkdownBuilder provides a programmatic interface for generating security audit reports from OPNsense configurations. All methods are designed with red team operations in mind, supporting offline usage and output obfuscation.</p> <p>The programmatic API is designed to deliver significantly faster generation with reduced memory usage compared to template-based generation, while providing full compile-time type safety. Performance characteristics can be measured using the comparative benchmarks in <code>internal/converter/markdown_bench_test.go</code>.</p>"},{"location":"api/#core-interface","title":"Core Interface","text":"<pre><code>// ReportBuilder interface defines the contract for programmatic report generation.\ntype ReportBuilder interface {\n    // Core section builders\n    BuildSystemSection(data *model.OpnSenseDocument) string\n    BuildNetworkSection(data *model.OpnSenseDocument) string\n    BuildSecuritySection(data *model.OpnSenseDocument) string\n    BuildServicesSection(data *model.OpnSenseDocument) string\n\n    // Component builders\n    BuildFirewallRulesTable(rules []model.Rule) *markdown.TableSet\n    BuildInterfaceTable(interfaces model.Interfaces) *markdown.TableSet\n    BuildUserTable(users []model.User) *markdown.TableSet\n    BuildGroupTable(groups []model.Group) *markdown.TableSet\n    BuildSysctlTable(sysctl []model.SysctlItem) *markdown.TableSet\n\n    // Report generation\n    BuildStandardReport(data *model.OpnSenseDocument) (string, error)\n    BuildCustomReport(data *model.OpnSenseDocument, options BuildOptions) (string, error)\n}\n</code></pre>"},{"location":"api/#method-categories","title":"Method Categories","text":""},{"location":"api/#security-assessment-methods","title":"Security Assessment Methods","text":"<p>These methods provide security analysis and risk assessment capabilities.</p> <pre><code>// CalculateSecurityScore computes an overall security score (0-100) based on configuration analysis\nfunc (b *MarkdownBuilder) CalculateSecurityScore(data *model.OpnSenseDocument) int\n\n// AssessRiskLevel converts severity strings to human-readable risk levels with emoji indicators\nfunc (b *MarkdownBuilder) AssessRiskLevel(severity string) string // Returns: \"\ud83d\udd34 Critical\", \"\ud83d\udfe1 Medium\", etc.\n\n// AssessServiceRisk evaluates security risk for individual services\nfunc (b *MarkdownBuilder) AssessServiceRisk(service model.Service) string\n\n// DetermineSecurityZone classifies network interfaces by security zone\nfunc (b *MarkdownBuilder) DetermineSecurityZone(interfaceName string) string\n</code></pre>"},{"location":"api/#data-transformation-methods","title":"Data Transformation Methods","text":"<p>These methods handle data filtering, grouping, and formatting operations.</p> <pre><code>// FilterSystemTunables filters system tunables based on security relevance\nfunc (b *MarkdownBuilder) FilterSystemTunables(tunables []model.SysctlItem, securityOnly bool) []model.SysctlItem\n\n// GroupServicesByStatus groups services by their operational status\nfunc (b *MarkdownBuilder) GroupServicesByStatus(services []model.Service) map[string][]model.Service\n\n// FormatInterfaceLinks creates markdown anchor links for interface navigation\nfunc (b *MarkdownBuilder) FormatInterfaceLinks(interfaces model.InterfaceList) string\n\n// FormatSystemStats formats system statistics for report inclusion\nfunc (b *MarkdownBuilder) FormatSystemStats(data *model.OpnSenseDocument) map[string]interface{}\n</code></pre>"},{"location":"api/#string-utility-methods","title":"String Utility Methods","text":"<p>These methods provide string manipulation and formatting capabilities.</p> <pre><code>// EscapeMarkdownSpecialChars escapes special markdown characters to prevent formatting issues\nfunc (b *MarkdownBuilder) EscapeMarkdownSpecialChars(input string) string\n\n// FormatTimestamp converts timestamps to human-readable format\nfunc (b *MarkdownBuilder) FormatTimestamp(timestamp time.Time) string\n\n// TruncateDescription truncates long descriptions while preserving word boundaries\nfunc (b *MarkdownBuilder) TruncateDescription(description string, maxLength int) string\n\n// FormatBoolean converts boolean values to checkmark/X-mark symbols\nfunc (b *MarkdownBuilder) FormatBoolean(value any) string // Returns: \"\u2713\" or \"\u2717\"\n</code></pre>"},{"location":"api/#usage-examples","title":"Usage Examples","text":""},{"location":"api/#basic-security-report-generation","title":"Basic Security Report Generation","text":"<pre><code>package main\n\nimport (\n    \"log\"\n    \"github.com/EvilBit-Labs/opnDossier/internal/converter\"\n    \"github.com/EvilBit-Labs/opnDossier/internal/parser\"\n)\n\nfunc main() {\n    // Parse OPNsense configuration\n    parser := parser.NewXMLParser()\n    config, err := parser.ParseFile(\"config.xml\")\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    // Create markdown builder\n    builder := converter.NewMarkdownBuilder()\n\n    // Generate standard report\n    report, err := builder.BuildStandardReport(config)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    fmt.Println(report)\n}\n</code></pre>"},{"location":"api/#custom-security-assessment","title":"Custom Security Assessment","text":"<pre><code>func generateCustomSecurityReport(config *model.OpnSenseDocument) string {\n    builder := converter.NewMarkdownBuilder()\n\n    // Calculate security metrics\n    score := builder.CalculateSecurityScore(config)\n    riskLevel := builder.AssessRiskLevel(\"high\")\n\n    // Build custom report sections\n    var report strings.Builder\n\n    report.WriteString(\"# Security Assessment Report\\n\\n\")\n    report.WriteString(fmt.Sprintf(\"**Overall Security Score:** %d/100 (%s)\\n\\n\", score, riskLevel))\n\n    // Add filtered security tunables\n    if config.Sysctl != nil {\n        securityTunables := builder.FilterSystemTunables(config.Sysctl.Item, true)\n        if len(securityTunables) &gt; 0 {\n            report.WriteString(\"## Critical Security Tunables\\n\\n\")\n            // Add table generation logic here\n        }\n    }\n\n    // Add grouped services analysis\n    if len(config.Installedpackages.Services) &gt; 0 {\n        serviceGroups := builder.GroupServicesByStatus(config.Installedpackages.Services)\n\n        report.WriteString(\"## Service Status Analysis\\n\\n\")\n        report.WriteString(fmt.Sprintf(\"- **Running Services:** %d\\n\", len(serviceGroups[\"running\"])))\n        report.WriteString(fmt.Sprintf(\"- **Stopped Services:** %d\\n\", len(serviceGroups[\"stopped\"])))\n    }\n\n    return report.String()\n}\n</code></pre>"},{"location":"api/#advanced-table-generation","title":"Advanced Table Generation","text":"<pre><code>func generateFirewallAudit(config *model.OpnSenseDocument) string {\n    builder := converter.NewMarkdownBuilder()\n\n    // Extract firewall rules\n    var allRules []model.Rule\n    if config.Filter != nil {\n        allRules = append(allRules, config.Filter.Rule...)\n    }\n\n    // Build firewall rules table\n    rulesTable := builder.BuildFirewallRulesTable(allRules)\n\n    // Build interface table\n    interfaceTable := builder.BuildInterfaceTable(config.Interfaces)\n\n    // Combine into comprehensive report\n    var report strings.Builder\n    report.WriteString(\"# Firewall Configuration Audit\\n\\n\")\n    report.WriteString(\"## Firewall Rules\\n\\n\")\n    report.WriteString(rulesTable.String())\n    report.WriteString(\"\\n## Network Interfaces\\n\\n\")\n    report.WriteString(interfaceTable.String())\n\n    return report.String()\n}\n</code></pre>"},{"location":"api/#error-handling-patterns","title":"Error Handling Patterns","text":""},{"location":"api/#standard-error-handling","title":"Standard Error Handling","text":"<pre><code>func processConfigSafely(filename string) error {\n    builder := converter.NewMarkdownBuilder()\n\n    // Parse configuration\n    parser := parser.NewXMLParser()\n    config, err := parser.ParseFile(filename)\n    if err != nil {\n        return fmt.Errorf(\"failed to parse config: %w\", err)\n    }\n\n    // Generate report with error handling\n    report, err := builder.BuildStandardReport(config)\n    if err != nil {\n        switch {\n        case errors.Is(err, converter.ErrInvalidData):\n            log.Printf(\"Invalid OPNsense data: %v\", err)\n            return fmt.Errorf(\"configuration validation failed: %w\", err)\n        case errors.Is(err, converter.ErrGenerationFailed):\n            log.Printf(\"Report generation failed: %v\", err)\n            return fmt.Errorf(\"markdown generation error: %w\", err)\n        default:\n            log.Printf(\"Unexpected error: %v\", err)\n            return fmt.Errorf(\"unexpected generation error: %w\", err)\n        }\n    }\n\n    // Process successful report\n    fmt.Println(report)\n    return nil\n}\n</code></pre>"},{"location":"api/#defensive-programming","title":"Defensive Programming","text":"<pre><code>func safeSecurityAssessment(config *model.OpnSenseDocument) map[string]interface{} {\n    builder := converter.NewMarkdownBuilder()\n\n    results := make(map[string]interface{})\n\n    // Safe security score calculation\n    if config != nil {\n        results[\"security_score\"] = builder.CalculateSecurityScore(config)\n    } else {\n        results[\"security_score\"] = 0\n        results[\"error\"] = \"Invalid configuration\"\n    }\n\n    // Safe tunable filtering\n    if config != nil &amp;&amp; config.Sysctl != nil {\n        securityTunables := builder.FilterSystemTunables(config.Sysctl.Item, true)\n        results[\"security_tunables_count\"] = len(securityTunables)\n    } else {\n        results[\"security_tunables_count\"] = 0\n    }\n\n    // Safe service grouping\n    if config != nil &amp;&amp; len(config.Installedpackages.Services) &gt; 0 {\n        serviceGroups := builder.GroupServicesByStatus(config.Installedpackages.Services)\n        results[\"running_services\"] = len(serviceGroups[\"running\"])\n        results[\"stopped_services\"] = len(serviceGroups[\"stopped\"])\n    } else {\n        results[\"running_services\"] = 0\n        results[\"stopped_services\"] = 0\n    }\n\n    return results\n}\n</code></pre>"},{"location":"api/#performance-considerations","title":"Performance Considerations","text":""},{"location":"api/#optimization-guidelines","title":"Optimization Guidelines","text":"<ol> <li>Pre-allocate Slices: Use capacity hints for better performance</li> </ol> <pre><code>// Good: Pre-allocate with estimated capacity\nresults := make([]model.Rule, 0, len(allRules)/3)\n\n// Avoid: Frequent reallocations\nvar results []model.Rule\n</code></pre> <ol> <li>Reuse Builders: Create builders once and reuse for multiple reports</li> </ol> <pre><code>// Good: Reuse builder instance\nbuilder := converter.NewMarkdownBuilder()\nfor _, config := range configs {\n    report, _ := builder.BuildStandardReport(config)\n    // Process report\n}\n</code></pre> <ol> <li>Batch Operations: Group similar operations together</li> </ol> <pre><code>// Good: Batch multiple assessments\nscores := make([]int, len(configs))\nfor i, config := range configs {\n    scores[i] = builder.CalculateSecurityScore(config)\n}\n</code></pre>"},{"location":"api/#memory-management","title":"Memory Management","text":"<pre><code>func efficientReportGeneration(configs []*model.OpnSenseDocument) []string {\n    builder := converter.NewMarkdownBuilder()\n\n    // Pre-allocate results slice\n    reports := make([]string, 0, len(configs))\n\n    // Process in batches to manage memory\n    batchSize := 10\n    for i := 0; i &lt; len(configs); i += batchSize {\n        end := i + batchSize\n        if end &gt; len(configs) {\n            end = len(configs)\n        }\n\n        // Process batch\n        for j := i; j &lt; end; j++ {\n            if report, err := builder.BuildStandardReport(configs[j]); err == nil {\n                reports = append(reports, report)\n            }\n        }\n\n        // Optional: Force garbage collection between batches for large datasets\n        // runtime.GC()\n    }\n\n    return reports\n}\n</code></pre>"},{"location":"api/#thread-safety","title":"Thread Safety","text":"<p>The MarkdownBuilder is thread-safe for read operations but requires synchronization for concurrent modifications:</p> <pre><code>func concurrentReportGeneration(configs []*model.OpnSenseDocument) []string {\n    builder := converter.NewMarkdownBuilder()\n\n    var wg sync.WaitGroup\n    results := make([]string, len(configs))\n\n    // Process configurations concurrently\n    for i, config := range configs {\n        wg.Add(1)\n        go func(index int, cfg *model.OpnSenseDocument) {\n            defer wg.Done()\n\n            if report, err := builder.BuildStandardReport(cfg); err == nil {\n                results[index] = report\n            }\n        }(i, config)\n    }\n\n    wg.Wait()\n    return results\n}\n</code></pre>"},{"location":"api/#migration-from-template-mode","title":"Migration from Template Mode","text":""},{"location":"api/#key-differences","title":"Key Differences","text":"Template Mode Programmatic Mode <code>{{ getRiskLevel .Severity }}</code> <code>builder.AssessRiskLevel(item.Severity)</code> <code>{{ .Value \\| upper }}</code> <code>strings.ToUpper(item.Value)</code> <code>{{ if .IsSecure }}</code> <code>if item.IsSecure {</code> Silent failures Explicit error handling Runtime template parsing Compile-time validation"},{"location":"api/#migration-strategy","title":"Migration Strategy","text":"<ol> <li>Replace template calls with method calls</li> <li>Add explicit error handling for all operations</li> <li>Use type-safe parameters instead of template variables</li> <li>Implement defensive programming for edge cases</li> </ol> <p>See the complete migration guide for detailed step-by-step instructions.</p>"},{"location":"api/#best-practices","title":"Best Practices","text":"<ol> <li>Always handle errors explicitly - don't ignore return values</li> <li>Use defensive programming - check for nil pointers and empty slices</li> <li>Pre-allocate slices when size is known or estimable</li> <li>Reuse builder instances for multiple reports</li> <li>Use structured logging for debugging and monitoring</li> <li>Profile performance for large datasets or high-frequency usage</li> <li>Follow Go naming conventions in custom extensions</li> </ol>"},{"location":"api/#related-documentation","title":"Related Documentation","text":"<ul> <li>Migration Guide - Step-by-step migration from template mode</li> <li>Examples - Real-world usage scenarios and patterns</li> <li>Architecture - System architecture and design decisions</li> <li>Contributing - Development guidelines for API extensions</li> </ul>"},{"location":"architecture-review/","title":"opnDossier Architecture Review","text":"<p>Generated: 2026-01-14 Reviewer: Architecture Analysis Codebase Size: ~40,000 lines of Go code Test Files: 61 test files</p>"},{"location":"architecture-review/#executive-summary","title":"Executive Summary","text":"<p>opnDossier demonstrates strong architectural foundations with excellent separation of concerns, comprehensive error handling, and modern Go idioms. The codebase is well-structured for maintainability and follows industry best practices. Key strengths include a clean plugin architecture, streaming XML processing, and comprehensive testing. Areas for improvement include reducing global state, consolidating redundant converter patterns, and addressing technical debt from the template-to-programmatic migration.</p> <p>Overall Grade: A- (Strong architecture with minor improvement opportunities)</p>"},{"location":"architecture-review/#1-overall-structure-and-patterns","title":"1. Overall Structure and Patterns","text":""},{"location":"architecture-review/#11-package-organization","title":"1.1 Package Organization","text":"<p>STRENGTHS:</p> <pre><code>internal/\n\u251c\u2500\u2500 audit/           # Security audit plugins (excellent separation)\n\u251c\u2500\u2500 config/          # Configuration management\n\u251c\u2500\u2500 converter/       # Format converters (JSON/YAML/Markdown)\n\u251c\u2500\u2500 display/         # Terminal display logic\n\u251c\u2500\u2500 log/             # Centralized logging\n\u251c\u2500\u2500 markdown/        # Markdown generation (hybrid approach)\n\u251c\u2500\u2500 metrics/         # Performance metrics\n\u251c\u2500\u2500 model/           # Data models (well-defined domain)\n\u251c\u2500\u2500 parser/          # XML parsing with security\n\u251c\u2500\u2500 plugin/          # Plugin interfaces\n\u251c\u2500\u2500 plugins/         # Compliance plugins (firewall/SANS/STIG)\n\u251c\u2500\u2500 processor/       # Core processing and analysis\n\u2514\u2500\u2500 validator/       # Configuration validation\n</code></pre> <p>Evaluation:</p> <ul> <li>Clean separation by responsibility</li> <li>No circular dependencies observed</li> <li>Clear boundaries between parsing, processing, conversion, and output</li> <li>Plugin architecture allows extensibility</li> </ul> <p>RECOMMENDATION: Excellent structure. No changes needed.</p>"},{"location":"architecture-review/#12-dependency-management","title":"1.2 Dependency Management","text":"<p>Dependencies Analysis (go.mod):</p> <pre><code>Core Framework:\n- cobra v1.10.2         # CLI framework\n- viper v1.21.0         # Configuration\n- fang v0.4.4           # CLI enhancement\n\nFormatting &amp; Display:\n- lipgloss v1.1.1       # Terminal styling\n- glamour v0.10.0       # Markdown rendering\n- log v0.4.2            # Structured logging\n\nData Processing:\n- mxj v1.8.4            # XML processing\n- validator v10.30.1    # Validation\n- goldmark v1.7.16      # Markdown parsing\n</code></pre> <p>ISSUES:</p> <ol> <li>Charm library version spread - Multiple versions of related libraries</li> <li>LRU cache (<code>hashicorp/golang-lru/v2</code>) - Used but purpose unclear without deeper inspection</li> </ol> <p>RECOMMENDATION:</p> <ul> <li>Consolidate Charm library versions to latest stable</li> <li>Document cache usage and tune size parameters</li> </ul>"},{"location":"architecture-review/#2-architecture-patterns","title":"2. Architecture Patterns","text":""},{"location":"architecture-review/#21-plugin-architecture-excellent","title":"2.1 Plugin Architecture (EXCELLENT)","text":"<p>Design:</p> <pre><code>// Clean interface definition\ntype CompliancePlugin interface {\n    Name() string\n    Version() string\n    Description() string\n    RunChecks(config *model.OpnSenseDocument) []Finding\n    GetControls() []Control\n    GetControlByID(id string) (*Control, error)\n    ValidateConfiguration() error\n}\n</code></pre> <p>Strengths:</p> <ul> <li>Loose coupling - only depends on <code>model.OpnSenseDocument</code></li> <li>Standardized <code>Finding</code> and <code>Control</code> structures</li> <li>Support for both built-in and dynamic (.so) plugins</li> <li>Thread-safe registry with <code>sync.RWMutex</code></li> <li>Validation at registration time</li> </ul> <p>Example Usage:</p> <pre><code>// internal/audit/plugin.go\nregistry := NewPluginRegistry()\nregistry.RegisterPlugin(firewallPlugin)\nregistry.LoadDynamicPlugins(ctx, \"/path/to/plugins\", logger)\nresults := registry.RunComplianceChecks(config, []string{\"firewall\", \"STIG\"})\n</code></pre> <p>RECOMMENDATION: This is a best practice example. Consider documenting this as a reference architecture for other projects.</p>"},{"location":"architecture-review/#22-parser-architecture-secure-efficient","title":"2.2 Parser Architecture (SECURE &amp; EFFICIENT)","text":"<p>Design:</p> <pre><code>type Parser interface {\n    Parse(ctx context.Context, r io.Reader) (*model.OpnSenseDocument, error)\n    Validate(cfg *model.OpnSenseDocument) error\n}\n</code></pre> <p>Security Features:</p> <ul> <li>XML bomb protection - 10MB default limit (<code>DefaultMaxInputSize</code>)</li> <li>XXE attack prevention - Empty entity map</li> <li>Streaming processing - Minimal memory footprint</li> <li>Charset handling - Safe fallbacks</li> </ul> <p>Implementation:</p> <pre><code>// Streaming approach for large files\nlimitedReader := io.LimitReader(r, p.MaxInputSize)\ndec := xml.NewDecoder(limitedReader)\ndec.CharsetReader = charsetReader\ndec.Entity = map[string]string{}  // Prevent XXE\n</code></pre> <p>STRENGTHS:</p> <ul> <li>Security-first design</li> <li>Memory-efficient for large configs</li> <li>Clear error handling with context</li> </ul> <p>MINOR CONCERN:</p> <ul> <li>Charset reader comment: \"TODO: use golang.org/x/text/encoding\"</li> <li>Currently treats ISO-8859-1 as UTF-8 (simplification)</li> </ul> <p>RECOMMENDATION:</p> <ul> <li>Track the charset TODO in backlog</li> <li>For now, acceptable - most OPNsense configs are UTF-8</li> </ul>"},{"location":"architecture-review/#23-converter-pattern-needs-consolidation","title":"2.3 Converter Pattern (NEEDS CONSOLIDATION)","text":"<p>ISSUE: Multiple Converter Implementations</p> <pre><code>converter/\n\u251c\u2500\u2500 json.go           # JSONConverter\n\u251c\u2500\u2500 yaml.go           # YAMLConverter\n\u251c\u2500\u2500 markdown.go       # MarkdownConverter\n\u251c\u2500\u2500 adapter.go        # Adapter interface\n\u2514\u2500\u2500 markdown_*.go     # Various markdown helpers\n\nmarkdown/\n\u251c\u2500\u2500 generator.go      # markdownGenerator\n\u251c\u2500\u2500 hybrid_generator.go # HybridGenerator\n\u251c\u2500\u2500 adapter.go        # Converter adapter\n\u2514\u2500\u2500 templates.go      # Template-based generation\n</code></pre> <p>Analysis:</p> <ol> <li> <p>Two Markdown Generation Approaches:</p> </li> <li> <p><code>converter/markdown.go</code> - Direct conversion</p> </li> <li> <p><code>markdown/hybrid_generator.go</code> - Template + programmatic</p> </li> <li> <p>Adapter Pattern Duplication:</p> </li> <li> <p><code>converter/adapter.go</code> - Empty (moved to markdown package)</p> </li> <li> <p><code>markdown/adapter.go</code> - Actual implementation</p> </li> <li> <p>Unclear Boundary:</p> </li> <li> <p>When to use <code>converter.MarkdownConverter</code> vs <code>markdown.HybridGenerator</code>?</p> </li> </ol> <p>TECHNICAL DEBT: From README migration comments, this appears to be mid-transition from template-based to programmatic generation.</p> <p>RECOMMENDATION:</p> <p>Priority: Medium</p> <ol> <li>Consolidate converters:</li> </ol> <pre><code>// Single entry point\ntype Converter interface {\n    Convert(ctx context.Context, doc *model.OpnSenseDocument, format string) (string, error)\n}\n\n// Internal implementation detail\ntype converter struct {\n    jsonGen   *JSONGenerator\n    yamlGen   *YAMLGenerator\n    mdGen     *MarkdownGenerator  // delegates to markdown package\n}\n</code></pre> <ol> <li> <p>Remove adapter.go or document purpose clearly</p> </li> <li> <p>Deprecate template-based generation in v2.x</p> </li> </ol>"},{"location":"architecture-review/#24-error-handling-comprehensive","title":"2.4 Error Handling (COMPREHENSIVE)","text":"<p>Strengths:</p> <pre><code>// Centralized error definitions\n// internal/parser/errors.go (290 lines)\nvar (\n    ErrInvalidXML = errors.New(\"invalid XML\")\n    ErrMissingOpnSenseDocumentRoot = errors.New(\"missing opnsense root element\")\n    // ... comprehensive error catalog\n)\n\n// Wrapped errors with context\nreturn fmt.Errorf(\"failed to parse configuration: %w\", err)\n</code></pre> <p>Error Files:</p> <ul> <li><code>parser/errors.go</code> - 290 lines (most comprehensive)</li> <li><code>processor/errors.go</code> - 55 lines</li> <li><code>markdown/errors.go</code> - 20 lines</li> <li><code>plugin/errors.go</code> - 22 lines</li> </ul> <p>Pattern:</p> <ul> <li>Sentinel errors for expected conditions</li> <li>Wrapped errors with context</li> <li>Validation errors collected and aggregated</li> </ul> <p>RECOMMENDATION:</p> <ul> <li>Excellent approach</li> <li>Consider error codes for machine-readable diagnostics (future enhancement)</li> </ul>"},{"location":"architecture-review/#25-context-usage-inconsistent","title":"2.5 Context Usage (INCONSISTENT)","text":"<p>ISSUE: Underutilized Context</p> <pre><code>// Many functions accept but don't use context\nfunc (c *MarkdownConverter) ToMarkdown(_ context.Context, opnsense *model.OpnSenseDocument) (string, error)\nfunc (p *CoreProcessor) analyze(_ context.Context, cfg *model.OpnSenseDocument, config *Config, report *Report)\n</code></pre> <p>Analysis:</p> <ul> <li>Context accepted for future cancellation support</li> <li>Currently not checked or propagated</li> <li>Named <code>_</code> to indicate intentional non-use</li> </ul> <p>CONCERN:</p> <ul> <li>Long-running operations (analysis, large file parsing) cannot be cancelled</li> <li>No timeout support</li> </ul> <p>RECOMMENDATION:</p> <p>Priority: Low-Medium</p> <ol> <li>Add context checks to long-running operations:</li> </ol> <pre><code>func (p *CoreProcessor) analyze(ctx context.Context, cfg *model.OpnSenseDocument, config *Config, report *Report) {\n    select {\n    case &lt;-ctx.Done():\n        return ctx.Err()\n    default:\n    }\n\n    // Continue processing...\n}\n</code></pre> <ol> <li> <p>Document context policy:</p> </li> <li> <p>When to check <code>ctx.Done()</code></p> </li> <li>Timeout recommendations</li> </ol>"},{"location":"architecture-review/#3-potential-architectural-issues","title":"3. Potential Architectural Issues","text":""},{"location":"architecture-review/#31-global-state-moderate-concern","title":"3.1 Global State (MODERATE CONCERN)","text":"<p>Issue: Global Variables in Multiple Packages</p> <pre><code>// cmd/root.go\nvar (\n    cfgFile string          // CLI config file path\n    Cfg    *config.Config   // Application configuration\n    logger *log.Logger      // Application logger\n)\n\n// internal/audit/plugin.go\nvar GlobalRegistry *PluginRegistry\n\nfunc init() {\n    GlobalRegistry = NewPluginRegistry()\n}\n</code></pre> <p>Impact:</p> <ul> <li>Testing complexity - Global state requires careful setup/teardown</li> <li>Concurrency risk - Shared mutable state</li> <li>Package coupling - Implicit dependencies</li> </ul> <p>MITIGATION OBSERVED:</p> <ul> <li>Plugin registry uses <code>sync.RWMutex</code> for thread safety</li> <li>CLI globals are acceptable for Cobra convention</li> <li>No evidence of mutation races</li> </ul> <p>RECOMMENDATION:</p> <p>Priority: Medium</p> <ol> <li>Refactor GlobalRegistry to dependency injection:</li> </ol> <pre><code>// Before\naudit.RegisterGlobalPlugin(plugin)\n\n// After\nregistry := audit.NewPluginRegistry()\nregistry.RegisterPlugin(plugin)\n// Pass registry to processors that need it\n</code></pre> <ol> <li> <p>Keep CLI globals (acceptable for main package)</p> </li> <li> <p>Add tests demonstrating thread safety</p> </li> </ol>"},{"location":"architecture-review/#32-interface-count-low-concern","title":"3.2 Interface Count (LOW CONCERN)","text":"<p>Finding: 11 interface definitions across internal packages</p> <p>Analysis:</p> <ul> <li>Appropriate for Go - favor small, focused interfaces</li> <li>Main interfaces:</li> <li><code>Parser</code> (2 methods)</li> <li><code>CompliancePlugin</code> (7 methods)</li> <li><code>Converter</code> (varied by format)</li> <li><code>Processor</code> (2-3 methods)</li> </ul> <p>RECOMMENDATION:</p> <ul> <li>Current interface count is healthy</li> <li>No over-abstraction detected</li> </ul>"},{"location":"architecture-review/#33-model-coupling-architectural-strength","title":"3.3 Model Coupling (ARCHITECTURAL STRENGTH)","text":"<p>Design:</p> <pre><code>// internal/model/opnsense.go\ntype OpnSenseDocument struct {\n    XMLName    xml.Name `xml:\"opnsense\"`\n    System     System\n    Interfaces Interfaces\n    Filter     Filter\n    // ... comprehensive OPNsense config model\n}\n</code></pre> <p>Strengths:</p> <ul> <li>Single source of truth for OPNsense schema</li> <li>Comprehensive XML/JSON/YAML tags</li> <li>Validation tags for go-playground/validator</li> </ul> <p>Potential Issue:</p> <ul> <li>Large struct (46+ fields in <code>OpnSenseDocument</code>)</li> <li>Nested complexity</li> </ul> <p>MITIGATION:</p> <ul> <li>Well-organized into logical sub-structs (System, Network, Security, Services)</li> <li>Clear domain separation</li> </ul> <p>RECOMMENDATION:</p> <ul> <li>Current approach is appropriate for configuration modeling</li> <li>Monitor for excessive nesting depth (currently acceptable)</li> </ul>"},{"location":"architecture-review/#4-scalability-considerations","title":"4. Scalability Considerations","text":""},{"location":"architecture-review/#41-memory-efficiency-excellent","title":"4.1 Memory Efficiency (EXCELLENT)","text":"<p>Streaming XML Parser:</p> <pre><code>// Processes XML tokens without loading full document\nfor {\n    tok, err := dec.Token()\n    if errors.Is(err, io.EOF) {\n        break\n    }\n    // Process token...\n}\n\n// Garbage collection optimization\nruntime.GC()\n</code></pre> <p>Analysis:</p> <ul> <li>10MB default limit prevents XML bombs</li> <li>Streaming reduces memory footprint</li> <li>Explicit GC after large sections</li> </ul> <p>RECOMMENDATION:</p> <ul> <li>Add configurable memory limits via config</li> <li>Document performance characteristics by file size</li> </ul>"},{"location":"architecture-review/#42-concurrency-underutilized","title":"4.2 Concurrency (UNDERUTILIZED)","text":"<p>Observation:</p> <ul> <li>Plugin checks run sequentially</li> <li>Analysis phases run sequentially</li> <li>No obvious parallelization</li> </ul> <p>Potential Optimization:</p> <pre><code>// Current: Sequential\nfor _, pluginName := range pluginNames {\n    findings := p.RunChecks(config)\n    result.Findings = append(result.Findings, findings...)\n}\n\n// Potential: Parallel\nvar wg sync.WaitGroup\nfindingsChan := make(chan []plugin.Finding, len(pluginNames))\n\nfor _, pluginName := range pluginNames {\n    wg.Add(1)\n    go func(name string) {\n        defer wg.Done()\n        p := getPlugin(name)\n        findingsChan &lt;- p.RunChecks(config)\n    }(pluginName)\n}\n</code></pre> <p>RECOMMENDATION:</p> <p>Priority: Low (Optimization, not architecture fix)</p> <ul> <li>Current approach is correct for typical config sizes</li> <li>Add parallel processing for large-scale batch operations</li> <li>Use worker pools to limit concurrency</li> </ul>"},{"location":"architecture-review/#43-caching-strategy-unclear","title":"4.3 Caching Strategy (UNCLEAR)","text":"<p>Observation:</p> <ul> <li><code>hashicorp/golang-lru/v2</code> dependency</li> <li>No obvious cache usage in scanned files</li> </ul> <p>RECOMMENDATION:</p> <ul> <li>Audit where LRU cache is used</li> <li>Document cache sizing and eviction policy</li> <li>Consider removing if unused</li> </ul>"},{"location":"architecture-review/#5-maintainability-and-modularity","title":"5. Maintainability and Modularity","text":""},{"location":"architecture-review/#51-testing-structure-excellent","title":"5.1 Testing Structure (EXCELLENT)","text":"<p>Coverage:</p> <ul> <li>61 test files</li> <li>Comprehensive test types:</li> <li>Unit tests (<code>*_test.go</code>)</li> <li>Benchmark tests (<code>*_bench_test.go</code>)</li> <li>Integration tests (<code>*_integration_test.go</code>)</li> </ul> <p>Patterns Observed:</p> <pre><code>// Benchmark tests for performance tracking\nfunc BenchmarkConvert(b *testing.B) { ... }\n\n// Validation comprehensive tests\nvalidation_comprehensive_test.go\n\n// Legacy comparison tests\nbenchmark_legacy_test.go\n</code></pre> <p>RECOMMENDATION:</p> <ul> <li>Strong testing culture</li> <li>Add coverage reporting to CI</li> <li>Target &gt;80% coverage (appears achievable)</li> </ul>"},{"location":"architecture-review/#52-documentation-good","title":"5.2 Documentation (GOOD)","text":"<p>Strengths:</p> <ul> <li>Package-level documentation</li> <li>Function documentation follows godoc conventions</li> <li>Comprehensive README and docs/ folder</li> </ul> <p>Gaps:</p> <ul> <li>Architecture diagrams would enhance understanding</li> <li>Plugin development guide needed</li> <li>Converter consolidation should be documented</li> </ul> <p>RECOMMENDATION:</p> <ul> <li>Add architecture diagrams (mermaid)</li> <li>Document converter strategy and deprecation timeline</li> <li>Create plugin development guide</li> </ul>"},{"location":"architecture-review/#53-code-organization-excellent","title":"5.3 Code Organization (EXCELLENT)","text":"<p>Patterns:</p> <ul> <li>Clear separation of concerns</li> <li>Single Responsibility Principle followed</li> <li>No God objects detected</li> <li>Appropriate use of constructors (<code>New*</code>)</li> </ul> <p>Example:</p> <pre><code>// Clear factory pattern\nfunc NewPluginRegistry() *PluginRegistry {\n    return &amp;PluginRegistry{\n        plugins: make(map[string]plugin.CompliancePlugin),\n    }\n}\n</code></pre>"},{"location":"architecture-review/#6-security-and-best-practices","title":"6. Security and Best Practices","text":""},{"location":"architecture-review/#61-security-features-strong","title":"6.1 Security Features (STRONG)","text":"<p>XML Parsing:</p> <ul> <li>XXE attack prevention</li> <li>XML bomb protection</li> <li>Size limits</li> <li>Entity expansion disabled</li> </ul> <p>Input Validation:</p> <ul> <li>go-playground/validator integration</li> <li>Comprehensive validation rules</li> <li>Error aggregation</li> </ul> <p>RECOMMENDATION:</p> <ul> <li>Document security features in security.md</li> <li>Add fuzzing tests for parser</li> <li>Consider static analysis integration (gosec)</li> </ul>"},{"location":"architecture-review/#62-go-best-practices-mostly-followed","title":"6.2 Go Best Practices (MOSTLY FOLLOWED)","text":"<p>Strengths:</p> <ul> <li>Proper error wrapping (<code>fmt.Errorf(\"...: %w\", err)</code>)</li> <li>Context propagation</li> <li>Interface segregation</li> <li>Clear package boundaries</li> </ul> <p>Minor Issues:</p> <ul> <li>Some <code>//nolint</code> directives (acceptable with justification)</li> <li>Global variables (discussed above)</li> <li>Context underutilization (discussed above)</li> </ul>"},{"location":"architecture-review/#7-recommendations-summary","title":"7. Recommendations Summary","text":""},{"location":"architecture-review/#71-high-priority-architectural","title":"7.1 High Priority (Architectural)","text":"<ol> <li> <p>Consolidate Converter Pattern</p> </li> <li> <p>Effort: Medium</p> </li> <li>Impact: High (reduces confusion, improves maintainability)</li> <li> <p>Action: Create unified converter interface, deprecate template mode</p> </li> <li> <p>Reduce Global State</p> </li> <li> <p>Effort: Low-Medium</p> </li> <li>Impact: Medium (improves testability, reduces coupling)</li> <li>Action: Inject PluginRegistry instead of using global</li> </ol>"},{"location":"architecture-review/#72-medium-priority-quality","title":"7.2 Medium Priority (Quality)","text":"<ol> <li> <p>Improve Context Usage</p> </li> <li> <p>Effort: Low</p> </li> <li>Impact: Medium (enables cancellation, timeouts)</li> <li> <p>Action: Add context checks to long-running operations</p> </li> <li> <p>Document Technical Debt</p> </li> <li> <p>Effort: Low</p> </li> <li>Impact: Medium (team awareness)</li> <li>Action: Create TECHNICAL_DEBT.md tracking template migration</li> </ol>"},{"location":"architecture-review/#73-low-priority-enhancement","title":"7.3 Low Priority (Enhancement)","text":"<ol> <li> <p>Add Architecture Diagrams</p> </li> <li> <p>Effort: Low</p> </li> <li>Impact: High (documentation quality)</li> <li> <p>Action: Create mermaid diagrams for data flow, plugin architecture</p> </li> <li> <p>Optimize Parallelization</p> </li> <li> <p>Effort: Medium</p> </li> <li>Impact: Low (performance optimization)</li> <li> <p>Action: Add concurrent plugin execution for large-scale ops</p> </li> <li> <p>Audit Cache Usage</p> </li> <li> <p>Effort: Low</p> </li> <li>Impact: Low (code clarity)</li> <li>Action: Find or remove LRU cache dependency</li> </ol>"},{"location":"architecture-review/#8-areas-following-best-practices","title":"8. Areas Following Best Practices","text":""},{"location":"architecture-review/#81-exceptional-examples","title":"8.1 Exceptional Examples","text":"<p>Plugin Architecture:</p> <ul> <li>Clean interfaces</li> <li>Thread-safe registry</li> <li>Extensible design</li> <li>Standardized data structures</li> </ul> <p>Parser Security:</p> <ul> <li>Defense in depth</li> <li>Resource limits</li> <li>Streaming processing</li> <li>Clear error handling</li> </ul> <p>Testing Strategy:</p> <ul> <li>Comprehensive coverage</li> <li>Benchmarks for performance tracking</li> <li>Integration and unit tests</li> <li>Legacy comparison tests</li> </ul>"},{"location":"architecture-review/#82-modern-go-patterns","title":"8.2 Modern Go Patterns","text":"<ul> <li>Functional options pattern (processor options)</li> <li>Context propagation</li> <li>Error wrapping with <code>%w</code></li> <li>Interface-based design</li> <li>Constructor functions</li> </ul>"},{"location":"architecture-review/#9-technical-debt-tracking","title":"9. Technical Debt Tracking","text":""},{"location":"architecture-review/#91-known-issues","title":"9.1 Known Issues","text":"<ol> <li> <p>Template-to-Programmatic Migration</p> </li> <li> <p>Status: In progress</p> </li> <li>Files: <code>markdown/*</code>, <code>converter/*</code></li> <li> <p>Impact: Code duplication, confusion</p> </li> <li> <p>Charset Reader TODO</p> </li> <li> <p>Location: <code>parser/xml.go:57</code></p> </li> <li>Impact: Limited encoding support</li> <li> <p>Workaround: Most configs are UTF-8</p> </li> <li> <p>Context Underutilization</p> </li> <li> <p>Locations: Multiple functions</p> </li> <li>Impact: No cancellation support</li> <li>Risk: Low for current use cases</li> </ol>"},{"location":"architecture-review/#10-conclusion","title":"10. Conclusion","text":""},{"location":"architecture-review/#101-overall-assessment","title":"10.1 Overall Assessment","text":"<p>opnDossier demonstrates mature software architecture with:</p> <ul> <li>Strong separation of concerns</li> <li>Extensible plugin system</li> <li>Secure-by-default XML parsing</li> <li>Comprehensive testing</li> <li>Modern Go idioms</li> </ul>"},{"location":"architecture-review/#102-key-strengths","title":"10.2 Key Strengths","text":"<ol> <li>Plugin architecture (best practice)</li> <li>Security-first parser design</li> <li>Clean package organization</li> <li>Comprehensive error handling</li> <li>Strong testing culture</li> </ol>"},{"location":"architecture-review/#103-key-improvement-areas","title":"10.3 Key Improvement Areas","text":"<ol> <li>Consolidate converter pattern</li> <li>Reduce global state</li> <li>Improve context usage</li> <li>Complete technical debt (template migration)</li> </ol>"},{"location":"architecture-review/#104-recommendation","title":"10.4 Recommendation","text":"<p>No major architectural changes required. The codebase is well-designed for long-term maintainability. Focus on:</p> <ul> <li>Short term: Consolidate converters, document technical debt</li> <li>Medium term: Improve context usage, reduce globals</li> <li>Long term: Add architecture diagrams, performance optimization</li> </ul> <p>The simplest approach that will work for the long term: Continue current architecture, execute tactical improvements from recommendations above.</p> <p>Review Status: Complete Next Review: After converter consolidation (Q2 2026)</p>"},{"location":"charmbracelet-compatibility-research/","title":"Charmbracelet Ecosystem Compatibility Research","text":"<p>Status: Completed - 2025-01-13 Scope: opnDossier v3.x dependency coordination Focus: Charmbracelet ecosystem modernization and API stability analysis</p>"},{"location":"charmbracelet-compatibility-research/#executive-summary","title":"Executive Summary","text":"<p>This document provides comprehensive compatibility research for the Charmbracelet package ecosystem used in opnDossier, specifically addressing the modernization of <code>fang</code>, <code>lipgloss</code>, and related transitive dependencies. The research confirms API compatibility, identifies breaking changes, and validates the stability of the dependency matrix.</p> <p>Key Finding: The current dependency matrix (fang v0.3.0, lipgloss v1.1.1-pseudo, log v0.4.2) is compatible with all transitive dependencies. Recommended safe upgrades are fang v0.4.3 (bug fixes only, low risk) and lipgloss v1.1.0 stable release (no breaking changes). These are low-risk updates that enhance reproducibility and stability.</p>"},{"location":"charmbracelet-compatibility-research/#1-compatible-version-matrix","title":"1. Compatible Version Matrix","text":""},{"location":"charmbracelet-compatibility-research/#current-dependency-status-opndossier-v3x","title":"Current Dependency Status (opnDossier v3.x)","text":"Package Current Version Type Purpose Status <code>github.com/charmbracelet/fang</code> v0.3.0 Direct Enhanced CLI help and completion Outdated <code>github.com/charmbracelet/lipgloss</code> v1.1.1-0.20250404... Direct Terminal styling and layout Pseudo-version <code>github.com/charmbracelet/log</code> v0.4.2 Direct Structured logging Current <code>github.com/charmbracelet/glamour</code> v0.10.0 Direct Markdown rendering Current <code>github.com/charmbracelet/bubbles</code> v0.21.0 Direct Reusable UI components Current <code>github.com/charmbracelet/bubbletea</code> v1.3.6 Indirect TUI framework (via bubbles) Current <code>github.com/charmbracelet/colorprofile</code> v0.3.1 Indirect Color profile detection Current <code>github.com/charmbracelet/harmonica</code> v0.2.0 Indirect Charm animation library Current <code>github.com/charmbracelet/x/ansi</code> v0.10.1 Indirect ANSI escape sequence utilities Current <code>github.com/charmbracelet/x/cellbuf</code> v0.0.13 Indirect Cell buffer implementation Current <code>github.com/charmbracelet/x/term</code> v0.2.1 Indirect Terminal capabilities detection Current"},{"location":"charmbracelet-compatibility-research/#recommended-upgrade-path","title":"Recommended Upgrade Path","text":""},{"location":"charmbracelet-compatibility-research/#phase-1-stabilize-lipgloss-high-priority","title":"Phase 1: Stabilize Lipgloss (High Priority)","text":"<ul> <li>Target: Replace pseudo-version with stable v1.1.0 release</li> <li>Status: Confirmed stable release (2025-03)</li> <li>Rationale: Enables reproducible builds and clearer dependency tracking</li> <li>Risk Level: Low (no API breaking changes)</li> </ul>"},{"location":"charmbracelet-compatibility-research/#phase-2-modernize-fang-low-priority","title":"Phase 2: Modernize Fang (Low Priority)","text":"<ul> <li>Target: Upgrade from v0.3.0 to v0.4.3</li> <li>Status: Bug fixes only, no breaking changes</li> <li>Rationale: Incorporates critical bug fixes (term error handler, multiline flag descriptions)</li> <li>Risk Level: Low (no breaking changes, bug fixes only)</li> </ul>"},{"location":"charmbracelet-compatibility-research/#2-identified-breaking-api-changes","title":"2. Identified Breaking API Changes","text":""},{"location":"charmbracelet-compatibility-research/#21-ansistyle-api-changes","title":"2.1 <code>ansi.Style</code> API Changes","text":"<p>Package: <code>github.com/charmbracelet/x/ansi</code></p> <p>Version Affected: v0.10.1 (current)</p> <p>Change Description: The <code>ansi.Style</code> type underwent significant refactoring to support layered styling and improved ANSI compatibility.</p> <p>Breaking Changes Identified:</p> <ul> <li>Constructor signatures changed from simple function calls to builder patterns</li> <li>Direct field access on <code>Style</code> is no longer supported</li> <li>Requires use of methods like <code>Style.Foreground()</code>, <code>Style.Background()</code>, <code>Style.Bold()</code></li> <li>Style composition changed from direct struct assignment to method chaining</li> </ul> <p>Migration Pattern:</p> <pre><code>// Old pattern (v0.9.x)\nstyle := ansi.Style{\n    Foreground: \"red\",\n    Bold:       true,\n}\n\n// New pattern (v0.10.x)\nstyle := ansi.NewStyle().\n    Foreground(\"red\").\n    Bold()\n</code></pre> <p>Impact on opnDossier: Low - Limited direct use of <code>ansi.Style</code> in codebase. Primary usage through <code>lipgloss</code> abstractions.</p>"},{"location":"charmbracelet-compatibility-research/#22-cellbuf-api-changes","title":"2.2 <code>cellbuf</code> API Changes","text":"<p>Package: <code>github.com/charmbracelet/x/cellbuf</code></p> <p>Version Affected: v0.0.13 (current)</p> <p>Change Description: The cell buffer implementation added support for wide characters and Unicode normalization, requiring changes to cell addressing and measurement functions.</p> <p>Breaking Changes Identified:</p> <ul> <li><code>Width()</code> function now returns rune-based width instead of byte-based measurements</li> <li>Cell indexing changed to support multi-width characters</li> <li>New requirement for <code>MeasureString()</code> before cell positioning</li> <li><code>Buffer.Bytes()</code> no longer provides direct byte access; use <code>Buffer.String()</code></li> </ul> <p>Migration Pattern:</p> <pre><code>// Old pattern\nwidth := len(buffer.String())\npos := buffer.Find(str)\n\n// New pattern\nwidth := cellbuf.MeasureString(buffer.String())\npos := buffer.FindRune(str)\n</code></pre> <p>Impact on opnDossier: Medium - Used indirectly through <code>lipgloss</code> for terminal dimension calculations and cell positioning.</p>"},{"location":"charmbracelet-compatibility-research/#23-logloggerwith-api-changes","title":"2.3 <code>log.Logger.With()</code> API Changes","text":"<p>Package: <code>github.com/charmbracelet/log</code></p> <p>Version Affected: v0.4.2 (current)</p> <p>Change Description: The logging API was updated to support context-aware structured logging and improved performance with field pooling.</p> <p>Breaking Changes Identified:</p> <ul> <li><code>Logger.With()</code> now returns a new logger instance instead of mutating the receiver</li> <li>Field key-value pairs must be paired correctly (no odd number of arguments allowed)</li> <li>Deprecated direct <code>Logger.Debugf()</code>, <code>Logger.Infof()</code> in favor of structured <code>Logger.Debug()</code>, <code>Logger.Info()</code> with fields</li> <li><code>Logger.SetLevel()</code> now requires validation and may panic on invalid levels</li> </ul> <p>Migration Pattern:</p> <pre><code>// Old pattern (v0.3.x)\nlogger := log.New()\nlogger.With(\"key\", \"value\")\nlogger.Infof(\"Message: %s\", value)\n\n// New pattern (v0.4.x)\nlogger := log.New()\nlogger = logger.With(\"key\", \"value\")\nlogger.Info(\"Message\", \"value\", value)\n</code></pre> <p>Current opnDossier Usage: The codebase already uses the v0.4.2 API correctly with structured logging patterns.</p> <p>Impact on opnDossier: None - Already compatible with current API.</p>"},{"location":"charmbracelet-compatibility-research/#3-fang-v043-changelog-verification","title":"3. Fang v0.4.3 Changelog Verification","text":"<p>Package: <code>github.com/charmbracelet/fang</code></p> <p>Current Version in opnDossier: v0.3.0</p> <p>Target Upgrade Version: v0.4.3 (Latest stable as of 2025-09-30)</p> <p>Source: GitHub Releases</p>"},{"location":"charmbracelet-compatibility-research/#changelog-analysis","title":"Changelog Analysis","text":"<p>The fang v0.4.3 release (and cumulative v0.4.x releases) includes the following verified changes:</p> Version Type Description Breaking? v0.4.3 Bug Fix Fix term error handler in command help No v0.4.3 Bug Fix Improve multiline flag description handling No v0.4.2 Bug Fix Handle edge case in completion filtering No v0.4.1 Enhancement Improve flag documentation parsing No v0.4.0 Enhancement Refactor help text builder API No <p>Breaking Changes in Upgrade Path (v0.3.0 \u2192 v0.4.3):</p> <p>None identified. The v0.4.x series contains bug fixes only. No breaking changes to the public API or help text generation.</p> <p>Note: Earlier misidentified breaking changes in v0.4.0 were based on inaccurate research. Verification confirms v0.4.x is a stable, backward-compatible release.</p>"},{"location":"charmbracelet-compatibility-research/#verification-conclusion","title":"Verification Conclusion","text":"<p>\u2705 Verified: fang v0.4.3 changelog contains only bug fixes (term error handler, multiline flag descriptions) \u2705 Stability: Release is stable and well-tested \u2705 No Migration Required: Upgrade from v0.3.0 to v0.4.3 is a drop-in replacement</p>"},{"location":"charmbracelet-compatibility-research/#4-lipgloss-stable-release-status","title":"4. Lipgloss Stable Release Status","text":"<p>Current Status in opnDossier: v1.1.1-0.20250404203927-76690c660834 (pseudo-version post-commit)</p> <p>Source: GitHub Releases</p>"},{"location":"charmbracelet-compatibility-research/#release-analysis","title":"Release Analysis","text":"<p>Finding: \u2705 Latest stable release is v1.1.0 (2025-03)</p> <p>No v1.1.1 stable release exists. The current pseudo-version <code>v1.1.1-0.20250404...</code> is a commit timestamp reference after the v1.1.0 release, indicating development work post-release.</p> <p>Release Details:</p> <ul> <li>Latest Stable Version: v1.1.0</li> <li>Release Date: 2025-03</li> <li>Status: Stable, production-ready</li> <li>Pseudo-version: Points to commit dated 2025-04-04, post v1.1.0</li> </ul>"},{"location":"charmbracelet-compatibility-research/#why-current-code-uses-pseudo-version","title":"Why Current Code Uses Pseudo-Version","text":"<p>The pseudo-version is used because:</p> <ol> <li>A critical bug fix or feature was committed after v1.1.0 was released</li> <li>The fix was not yet included in a formal v1.1.1 release</li> <li>Pinning to the specific commit ensures reproducible builds</li> </ol>"},{"location":"charmbracelet-compatibility-research/#recommended-action","title":"Recommended Action","text":"<p>Replace Pseudo-Version with Stable v1.1.0 Release:</p> <pre><code>go get github.com/charmbracelet/lipgloss@v1.1.0\ngo mod tidy\n</code></pre> <p>Benefits:</p> <ul> <li>Explicit, reproducible version tracking</li> <li>Clearer dependency management via semantic versioning</li> <li>Simplified version management</li> <li>Minimal risk (pseudo-version is based on post-v1.1.0 work)</li> </ul> <p>Risk Assessment: \u2705 Very Low - v1.1.0 is the stable baseline; pseudo-version contains only minor post-release work</p>"},{"location":"charmbracelet-compatibility-research/#5-transitive-dependency-compatibility","title":"5. Transitive Dependency Compatibility","text":""},{"location":"charmbracelet-compatibility-research/#x-packages-ecosystem","title":"X-Packages Ecosystem","text":"<p>The Charmbracelet <code>x/*</code> packages (experimental) maintain high stability despite the <code>/x/</code> prefix:</p> Package Version Stability Usage <code>x/ansi</code> v0.10.1 Stable ANSI escape handling (via lipgloss) <code>x/cellbuf</code> v0.0.13 Stable Cell-based terminal output (via lipgloss) <code>x/term</code> v0.2.1 Stable Terminal capability detection (via various) <code>x/exp/charmtone</code> experimental Experimental Not in use <code>x/exp/color</code> experimental Experimental Not in use <code>x/exp/slice</code> experimental Experimental Not in use <p>Conclusion: The <code>/x/</code> prefix indicates experimental API, but v0.x versions demonstrate production-grade stability.</p>"},{"location":"charmbracelet-compatibility-research/#6-dependency-update-recommendations","title":"6. Dependency Update Recommendations","text":""},{"location":"charmbracelet-compatibility-research/#priority-1-critical-lipgloss-stabilization","title":"Priority 1: Critical (Lipgloss Stabilization)","text":"<p>Action: Update <code>lipgloss</code> from pseudo-version to v1.1.0 stable release Timeline: Immediate Risk: Very Low Effort: 5 minutes (single command)</p> <pre><code>go get github.com/charmbracelet/lipgloss@v1.1.0\ngo mod tidy\n</code></pre>"},{"location":"charmbracelet-compatibility-research/#priority-2-low-fang-modernization","title":"Priority 2: Low (Fang Modernization)","text":"<p>Action: Upgrade from fang v0.3.0 to v0.4.3 (bug fixes only) Timeline: Next minor release (safe to defer) Risk: Very Low (no breaking changes) Effort: 15 minutes (single command + testing)</p> <p>No Code Changes Required. fang v0.4.3 is a drop-in replacement with only bug fixes:</p> <ul> <li>Term error handler improvements</li> <li>Multiline flag description handling</li> </ul> <pre><code>go get github.com/charmbracelet/fang@v0.4.3\ngo mod tidy\njust ci-check\n</code></pre> <p>Acceptance Criteria:</p> <ul> <li> <code>just ci-check</code> passes</li> <li> <code>opndossier --help</code> displays correctly</li> <li> Command completion works as expected</li> <li> No regressions in CLI output</li> </ul>"},{"location":"charmbracelet-compatibility-research/#priority-3-maintenance-log-and-other-packages","title":"Priority 3: Maintenance (Log and Other Packages)","text":"<p>Action: Keep log v0.4.2, no immediate update needed Timeline: Monitor for v0.5.0 release Risk: Low Effort: Monitoring only</p> <p>Current packages are stable and actively maintained:</p> <ul> <li><code>bubbles</code> v0.21.0: Use current version</li> <li><code>glamour</code> v0.10.0: Use current version</li> <li><code>bubbletea</code> v1.3.6: Transitive, stable</li> </ul>"},{"location":"charmbracelet-compatibility-research/#7-testing-and-validation-strategy","title":"7. Testing and Validation Strategy","text":""},{"location":"charmbracelet-compatibility-research/#pre-upgrade-testing-checklist","title":"Pre-Upgrade Testing Checklist","text":"<ul> <li> Run full test suite: <code>just test</code></li> <li> Run CI checks: <code>just ci-check</code></li> <li> Test help output: <code>./opndossier --help</code></li> <li> Test command completion: <code>source &lt;(./opndossier completion bash)</code></li> <li> Verify terminal styling in multiple terminals (bash, zsh, PowerShell)</li> <li> Check for any panics or logging errors</li> <li> Validate with both colored and dumb terminals (<code>TERM=dumb</code>)</li> </ul>"},{"location":"charmbracelet-compatibility-research/#regression-testing","title":"Regression Testing","text":"<p>After each upgrade:</p> <ol> <li>Run example conversions with various flags</li> <li>Verify markdown output formatting</li> <li>Check styled output in terminal</li> <li>Confirm offline operation (no network calls)</li> </ol>"},{"location":"charmbracelet-compatibility-research/#8-conclusion","title":"8. Conclusion","text":"<p>The Charmbracelet ecosystem is stable and well-designed for opnDossier's use case. The recommended upgrade path is:</p> <ol> <li>Immediate (Very Low Risk): Stabilize lipgloss from pseudo-version to v1.1.0 stable</li> <li>Next Minor Release (Very Low Risk): Upgrade fang from v0.3.0 to v0.4.3 (bug fixes only, no code changes needed)</li> <li>Ongoing (Low Effort): Monitor transitive dependencies for updates</li> </ol> <p>Safe Upgrade Command:</p> <pre><code>go get github.com/charmbracelet/lipgloss@v1.1.0 github.com/charmbracelet/fang@v0.4.3\ngo mod tidy\njust ci-check\n</code></pre> <p>No breaking changes or code modifications are required. The ecosystem demonstrates excellent backward compatibility practices and active maintenance.</p>"},{"location":"charmbracelet-compatibility-research/#references","title":"References","text":"<ul> <li>Charmbracelet GitHub Organization</li> <li>Fang v0.4.3 Release</li> <li>Lipgloss v1.1.0 Release</li> <li>Log Repository</li> <li>Log v0.4.2 Release</li> <li>Go Module Versioning</li> </ul> <p>Document Version: 1.1 (Corrected - Accurate version verification) Last Updated: 2026-01-13 Maintainer: opnDossier Development Team Status: Based on analysis of GitHub releases and changelogs</p>"},{"location":"cis-like-firewall-reference/","title":"CIS-Inspired Firewall Security Controls Reference","text":""},{"location":"cis-like-firewall-reference/#overview","title":"Overview","text":"<p>This document provides a reference guide for implementing firewall security controls inspired by industry-standard benchmarks for opnDossier. The controls outlined here are based on general security best practices for network firewalls and are designed to be compatible with OPNsense configurations. This document is not affiliated with, endorsed by, or derived from any specific benchmark organization.</p>"},{"location":"cis-like-firewall-reference/#control-categories","title":"Control Categories","text":""},{"location":"cis-like-firewall-reference/#1-general-setting-policy","title":"1. General Setting Policy","text":""},{"location":"cis-like-firewall-reference/#11-ssh-warning-banner-configuration","title":"1.1 SSH Warning Banner Configuration","text":"<ul> <li>Control: Configure SSH warning banner before authentication</li> <li>Rationale: Inform users of connection rules and aid in prosecution of intruders</li> <li>Implementation: Set Banner parameter in SSH configuration</li> <li>Default: No banner shown by default</li> </ul>"},{"location":"cis-like-firewall-reference/#12-auto-configuration-backup","title":"1.2 Auto Configuration Backup","text":"<ul> <li>Control: Enable automatic configuration backup</li> <li>Rationale: Ensure configuration changes are backed up automatically</li> <li>Implementation: Enable AutoConfigBackup service</li> <li>Default: Disabled</li> </ul>"},{"location":"cis-like-firewall-reference/#13-message-of-the-day-motd","title":"1.3 Message of the Day (MOTD)","text":"<ul> <li>Control: Set appropriate MOTD message</li> <li>Rationale: Provide legal notice and consent for monitoring</li> <li>Implementation: Configure /etc/motd with appropriate message</li> <li>Default: FreeBSD default MOTD</li> </ul>"},{"location":"cis-like-firewall-reference/#14-hostname-configuration","title":"1.4 Hostname Configuration","text":"<ul> <li>Control: Set device hostname</li> <li>Rationale: Asset identification and security requirements</li> <li>Implementation: Configure hostname in System &gt; General Setup</li> <li>Default: pfSense</li> </ul>"},{"location":"cis-like-firewall-reference/#15-dns-server-configuration","title":"1.5 DNS Server Configuration","text":"<ul> <li>Control: Configure DNS servers</li> <li>Rationale: Enable hostname resolution to IP addresses</li> <li>Implementation: Set DNS servers in System &gt; General Setup</li> <li>Default: Blank unless DHCP assigns</li> </ul>"},{"location":"cis-like-firewall-reference/#16-ipv6-disablement","title":"1.6 IPv6 Disablement","text":"<ul> <li>Control: Disable IPv6 if not used</li> <li>Rationale: Reduce attack surface if IPv6 not needed</li> <li>Implementation: Disable IPv6 in System &gt; Advanced &gt; Networking</li> <li>Default: IPv6 enabled</li> </ul>"},{"location":"cis-like-firewall-reference/#17-dns-rebind-check","title":"1.7 DNS Rebind Check","text":"<ul> <li>Control: Enable DNS rebind check</li> <li>Rationale: Protect against DNS rebinding attacks</li> <li>Implementation: Check DNS Rebind Check in System &gt; Advanced</li> <li>Default: Unchecked</li> </ul>"},{"location":"cis-like-firewall-reference/#18-https-web-management","title":"1.8 HTTPS Web Management","text":"<ul> <li>Control: Use HTTPS for web management</li> <li>Rationale: Encrypt management traffic and ensure identity</li> <li>Implementation: Configure HTTPS in System &gt; Advanced &gt; Admin Access</li> <li>Default: HTTPS enabled</li> </ul>"},{"location":"cis-like-firewall-reference/#19-high-availability-configuration","title":"1.9 High Availability Configuration","text":"<ul> <li>Control: Configure synchronized HA peer</li> <li>Rationale: Ensure availability and automatic failover</li> <li>Implementation: Configure HA sync in System &gt; High Avail. Sync</li> <li>Default: All fields blank</li> </ul>"},{"location":"cis-like-firewall-reference/#2-user-management","title":"2. User Management","text":""},{"location":"cis-like-firewall-reference/#21-session-timeout","title":"2.1 Session Timeout","text":"<ul> <li>Control: Set session timeout to \u226410 minutes</li> <li>Rationale: Prevent abuse of abandoned sessions</li> <li>Implementation: Configure in System &gt; User Manager &gt; Settings</li> <li>Default: No timeout set</li> </ul>"},{"location":"cis-like-firewall-reference/#22-ldapradius-authentication","title":"2.2 LDAP/RADIUS Authentication","text":"<ul> <li>Control: Configure central authentication</li> <li>Rationale: Centralized AAA for access management</li> <li>Implementation: Configure in System &gt; User Manager &gt; Authentication Servers</li> <li>Default: Local Database</li> </ul>"},{"location":"cis-like-firewall-reference/#23-console-menu-protection","title":"2.3 Console Menu Protection","text":"<ul> <li>Control: Password protect console menu</li> <li>Rationale: Prevent unauthorized console access</li> <li>Implementation: Enable in System &gt; Advanced &gt; Admin Access</li> <li>Default: Unchecked</li> </ul>"},{"location":"cis-like-firewall-reference/#24-default-account-management","title":"2.4 Default Account Management","text":"<ul> <li>Control: Disable or secure default accounts</li> <li>Rationale: Prevent unauthorized access via known accounts</li> <li>Implementation: Review and secure default accounts</li> <li>Default: admin account only</li> </ul>"},{"location":"cis-like-firewall-reference/#3-password-policy","title":"3. Password Policy","text":""},{"location":"cis-like-firewall-reference/#31-local-account-status","title":"3.1 Local Account Status","text":"<ul> <li>Control: Disable local accounts except admin</li> <li>Rationale: Centralize account management</li> <li>Implementation: Disable unnecessary local accounts</li> <li>Default: Local accounts enabled</li> </ul>"},{"location":"cis-like-firewall-reference/#32-login-protection-threshold","title":"3.2 Login Protection Threshold","text":"<ul> <li>Control: Set threshold to \u226430</li> <li>Rationale: Prevent brute force attacks</li> <li>Implementation: Configure in System &gt; Advanced</li> <li>Default: 30</li> </ul>"},{"location":"cis-like-firewall-reference/#33-access-block-time","title":"3.3 Access Block Time","text":"<ul> <li>Control: Set block time to \u2265300 seconds</li> <li>Rationale: Prevent rapid retry attacks</li> <li>Implementation: Configure in System &gt; Advanced &gt; Admin Access</li> <li>Default: No block time</li> </ul>"},{"location":"cis-like-firewall-reference/#34-default-password-change","title":"3.4 Default Password Change","text":"<ul> <li>Control: Change default admin password</li> <li>Rationale: Prevent compromise via known credentials</li> <li>Implementation: Change password in System &gt; User Manager</li> <li>Default: admin/pfsense</li> </ul>"},{"location":"cis-like-firewall-reference/#4-firewall-policy","title":"4. Firewall Policy","text":""},{"location":"cis-like-firewall-reference/#411-destination-field-restrictions","title":"4.1.1 Destination Field Restrictions","text":"<ul> <li>Control: No \"Any\" in destination field</li> <li>Rationale: Explicit destination control</li> <li>Implementation: Review and restrict firewall rules</li> <li>Default: Allow Any rules present</li> </ul>"},{"location":"cis-like-firewall-reference/#412-source-field-restrictions","title":"4.1.2 Source Field Restrictions","text":"<ul> <li>Control: No \"Any\" in source field</li> <li>Rationale: Explicit source control</li> <li>Implementation: Review and restrict firewall rules</li> <li>Default: Allow Any rules present</li> </ul>"},{"location":"cis-like-firewall-reference/#413-service-field-restrictions","title":"4.1.3 Service Field Restrictions","text":"<ul> <li>Control: No \"Any\" in service field</li> <li>Rationale: Explicit service control</li> <li>Implementation: Review and restrict firewall rules</li> <li>Default: Allow Any rules present</li> </ul>"},{"location":"cis-like-firewall-reference/#414-unused-policy-removal","title":"4.1.4 Unused Policy Removal","text":"<ul> <li>Control: Remove unused firewall policies</li> <li>Rationale: Prevent unintended access</li> <li>Implementation: Review and remove unused policies</li> <li>Default: Varies by configuration</li> </ul>"},{"location":"cis-like-firewall-reference/#415-firewall-rule-logging","title":"4.1.5 Firewall Rule Logging","text":"<ul> <li>Control: Enable logging for all firewall rules</li> <li>Rationale: Audit trail and troubleshooting</li> <li>Implementation: Enable logging in firewall rules</li> <li>Default: Some logging enabled</li> </ul>"},{"location":"cis-like-firewall-reference/#416-icmp-configuration","title":"4.1.6 ICMP Configuration","text":"<ul> <li>Control: Secure ICMP request configuration</li> <li>Rationale: Prevent ICMP-based attacks</li> <li>Implementation: Restrict ICMP types in firewall rules</li> <li>Default: Varies by configuration</li> </ul>"},{"location":"cis-like-firewall-reference/#5-service-configuration","title":"5. Service Configuration","text":""},{"location":"cis-like-firewall-reference/#511-snmp-trap-receivers","title":"5.1.1 SNMP Trap Receivers","text":"<ul> <li>Control: Configure SNMP trap receivers</li> <li>Rationale: Enable monitoring and alerting</li> <li>Implementation: Configure in Services &gt; SNMP</li> <li>Default: Not configured</li> </ul>"},{"location":"cis-like-firewall-reference/#512-snmp-trap-enablement","title":"5.1.2 SNMP Trap Enablement","text":"<ul> <li>Control: Enable SNMP traps</li> <li>Rationale: Enable monitoring notifications</li> <li>Implementation: Enable in Services &gt; SNMP</li> <li>Default: Disabled</li> </ul>"},{"location":"cis-like-firewall-reference/#513-net-snmp-package","title":"5.1.3 NET-SNMP Package","text":"<ul> <li>Control: Install and secure NET-SNMP</li> <li>Rationale: Enhanced SNMP functionality</li> <li>Implementation: Install and configure NET-SNMP package</li> <li>Default: Not installed</li> </ul>"},{"location":"cis-like-firewall-reference/#521-ntp-configuration","title":"5.2.1 NTP Configuration","text":"<ul> <li>Control: Configure time zone properly</li> <li>Rationale: Accurate timestamps and certificate validation</li> <li>Implementation: Configure in Services &gt; NTP</li> <li>Default: NTP server enabled</li> </ul>"},{"location":"cis-like-firewall-reference/#531-dnssec-enablement","title":"5.3.1 DNSSEC Enablement","text":"<ul> <li>Control: Enable DNSSEC on DNS service</li> <li>Rationale: Protect against DNS attacks</li> <li>Implementation: Enable in Services &gt; DNS Resolver</li> <li>Default: DNS resolver enabled</li> </ul>"},{"location":"cis-like-firewall-reference/#541-vpn-authentication","title":"5.4.1 VPN Authentication","text":"<ul> <li>Control: Use RADIUS/LDAP for VPN authentication</li> <li>Rationale: Centralized authentication</li> <li>Implementation: Configure in System &gt; User Manager</li> <li>Default: Local Database</li> </ul>"},{"location":"cis-like-firewall-reference/#542-vpn-certificate","title":"5.4.2 VPN Certificate","text":"<ul> <li>Control: Use trusted certificate for VPN portal</li> <li>Rationale: Prevent man-in-the-middle attacks</li> <li>Implementation: Import trusted CA in System &gt; Cert. Manager</li> <li>Default: No certificates</li> </ul>"},{"location":"cis-like-firewall-reference/#543-openvpn-tls","title":"5.4.3 OpenVPN TLS","text":"<ul> <li>Control: Configure OpenVPN with TLS encryption</li> <li>Rationale: Secure VPN communications</li> <li>Implementation: Configure in VPN &gt; OpenVPN</li> <li>Default: Varies by configuration</li> </ul>"},{"location":"cis-like-firewall-reference/#551-openvpn-ciphers","title":"5.5.1 OpenVPN Ciphers","text":"<ul> <li>Control: Use strong ciphers and hashing algorithms</li> <li>Rationale: Prevent cryptographic attacks</li> <li>Implementation: Configure strong algorithms in OpenVPN</li> <li>Default: Varies by configuration</li> </ul>"},{"location":"cis-like-firewall-reference/#6-logging","title":"6. Logging","text":""},{"location":"cis-like-firewall-reference/#61-syslog-configuration","title":"6.1 Syslog Configuration","text":"<ul> <li>Control: Configure syslog for remote logging</li> <li>Rationale: Protected log storage and archiving</li> <li>Implementation: Configure in Status &gt; System Logs &gt; Settings</li> <li>Default: No external logging</li> </ul>"},{"location":"cis-like-firewall-reference/#implementation-notes","title":"Implementation Notes","text":""},{"location":"cis-like-firewall-reference/#control-mapping","title":"Control Mapping","text":"<p>Each control should be mapped to our audit engine with:</p> <ul> <li>Control ID (e.g., FIREWALL-001)</li> <li>Category and title</li> <li>Severity level</li> <li>Description and rationale</li> <li>Audit procedure</li> <li>Remediation steps</li> </ul>"},{"location":"cis-like-firewall-reference/#severity-levels","title":"Severity Levels","text":"<ul> <li>High: Critical security controls that must be implemented</li> <li>Medium: Important security controls that should be implemented</li> <li>Low: Recommended security controls for enhanced security</li> </ul>"},{"location":"cis-like-firewall-reference/#profile-levels","title":"Profile Levels","text":"<ul> <li>Level 1: Basic security controls for most environments</li> <li>Level 2: Enhanced security controls for high-security environments</li> </ul>"},{"location":"cis-like-firewall-reference/#industry-standards-alignment","title":"Industry Standards Alignment","text":"<p>These controls align with general industry security standards and best practices for network infrastructure security, providing guidance for different organizational maturity levels.</p>"},{"location":"cis-like-firewall-reference/#references","title":"References","text":"<ul> <li>General network security best practices</li> <li>Industry-standard firewall security guidelines</li> <li>OPNsense documentation and security recommendations</li> <li>Network infrastructure security frameworks</li> </ul>"},{"location":"cis-like-firewall-reference/#usage-in-opndossier","title":"Usage in opnDossier","text":"<p>This reference document guides the implementation of firewall security controls in our audit engine. Each control should be:</p> <ol> <li>Implemented as a check in the audit engine</li> <li>Mapped to appropriate OPNsense configuration elements</li> <li>Reported with clear findings and recommendations</li> <li>Tracked for compliance status</li> </ol> <p>The controls provide a comprehensive security assessment framework for OPNsense firewalls, complementing our existing STIG and SANS compliance capabilities.</p>"},{"location":"compliance-standards/","title":"Compliance Standards Integration","text":""},{"location":"compliance-standards/#overview","title":"Overview","text":"<p>opnDossier integrates industry-standard security compliance frameworks to provide comprehensive blue team audit reports. The system supports STIG (Security Technical Implementation Guide), SANS Firewall Checklist, and CIS-inspired Firewall Security Controls standards for firewall security assessment.</p>"},{"location":"compliance-standards/#supported-standards","title":"Supported Standards","text":""},{"location":"compliance-standards/#stig-security-technical-implementation-guide","title":"STIG (Security Technical Implementation Guide)","text":"<p>STIGs are cybersecurity methodologies for standardizing security configuration within networks, servers, computers, and logical designs to enhance overall security. opnDossier implements the DISA Firewall Security Requirements Guide which includes:</p>"},{"location":"compliance-standards/#key-stig-controls","title":"Key STIG Controls","text":"Control ID Title Severity Category V-206694 Firewall must deny network communications traffic by default High Default Deny Policy V-206701 Firewall must employ filters that prevent DoS attacks High DoS Protection V-206674 Firewall must use packet headers and attributes for filtering High Packet Filtering V-206690 Firewall must disable unnecessary network services Medium Service Hardening V-206682 Firewall must generate comprehensive traffic logs Medium Logging V-206680 Firewall must log network location information Medium Logging V-206679 Firewall must log event timestamps Medium Logging V-206678 Firewall must log event types Medium Logging V-206681 Firewall must log source information Low Logging V-206711 Firewall must alert on DoS incidents Low Alerting"},{"location":"compliance-standards/#sans-firewall-checklist","title":"SANS Firewall Checklist","text":"<p>The SANS Firewall Checklist provides practical security controls for firewall configuration and management:</p>"},{"location":"compliance-standards/#key-sans-controls","title":"Key SANS Controls","text":"Control ID Category Title Severity SANS-FW-001 Access Control Default Deny Policy High SANS-FW-002 Rule Management Explicit Rule Configuration Medium SANS-FW-003 Network Segmentation Network Zone Separation High SANS-FW-004 Logging and Monitoring Comprehensive Logging Medium SANS-FW-005 Service Hardening Unnecessary Services Disabled Medium SANS-FW-006 Authentication Strong Authentication High SANS-FW-007 Encryption Encrypted Management High SANS-FW-008 Backup and Recovery Configuration Backup Medium SANS-FW-009 Vulnerability Management Regular Updates High SANS-FW-010 Incident Response Alert Configuration Medium"},{"location":"compliance-standards/#cis-inspired-firewall-security-controls","title":"CIS-Inspired Firewall Security Controls","text":"<p>Our CIS-inspired firewall security controls provide comprehensive security guidance designed for OPNsense firewalls, based on general industry best practices for network firewall security:</p>"},{"location":"compliance-standards/#key-firewall-security-controls","title":"Key Firewall Security Controls","text":"Control ID Category Title Severity Description FIREWALL-001 System Configuration SSH Warning Banner High Configure SSH warning banner FIREWALL-002 System Configuration Auto Configuration Backup Medium Enable automatic configuration backup FIREWALL-003 System Configuration Message of the Day Medium Set appropriate MOTD message FIREWALL-004 System Configuration Hostname Configuration Low Set device hostname FIREWALL-005 Network Configuration DNS Server Configuration Medium Configure DNS servers FIREWALL-006 Network Configuration IPv6 Disablement Medium Disable IPv6 if not used FIREWALL-007 Network Configuration DNS Rebind Check Medium Disable DNS rebind check FIREWALL-008 Management Access HTTPS Web Management High Use HTTPS for web management FIREWALL-009 High Availability HA Configuration Medium Configure synchronized HA peer FIREWALL-010 User Management Session Timeout High Set session timeout to \u226410 minutes FIREWALL-011 Authentication Central Authentication High Configure LDAP/RADIUS authentication FIREWALL-012 Access Control Console Menu Protection Medium Password protect console menu FIREWALL-013 User Management Default Account Management High Secure default accounts FIREWALL-014 User Management Local Account Status Medium Disable local accounts except admin FIREWALL-015 Security Policy Login Protection Threshold High Set threshold to \u226430 FIREWALL-016 Security Policy Access Block Time High Set block time to \u2265300 seconds FIREWALL-017 Security Policy Default Password Change High Change default admin password FIREWALL-018 Firewall Rules Destination Restrictions High No \"Any\" in destination field FIREWALL-019 Firewall Rules Source Restrictions High No \"Any\" in source field FIREWALL-020 Firewall Rules Service Restrictions High No \"Any\" in service field"},{"location":"compliance-standards/#implementation-details","title":"Implementation Details","text":""},{"location":"compliance-standards/#audit-engine","title":"Audit Engine","text":"<p>The compliance analysis is performed by the <code>internal/audit/engine.go</code> module, which:</p> <ol> <li>Analyzes OPNsense configurations against defined security controls</li> <li>Maps findings to compliance standards with specific control references</li> <li>Generates compliance reports with detailed remediation guidance</li> <li>Provides risk assessment based on control compliance status</li> </ol>"},{"location":"compliance-standards/#data-structures","title":"Data Structures","text":"<pre><code>// AuditFinding represents a finding with compliance mappings\ntype AuditFinding struct {\n    processor.Finding\n    STIGReferences []string `json:\"stigReferences,omitempty\"`\n    SANSReferences []string `json:\"sansReferences,omitempty\"`\n    FirewallReferences []string `json:\"firewallReferences,omitempty\"`\n    ComplianceTags []string `json:\"complianceTags,omitempty\"`\n}\n\n// AuditResult contains the complete audit results\ntype AuditResult struct {\n    Findings       []AuditFinding `json:\"findings\"`\n    STIGCompliance map[string]bool `json:\"stigCompliance\"`\n    SANSCompliance map[string]bool `json:\"sansCompliance\"`\n    FirewallCompliance map[string]bool `json:\"firewallCompliance\"`\n    Summary        AuditSummary   `json:\"summary\"`\n}\n</code></pre>"},{"location":"compliance-standards/#compliance-checks","title":"Compliance Checks","text":"<p>The audit engine performs the following types of checks:</p>"},{"location":"compliance-standards/#stig-compliance-checks","title":"STIG Compliance Checks","text":"<ol> <li> <p>Default Deny Policy (V-206694)</p> </li> <li> <p>Verifies firewall implements deny-by-default approach</p> </li> <li> <p>Checks for explicit allow rules only</p> </li> <li> <p>DoS Protection (V-206701)</p> </li> <li> <p>Validates DoS protection mechanisms</p> </li> <li> <p>Checks flood protection and rate limiting</p> </li> <li> <p>Packet Filtering (V-206674)</p> </li> <li> <p>Analyzes rule specificity</p> </li> <li> <p>Identifies overly permissive rules</p> </li> <li> <p>Service Hardening (V-206690)</p> </li> <li> <p>Checks for unnecessary services</p> </li> <li> <p>Validates service configuration</p> </li> <li> <p>Logging Configuration (V-206682, V-206680, V-206679, V-206678, V-206681)</p> </li> <li> <p>Verifies comprehensive logging</p> </li> <li>Checks log content and format</li> </ol>"},{"location":"compliance-standards/#sans-compliance-checks","title":"SANS Compliance Checks","text":"<ol> <li> <p>Access Control (SANS-FW-001)</p> </li> <li> <p>Validates default deny implementation</p> </li> <li> <p>Checks explicit allow rules</p> </li> <li> <p>Rule Management (SANS-FW-002)</p> </li> <li> <p>Analyzes rule documentation</p> </li> <li> <p>Checks rule specificity</p> </li> <li> <p>Network Segmentation (SANS-FW-003)</p> </li> <li> <p>Validates zone separation</p> </li> <li> <p>Checks access controls between zones</p> </li> <li> <p>Logging and Monitoring (SANS-FW-004)</p> </li> <li> <p>Verifies comprehensive logging</p> </li> <li>Checks monitoring configuration</li> </ol>"},{"location":"compliance-standards/#firewall-security-compliance-checks","title":"Firewall Security Compliance Checks","text":"<ol> <li> <p>System Configuration (FIREWALL-001, FIREWALL-002, FIREWALL-003, FIREWALL-004)</p> </li> <li> <p>Validates SSH warning banner configuration</p> </li> <li>Checks auto configuration backup settings</li> <li>Verifies MOTD customization</li> <li> <p>Validates hostname configuration</p> </li> <li> <p>Network Configuration (FIREWALL-005, FIREWALL-006, FIREWALL-007)</p> </li> <li> <p>Verifies DNS server configuration</p> </li> <li>Checks IPv6 disablement settings</li> <li> <p>Validates DNS rebind check configuration</p> </li> <li> <p>Management Access (FIREWALL-008)</p> </li> <li> <p>Verifies HTTPS web management configuration</p> </li> <li> <p>Checks management access encryption</p> </li> <li> <p>High Availability (FIREWALL-009)</p> </li> <li> <p>Validates HA peer configuration</p> </li> <li> <p>Checks synchronization settings</p> </li> <li> <p>User Management (FIREWALL-010, FIREWALL-013, FIREWALL-014)</p> </li> <li> <p>Verifies session timeout configuration</p> </li> <li>Checks default account management</li> <li> <p>Validates local account status</p> </li> <li> <p>Authentication (FIREWALL-011)</p> </li> <li> <p>Validates central authentication configuration</p> </li> <li> <p>Checks LDAP/RADIUS setup</p> </li> <li> <p>Access Control (FIREWALL-012)</p> </li> <li> <p>Verifies console menu protection</p> </li> <li> <p>Checks access control settings</p> </li> <li> <p>Security Policy (FIREWALL-015, FIREWALL-016, FIREWALL-017)</p> </li> <li> <p>Validates login protection threshold</p> </li> <li>Checks access block time configuration</li> <li> <p>Verifies default password change</p> </li> <li> <p>Firewall Rules (FIREWALL-018, FIREWALL-019, FIREWALL-020)</p> </li> <li> <p>Validates destination field restrictions</p> </li> <li>Checks source field restrictions</li> <li>Verifies service field restrictions</li> </ol>"},{"location":"compliance-standards/#usage","title":"Usage","text":""},{"location":"compliance-standards/#blue-team-mode","title":"Blue Team Mode","text":"<p>To generate a compliance-focused blue team report:</p> <pre><code># Include all compliance standards\nopnDossier analyze config.xml --mode=blue --compliance=stig,sans,firewall\n\n# Include specific standards\nopnDossier analyze config.xml --mode=blue --compliance=firewall\n</code></pre>"},{"location":"compliance-standards/#enhanced-blue-team-template","title":"Enhanced Blue Team Template","text":"<p>The enhanced blue team template (<code>blue_enhanced.md.tmpl</code>) provides:</p> <ul> <li>Executive Summary with compliance metrics</li> <li>Findings by Severity with control references</li> <li>STIG Compliance Details with status matrix</li> <li>SANS Compliance Details with status matrix</li> <li>Firewall Security Compliance Details with status matrix</li> <li>Security Recommendations mapped to controls</li> <li>Compliance Roadmap for remediation</li> <li>Risk Assessment based on findings</li> </ul>"},{"location":"compliance-standards/#report-sections","title":"Report Sections","text":""},{"location":"compliance-standards/#executive-summary","title":"Executive Summary","text":"<ul> <li>Total findings count</li> <li>Severity breakdown</li> <li>Compliance status summary across all standards</li> </ul>"},{"location":"compliance-standards/#criticalhigh-findings","title":"Critical/High Findings","text":"<ul> <li>Detailed findings with control references</li> <li>Specific remediation guidance</li> <li>STIG/SANS/Firewall control mappings</li> </ul>"},{"location":"compliance-standards/#compliance-details","title":"Compliance Details","text":"<ul> <li>Control-by-control status for each standard</li> <li>Compliance matrices</li> <li>Risk assessments</li> </ul>"},{"location":"compliance-standards/#recommendations","title":"Recommendations","text":"<ul> <li>Prioritized action items</li> <li>Control-specific guidance</li> <li>Implementation roadmap</li> </ul>"},{"location":"compliance-standards/#compliance-mapping","title":"Compliance Mapping","text":""},{"location":"compliance-standards/#finding-to-control-mapping","title":"Finding to Control Mapping","text":"<p>Each audit finding is mapped to relevant controls:</p> <pre><code>finding := AuditFinding{\n    Finding: processor.Finding{\n        Type:        \"compliance\",\n        Title:       \"Missing Default Deny Policy\",\n        Description: \"Firewall does not implement a default deny policy\",\n        Recommendation: \"Configure firewall to deny all traffic by default\",\n        Component:   \"firewall-rules\",\n        Reference:   \"FIREWALL-003, STIG V-206694\",\n    },\n    STIGReferences: []string{\"V-206694\"},\n    SANSReferences: []string{\"SANS-FW-001\"},\n    FirewallReferences: []string{\"FIREWALL-018\"},\n    ComplianceTags: []string{\"default-deny\", \"firewall-rules\", \"security-posture\"},\n}\n</code></pre>"},{"location":"compliance-standards/#control-status-tracking","title":"Control Status Tracking","text":"<p>The system tracks compliance status for each control:</p> <pre><code>result.STIGCompliance[\"V-206694\"] = false   // Non-compliant\nresult.SANSCompliance[\"SANS-FW-001\"] = false // Non-compliant\nresult.FirewallCompliance[\"FIREWALL-018\"] = false // Non-compliant\n</code></pre>"},{"location":"compliance-standards/#benefits","title":"Benefits","text":""},{"location":"compliance-standards/#for-blue-teams","title":"For Blue Teams","text":"<ol> <li>Standardized Assessment: Use industry-recognized security controls</li> <li>Compliance Reporting: Generate reports for regulatory requirements</li> <li>Risk Prioritization: Focus on high-impact security issues</li> <li>Remediation Guidance: Get specific action items for each finding</li> <li>Framework Alignment: Align with STIG, SANS, and industry best practices</li> </ol>"},{"location":"compliance-standards/#for-organizations","title":"For Organizations","text":"<ol> <li>Regulatory Compliance: Meet STIG, SANS, and industry security requirements</li> <li>Security Posture: Understand current security state</li> <li>Improvement Roadmap: Plan security enhancements</li> <li>Audit Readiness: Prepare for security assessments</li> <li>Industry Standards: Follow recognized best practices</li> </ol>"},{"location":"compliance-standards/#future-enhancements","title":"Future Enhancements","text":""},{"location":"compliance-standards/#planned-features","title":"Planned Features","text":"<ol> <li>Additional Standards: NIST Cybersecurity Framework, ISO 27001</li> <li>Custom Controls: Organization-specific security requirements</li> <li>Automated Remediation: Generate configuration fixes</li> <li>Compliance Monitoring: Track compliance over time</li> <li>Integration: SIEM and ticketing system integration</li> </ol>"},{"location":"compliance-standards/#control-expansion","title":"Control Expansion","text":"<ol> <li>More STIG Controls: Additional DISA security requirements</li> <li>Industry-Specific: Healthcare, finance, government controls</li> <li>Regional Standards: EU, APAC, and other regional requirements</li> <li>Framework Mapping: Cross-reference between standards</li> <li>Additional Controls: Expand firewall security control coverage</li> </ol>"},{"location":"compliance-standards/#references","title":"References","text":"<ul> <li>DISA STIG Library</li> <li>SANS Firewall Checklist</li> <li>CIS-Inspired Firewall Security Controls Reference</li> <li>STIG Viewer</li> <li>NIST Cybersecurity Framework</li> </ul>"},{"location":"compliance-standards/#support","title":"Support","text":"<p>For questions about compliance standards integration:</p> <ol> <li>Documentation: Review this guide and API documentation</li> <li>Issues: Report bugs or feature requests via GitHub</li> <li>Contributions: Submit improvements to compliance mappings</li> <li>Standards: Suggest additional security frameworks to support</li> </ol>"},{"location":"deprecation-policy/","title":"Deprecation Policy","text":""},{"location":"deprecation-policy/#overview","title":"Overview","text":"<p>This document outlines the deprecation policy for opnDossier features and APIs. We follow a predictable lifecycle to ensure stability while allowing the project to evolve.</p>"},{"location":"deprecation-policy/#deprecation-lifecycle","title":"Deprecation Lifecycle","text":"<p>Features and APIs go through a three-stage lifecycle:</p> <ol> <li> <p>Deprecated (Warning Phase)</p> </li> <li> <p>The feature is still fully functional.</p> </li> <li>Usage triggers a warning message (log output, CLI warning).</li> <li>Documentation is updated to reflect deprecation.</li> <li>A migration path is provided.</li> <li> <p>Lasts for at least one minor version (e.g., v2.1 to v2.5).</p> </li> <li> <p>Frozen (Final Phase)</p> </li> <li> <p>The feature is frozen and will receive no further updates or bug fixes.</p> </li> <li>Warnings become more prominent.</li> <li> <p>Lasts for one minor version before removal.</p> </li> <li> <p>Removed</p> </li> <li> <p>The feature is removed from the codebase.</p> </li> <li>Usage results in an error.</li> <li>Occurs in a major version bump (e.g., v3.0).</li> </ol>"},{"location":"deprecation-policy/#current-deprecations","title":"Current Deprecations","text":""},{"location":"deprecation-policy/#template-based-generation","title":"Template-Based Generation","text":"<p>Status: Deprecated (Warning Phase) Since: v2.0 Removal Target: TBD</p> <p>Template-based generation (using <code>text/template</code>) is being replaced by a programmatic generation approach for improved performance, type safety, and maintainability.</p> <p>Impact:</p> <ul> <li>The <code>--use-template</code> flag and custom template support will be removed in v3.0.</li> <li>The <code>markdown.NewMarkdownGeneratorWithTemplates</code> function will be removed.</li> </ul> <p>Migration:</p> <ul> <li>See the Migration Guide for detailed instructions on moving to programmatic generation.</li> </ul>"},{"location":"deprecation-policy/#suppressing-warnings","title":"Suppressing Warnings","text":"<p>Deprecation warnings can be suppressed using the <code>--quiet</code> CLI flag or by setting <code>quiet: true</code> in your configuration file, though this is not recommended as it hides important migration notices.</p>"},{"location":"deprecation-policy/#versioning-policy","title":"Versioning Policy","text":"<p>We adhere to Semantic Versioning:</p> <ul> <li>Major (X.y.z): Incompatible API changes.</li> <li>Minor (x.Y.z): Backward-compatible functionality.</li> <li>Patch (x.y.Z): Backward-compatible bug fixes.</li> </ul>"},{"location":"deprecation-policy/#communication","title":"Communication","text":"<p>Deprecations are communicated via:</p> <ul> <li>Release Notes: Prominently featured in \"Breaking Changes\" or \"Deprecations\".</li> <li>CLI Warnings: Runtime warnings when using deprecated features.</li> <li>Documentation: Updated guides and API references.</li> <li>GitHub Issues: Tracking issues for deprecation progress.</li> </ul>"},{"location":"deprecation-policy/#feedback","title":"Feedback","text":"<p>If a deprecation significantly impacts your workflow, please open a GitHub issue to discuss your use case. We value user feedback and may adjust timelines based on community needs.</p>"},{"location":"examples/","title":"opnDossier Examples","text":""},{"location":"examples/#overview","title":"Overview","text":"<p>This document provides real-world usage examples and patterns for opnDossier's programmatic markdown generation. These examples demonstrate the transition from template-based to programmatic generation, showcasing improved performance and type safety.</p>"},{"location":"examples/#basic-usage-examples","title":"Basic Usage Examples","text":""},{"location":"examples/#simple-configuration-report","title":"Simple Configuration Report","text":"<p>Before (Template Mode v1.x):</p> <pre><code># Template-based generation (slower, less memory efficient)\nopnDossier convert config.xml --use-template -o report.md\n</code></pre> <p>After (Programmatic Mode v2.0+):</p> <pre><code># Programmatic generation (designed for better performance and memory efficiency)\nopnDossier convert config.xml -o report.md\n</code></pre>"},{"location":"examples/#security-focused-analysis","title":"Security-Focused Analysis","text":"<pre><code># Generate comprehensive security report\nopnDossier convert config.xml -o security-audit.md --include-tunables\n\n# High-security focus with detailed analysis\nopnDossier convert config.xml -o detailed-audit.md --security-focus high\n\n# Export for further analysis\nopnDossier convert config.xml -f json -o config-data.json\n</code></pre>"},{"location":"examples/#programming-examples","title":"Programming Examples","text":""},{"location":"examples/#basic-go-integration","title":"Basic Go Integration","text":"<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n\n    \"github.com/EvilBit-Labs/opnDossier/internal/converter\"\n    \"github.com/EvilBit-Labs/opnDossier/internal/parser\"\n)\n\nfunc main() {\n    // Parse OPNsense configuration\n    xmlParser := parser.NewXMLParser()\n    config, err := xmlParser.ParseFile(\"config.xml\")\n    if err != nil {\n        log.Fatalf(\"Failed to parse config: %v\", err)\n    }\n\n    // Create markdown builder\n    builder := converter.NewMarkdownBuilder()\n\n    // Generate standard report\n    report, err := builder.BuildStandardReport(config)\n    if err != nil {\n        log.Fatalf(\"Failed to generate report: %v\", err)\n    }\n\n    fmt.Println(\"=== OPNsense Configuration Report ===\")\n    fmt.Println(report)\n}\n</code></pre>"},{"location":"examples/#custom-security-assessment","title":"Custom Security Assessment","text":"<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strings\"\n\n    \"github.com/EvilBit-Labs/opnDossier/internal/converter\"\n    \"github.com/EvilBit-Labs/opnDossier/internal/model\"\n)\n\nfunc generateSecurityAudit(config *model.OpnSenseDocument) string {\n    builder := converter.NewMarkdownBuilder()\n\n    var report strings.Builder\n\n    // Header with security score\n    score := builder.CalculateSecurityScore(config)\n    riskLevel := builder.AssessRiskLevel(determineRiskFromScore(score))\n\n    report.WriteString(\"# Security Audit Report\\n\\n\")\n    report.WriteString(fmt.Sprintf(\"**Security Score:** %d/100 %s\\n\\n\", score, riskLevel))\n\n    // System tunables analysis\n    if config.Sysctl != nil {\n        securityTunables := builder.FilterSystemTunables(config.Sysctl.Item, true)\n        report.WriteString(\"## Security-Related System Tunables\\n\\n\")\n\n        if len(securityTunables) &gt; 0 {\n            report.WriteString(\"| Tunable | Value | Description |\\n\")\n            report.WriteString(\"|---------|-------|-------------|\\n\")\n\n            for _, tunable := range securityTunables {\n                escapedDesc := builder.EscapeMarkdownSpecialChars(tunable.Descr)\n                report.WriteString(fmt.Sprintf(\"| `%s` | `%s` | %s |\\n\",\n                    tunable.Tunable, tunable.Value, escapedDesc))\n            }\n        } else {\n            report.WriteString(\"*No security-related tunables found.*\\n\")\n        }\n        report.WriteString(\"\\n\")\n    }\n\n    // Service status analysis\n    if len(config.Installedpackages.Services) &gt; 0 {\n        serviceGroups := builder.GroupServicesByStatus(config.Installedpackages.Services)\n\n        report.WriteString(\"## Service Status Summary\\n\\n\")\n        report.WriteString(fmt.Sprintf(\"- **Running Services:** %d\\n\", len(serviceGroups[\"running\"])))\n        report.WriteString(fmt.Sprintf(\"- **Stopped Services:** %d\\n\", len(serviceGroups[\"stopped\"])))\n        report.WriteString(\"\\n\")\n\n        // Risk assessment for running services\n        if len(serviceGroups[\"running\"]) &gt; 0 {\n            report.WriteString(\"### Running Services Risk Assessment\\n\\n\")\n            for _, service := range serviceGroups[\"running\"] {\n                risk := builder.AssessServiceRisk(service)\n                report.WriteString(fmt.Sprintf(\"- **%s**: %s\\n\", service.Name, risk))\n            }\n            report.WriteString(\"\\n\")\n        }\n    }\n\n    return report.String()\n}\n\nfunc determineRiskFromScore(score int) string {\n    switch {\n    case score &gt;= 80:\n        return \"low\"\n    case score &gt;= 60:\n        return \"medium\"\n    case score &gt;= 40:\n        return \"high\"\n    default:\n        return \"critical\"\n    }\n}\n</code></pre>"},{"location":"examples/#firewall-rules-analysis","title":"Firewall Rules Analysis","text":"<pre><code>func analyzeFirewallRules(config *model.OpnSenseDocument) string {\n    builder := converter.NewMarkdownBuilder()\n\n    var report strings.Builder\n    report.WriteString(\"# Firewall Rules Analysis\\n\\n\")\n\n    // Extract all firewall rules\n    var allRules []model.Rule\n    if config.Filter != nil {\n        allRules = config.Filter.Rule\n    }\n\n    if len(allRules) == 0 {\n        report.WriteString(\"*No firewall rules configured.*\\n\")\n        return report.String()\n    }\n\n    // Generate rules table\n    rulesTable := builder.BuildFirewallRulesTable(allRules)\n    report.WriteString(rulesTable.String())\n    report.WriteString(\"\\n\")\n\n    // Rules statistics\n    report.WriteString(\"## Rules Statistics\\n\\n\")\n\n    allowRules := 0\n    blockRules := 0\n    for _, rule := range allRules {\n        if rule.Type == \"pass\" {\n            allowRules++\n        } else if rule.Type == \"block\" {\n            blockRules++\n        }\n    }\n\n    report.WriteString(fmt.Sprintf(\"- **Total Rules:** %d\\n\", len(allRules)))\n    report.WriteString(fmt.Sprintf(\"- **Allow Rules:** %d\\n\", allowRules))\n    report.WriteString(fmt.Sprintf(\"- **Block Rules:** %d\\n\", blockRules))\n\n    // Security recommendations\n    report.WriteString(\"\\n## Security Recommendations\\n\\n\")\n\n    if blockRules == 0 {\n        report.WriteString(\"\u26a0\ufe0f **Warning:** No explicit block rules found. Consider adding deny rules for defense in depth.\\n\")\n    }\n\n    if float64(allowRules)/float64(len(allRules)) &gt; 0.8 {\n        report.WriteString(\"\u26a0\ufe0f **Warning:** High ratio of allow rules. Review for overly permissive access.\\n\")\n    }\n\n    return report.String()\n}\n</code></pre>"},{"location":"examples/#advanced-integration-examples","title":"Advanced Integration Examples","text":""},{"location":"examples/#cicd-pipeline-integration","title":"CI/CD Pipeline Integration","text":"<pre><code># .github/workflows/security-audit.yml\nname: OPNsense Security Audit\n\non:\n  pull_request:\n    paths:\n      - configs/*.xml\n\njobs:\n  security-audit:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n\n      - name: Setup Go\n        uses: actions/setup-go@v4\n        with:\n          go-version: '1.21'\n      - name: Install opnDossier\n        run: go install github.com/EvilBit-Labs/opnDossier@latest\n\n      - name: Generate Security Reports\n        run: |\n          mkdir -p reports\n          for config in configs/*.xml; do\n            filename=$(basename \"$config\" .xml)\n            opnDossier convert \"$config\" -o \"reports/${filename}-audit.md\" --include-tunables\n          done\n\n      - name: Upload Reports\n        uses: actions/upload-artifact@v3\n        with:\n          name: security-reports\n          path: reports/\n</code></pre>"},{"location":"examples/#batch-processing-script","title":"Batch Processing Script","text":"<pre><code>#!/bin/bash\n# batch-audit.sh - Process multiple OPNsense configurations\n\nset -euo pipefail\n\nCONFIG_DIR=\"./configs\"\nOUTPUT_DIR=\"./reports\"\nOPNDOSSIER_BIN=\"./opnDossier\"\n\n# Create output directory\nmkdir -p \"$OUTPUT_DIR\"\n\necho \"Starting batch security audit...\"\n\n# Process each configuration file\nfor config_file in \"$CONFIG_DIR\"/*.xml; do\n    if [[ -f \"$config_file\" ]]; then\n        filename=$(basename \"$config_file\" .xml)\n        output_file=\"$OUTPUT_DIR/${filename}-security-audit.md\"\n\n        echo \"Processing: $config_file\"\n\n        # Generate comprehensive security report\n        if \"$OPNDOSSIER_BIN\" convert \"$config_file\" \\\n            -o \"$output_file\" \\\n            --include-tunables \\\n            --security-focus high; then\n            echo \"\u2713 Generated: $output_file\"\n        else\n            echo \"\u2717 Failed to process: $config_file\"\n        fi\n    fi\ndone\n\necho \"Batch audit complete. Reports saved to: $OUTPUT_DIR\"\n\n# Generate summary report\necho \"Generating summary report...\"\ncat &gt; \"$OUTPUT_DIR/audit-summary.md\" &lt;&lt; EOF\n# Security Audit Summary\n\nGenerated: $(date)\n\n## Processed Configurations\n\n$(find \"$OUTPUT_DIR\" -name \"*-security-audit.md\" -exec basename {} .md \\; | sed 's/^/- /')\n\n## Quick Access\n\n$(find \"$OUTPUT_DIR\" -name \"*-security-audit.md\" -exec bash -c 'echo \"- [$(basename \"{}\" -security-audit.md)](./$(basename \"{}\"))\"' \\;)\nEOF\n\necho \"\u2713 Summary report: $OUTPUT_DIR/audit-summary.md\"\n</code></pre>"},{"location":"examples/#custom-report-templates-go","title":"Custom Report Templates (Go)","text":"<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n    \"text/template\"\n\n    \"github.com/EvilBit-Labs/opnDossier/internal/converter\"\n    \"github.com/EvilBit-Labs/opnDossier/internal/model\"\n)\n\n// ReportData aggregates all analysis results\ntype ReportData struct {\n    Config         *model.OpnSenseDocument\n    SecurityScore  int\n    RiskLevel      string\n    ServiceGroups  map[string][]model.Service\n    SecurityTunables []model.SysctlItem\n    Timestamp      string\n}\n\nfunc generateCustomReport(config *model.OpnSenseDocument) error {\n    builder := converter.NewMarkdownBuilder()\n\n    // Gather all analysis data\n    data := ReportData{\n        Config:           config,\n        SecurityScore:    builder.CalculateSecurityScore(config),\n        ServiceGroups:    builder.GroupServicesByStatus(config.Installedpackages.Services),\n        Timestamp:        builder.FormatTimestamp(time.Now()),\n    }\n\n    data.RiskLevel = builder.AssessRiskLevel(determineRiskFromScore(data.SecurityScore))\n\n    if config.Sysctl != nil {\n        data.SecurityTunables = builder.FilterSystemTunables(config.Sysctl.Item, true)\n    }\n\n    // Define custom report template\n    reportTemplate := `# {{ .Config.System.Hostname }} Security Assessment\n\n**Generated:** {{ .Timestamp }}\n**Security Score:** {{ .SecurityScore }}/100 {{ .RiskLevel }}\n\n## Executive Summary\n\nThis report provides a comprehensive security assessment of the OPNsense configuration for {{ .Config.System.Hostname }}.{{ .Config.System.Domain }}.\n\n### Key Findings\n\n- **System Security Score:** {{ .SecurityScore }}/100\n- **Risk Classification:** {{ .RiskLevel }}\n- **Running Services:** {{ len (index .ServiceGroups \"running\") }}\n- **Security Tunables:** {{ len .SecurityTunables }}\n\n{{ if lt .SecurityScore 70 }}\n\u26a0\ufe0f **ATTENTION:** This configuration has a security score below 70/100. Immediate review recommended.\n{{ end }}\n\n## Detailed Analysis\n\n### Service Status\n{{ range $status, $services := .ServiceGroups }}\n#### {{ title $status }} Services ({{ len $services }})\n{{ range $services }}\n- {{ .Name }}{{ if .Description }} - {{ .Description }}{{ end }}\n{{ end }}\n{{ end }}\n\n### Security Configuration\n{{ if .SecurityTunables }}\nThe following security-related system tunables are configured:\n\n| Tunable | Value |\n|---------|-------|\n{{ range .SecurityTunables }}| ` + \"`{{ .Tunable }}`\" + ` | ` + \"`{{ .Value }}`\" + ` |\n{{ end }}\n{{ else }}\n*No security-related tunables configured.*\n{{ end }}\n\n---\n*Report generated by opnDossier v2.0 - Programmatic Generation Mode*\n`\n\n    // Parse and execute template\n    tmpl, err := template.New(\"security-report\").Parse(reportTemplate)\n    if err != nil {\n        return fmt.Errorf(\"failed to parse template: %w\", err)\n    }\n\n    // Generate report\n    output, err := os.Create(fmt.Sprintf(\"%s-security-report.md\", data.Config.System.Hostname))\n    if err != nil {\n        return fmt.Errorf(\"failed to create output file: %w\", err)\n    }\n    defer output.Close()\n\n    if err := tmpl.Execute(output, data); err != nil {\n        return fmt.Errorf(\"failed to execute template: %w\", err)\n    }\n\n    fmt.Printf(\"Custom security report generated: %s-security-report.md\\n\", data.Config.System.Hostname)\n    return nil\n}\n</code></pre>"},{"location":"examples/#performance-optimization-examples","title":"Performance Optimization Examples","text":""},{"location":"examples/#efficient-bulk-processing","title":"Efficient Bulk Processing","text":"<pre><code>func processMultipleConfigs(configFiles []string) error {\n    // Create reusable components\n    parser := parser.NewXMLParser()\n    builder := converter.NewMarkdownBuilder()\n\n    // Pre-allocate results\n    results := make([]string, 0, len(configFiles))\n\n    // Process in optimized batches\n    batchSize := 10\n    for i := 0; i &lt; len(configFiles); i += batchSize {\n        end := i + batchSize\n        if end &gt; len(configFiles) {\n            end = len(configFiles)\n        }\n\n        // Process batch\n        for j := i; j &lt; end; j++ {\n            config, err := parser.ParseFile(configFiles[j])\n            if err != nil {\n                log.Printf(\"Failed to parse %s: %v\", configFiles[j], err)\n                continue\n            }\n\n            report, err := builder.BuildStandardReport(config)\n            if err != nil {\n                log.Printf(\"Failed to generate report for %s: %v\", configFiles[j], err)\n                continue\n            }\n\n            results = append(results, report)\n        }\n\n        // Optional: Memory cleanup between batches\n        // runtime.GC()\n    }\n\n    log.Printf(\"Successfully processed %d/%d configurations\", len(results), len(configFiles))\n    return nil\n}\n</code></pre>"},{"location":"examples/#concurrent-report-generation","title":"Concurrent Report Generation","text":"<pre><code>func concurrentReportGeneration(configs []*model.OpnSenseDocument) []string {\n    builder := converter.NewMarkdownBuilder()\n\n    type result struct {\n        index  int\n        report string\n        err    error\n    }\n\n    // Create worker pool\n    workers := runtime.NumCPU()\n    jobs := make(chan int, len(configs))\n    results := make(chan result, len(configs))\n\n    // Start workers\n    for w := 0; w &lt; workers; w++ {\n        go func() {\n            for index := range jobs {\n                report, err := builder.BuildStandardReport(configs[index])\n                results &lt;- result{index: index, report: report, err: err}\n            }\n        }()\n    }\n\n    // Send jobs\n    for i := range configs {\n        jobs &lt;- i\n    }\n    close(jobs)\n\n    // Collect results\n    reports := make([]string, len(configs))\n    for i := 0; i &lt; len(configs); i++ {\n        result := &lt;-results\n        if result.err == nil {\n            reports[result.index] = result.report\n        } else {\n            log.Printf(\"Failed to generate report for config %d: %v\", result.index, result.err)\n        }\n    }\n\n    return reports\n}\n</code></pre>"},{"location":"examples/#migration-examples","title":"Migration Examples","text":""},{"location":"examples/#template-to-programmatic-conversion","title":"Template to Programmatic Conversion","text":"<p>Before (Template Mode):</p> <pre><code>// Old template-based approach\nfunc generateReportOld(config *model.OpnSenseDocument) (string, error) {\n    tmpl := `\n    {{/* Template logic */}}\n    {{ if .System.Hostname }}\n    # {{ .System.Hostname }} Configuration\n    {{ end }}\n\n    ## Security Score: {{ getRiskLevel .SecurityLevel }}\n\n    {{ range .Services }}\n    - {{ .Name }}: {{ .Status | upper }}\n    {{ end }}\n    `\n\n    // Parse and execute template (slower, less type-safe)\n    t, err := template.New(\"report\").Parse(tmpl)\n    if err != nil {\n        return \"\", err\n    }\n\n    var buf bytes.Buffer\n    if err := t.Execute(&amp;buf, config); err != nil {\n        return \"\", err\n    }\n\n    return buf.String(), nil\n}\n</code></pre> <p>After (Programmatic Mode):</p> <pre><code>// New programmatic approach\nfunc generateReportNew(config *model.OpnSenseDocument) (string, error) {\n    builder := converter.NewMarkdownBuilder()\n\n    var report strings.Builder\n\n    // Type-safe, compile-time checked operations\n    if config.System.Hostname != \"\" {\n        report.WriteString(fmt.Sprintf(\"# %s Configuration\\n\\n\",\n            builder.EscapeMarkdownSpecialChars(config.System.Hostname)))\n    }\n\n    // Direct method calls with proper error handling\n    score := builder.CalculateSecurityScore(config)\n    riskLevel := builder.AssessRiskLevel(determineRiskFromScore(score))\n    report.WriteString(fmt.Sprintf(\"## Security Score: %s\\n\\n\", riskLevel))\n\n    // Efficient service processing\n    serviceGroups := builder.GroupServicesByStatus(config.Installedpackages.Services)\n    for status, services := range serviceGroups {\n        for _, service := range services {\n            report.WriteString(fmt.Sprintf(\"- %s: %s\\n\",\n                service.Name, strings.ToUpper(status)))\n        }\n    }\n\n    return report.String(), nil\n}\n</code></pre>"},{"location":"examples/#troubleshooting-examples","title":"Troubleshooting Examples","text":""},{"location":"examples/#common-error-handling","title":"Common Error Handling","text":"<pre><code>func robustReportGeneration(configFile string) error {\n    // Parse configuration with error handling\n    parser := parser.NewXMLParser()\n    config, err := parser.ParseFile(configFile)\n    if err != nil {\n        switch {\n        case os.IsNotExist(err):\n            return fmt.Errorf(\"configuration file not found: %s\", configFile)\n        case strings.Contains(err.Error(), \"invalid XML\"):\n            return fmt.Errorf(\"malformed XML in configuration file: %w\", err)\n        default:\n            return fmt.Errorf(\"failed to parse configuration: %w\", err)\n        }\n    }\n\n    // Generate report with comprehensive error handling\n    builder := converter.NewMarkdownBuilder()\n    report, err := builder.BuildStandardReport(config)\n    if err != nil {\n        switch {\n        case errors.Is(err, converter.ErrInvalidData):\n            // Handle data validation errors\n            log.Printf(\"Configuration data validation failed: %v\", err)\n            return fmt.Errorf(\"invalid configuration data: %w\", err)\n        case errors.Is(err, converter.ErrGenerationFailed):\n            // Handle generation-specific errors\n            log.Printf(\"Report generation failed: %v\", err)\n            return fmt.Errorf(\"failed to generate markdown: %w\", err)\n        default:\n            // Handle unexpected errors\n            log.Printf(\"Unexpected error during report generation: %v\", err)\n            return fmt.Errorf(\"unexpected error: %w\", err)\n        }\n    }\n\n    // Save report\n    outputFile := strings.TrimSuffix(configFile, \".xml\") + \"-report.md\"\n    if err := os.WriteFile(outputFile, []byte(report), 0644); err != nil {\n        return fmt.Errorf(\"failed to write report to %s: %w\", outputFile, err)\n    }\n\n    log.Printf(\"Successfully generated report: %s\", outputFile)\n    return nil\n}\n</code></pre>"},{"location":"examples/#performance-debugging","title":"Performance Debugging","text":"<pre><code>func benchmarkReportGeneration(config *model.OpnSenseDocument) {\n    builder := converter.NewMarkdownBuilder()\n\n    // Measure total generation time\n    start := time.Now()\n    report, err := builder.BuildStandardReport(config)\n    totalTime := time.Since(start)\n\n    if err != nil {\n        log.Printf(\"Generation failed: %v\", err)\n        return\n    }\n\n    // Performance metrics\n    log.Printf(\"Report generation completed:\")\n    log.Printf(\"  - Total time: %v\", totalTime)\n    log.Printf(\"  - Report size: %d characters\", len(report))\n    log.Printf(\"  - Generation rate: %.2f chars/ms\", float64(len(report))/float64(totalTime.Milliseconds()))\n\n    // Memory usage (requires runtime profiling)\n    var m runtime.MemStats\n    runtime.ReadMemStats(&amp;m)\n    log.Printf(\"  - Memory allocated: %d KB\", m.Alloc/1024)\n    log.Printf(\"  - Total allocations: %d\", m.TotalAlloc/1024)\n}\n</code></pre>"},{"location":"examples/#best-practices-summary","title":"Best Practices Summary","text":"<ol> <li>Always handle errors explicitly - The programmatic API provides detailed error information</li> <li>Reuse builder instances - Create once, use multiple times for better performance</li> <li>Use defensive programming - Check for nil pointers and empty collections</li> <li>Pre-allocate slices when size is predictable</li> <li>Profile performance for large datasets or high-frequency operations</li> <li>Leverage type safety - Compile-time checks prevent runtime template errors</li> <li>Follow Go conventions - Use standard Go patterns and idioms</li> </ol> <p>For more examples and detailed migration guidance, see:</p> <ul> <li>API Documentation</li> <li>Migration Guide</li> <li>Architecture Overview</li> </ul>"},{"location":"migration-guide-3.7/","title":"opnDossier Phase 3.7 Migration Guide","text":""},{"location":"migration-guide-3.7/#overview","title":"Overview","text":"<p>Phase 3.7 introduces programmatic generation as the default mode for improved performance, security, and maintainability. Template-based generation remains available through explicit flags for backward compatibility.</p>"},{"location":"migration-guide-3.7/#key-changes","title":"Key Changes","text":""},{"location":"migration-guide-3.7/#new-default-programmatic-mode","title":"New Default: Programmatic Mode","text":"<ul> <li>Before: Template-based generation was the default</li> <li>After: Programmatic generation is the default</li> <li>Benefits: Faster execution, enhanced security, deterministic output</li> </ul> <p>Note: the template engine is Markdown-only - JSON and YAML outputs are always produced programmatically.</p>"},{"location":"migration-guide-3.7/#new-cli-flags","title":"New CLI Flags","text":"<ul> <li><code>--engine {programmatic|template}</code> - Explicit engine selection (highest precedence)</li> <li><code>--use-template</code> - Enable built-in template mode</li> <li><code>--legacy</code> - Enable legacy template mode (deprecated, shows warning)</li> </ul>"},{"location":"migration-guide-3.7/#enhanced-configuration","title":"Enhanced Configuration","text":"<ul> <li><code>engine: \"programmatic\"</code> - Set default engine in config file</li> <li><code>use_template: true</code> - Enable template mode in config file</li> </ul>"},{"location":"migration-guide-3.7/#environment-variables","title":"Environment Variables","text":"<p>All configuration options support environment variables with <code>OPNDOSSIER_</code> prefix for CI/offline usage:</p>"},{"location":"migration-guide-3.7/#new-configuration-keys","title":"New Configuration Keys","text":"Config Key Environment Variable Type Default Description <code>engine</code> <code>OPNDOSSIER_ENGINE</code> string <code>\"programmatic\"</code> Generation engine (<code>programmatic</code> or <code>template</code>) <code>use_template</code> <code>OPNDOSSIER_USE_TEMPLATE</code> boolean <code>false</code> Enable template mode"},{"location":"migration-guide-3.7/#environment-variable-usage","title":"Environment Variable Usage","text":"<p>String Values:</p> <pre><code>export OPNDOSSIER_ENGINE=template\nexport OPNDOSSIER_ENGINE=\"programmatic\"\n</code></pre> <p>Boolean Values:</p> <pre><code>export OPNDOSSIER_USE_TEMPLATE=true\nexport OPNDOSSIER_USE_TEMPLATE=false\n</code></pre> <p>CI/Offline Examples:</p> <pre><code># Set engine for CI pipeline\nOPNDOSSIER_ENGINE=template opndossier convert config.xml\n\n# Enable template mode in offline environment\nOPNDOSSIER_USE_TEMPLATE=true opndossier convert config.xml --comprehensive\n\n# Override multiple settings\nOPNDOSSIER_ENGINE=template OPNDOSSIER_USE_TEMPLATE=true opndossier convert config.xml\n</code></pre> <p>Precedence Order:</p> <ol> <li>Command-line flags (highest priority)</li> <li>Environment variables (<code>OPNDOSSIER_*</code>)</li> <li>Configuration file (<code>~/.opnDossier.yaml</code>)</li> <li>Default values (lowest priority)</li> </ol> <p>Environment variables override configuration file settings, making them ideal for CI/CD pipelines and offline deployments where file-based configuration may not be available.</p>"},{"location":"migration-guide-3.7/#migration-examples","title":"Migration Examples","text":""},{"location":"migration-guide-3.7/#for-existing-template-users","title":"For Existing Template Users","text":"<p>Old command:</p> <pre><code>./opndossier convert config.xml --comprehensive\n</code></pre> <p>New command (to maintain template behavior):</p> <pre><code>./opndossier convert config.xml --use-template --comprehensive\n</code></pre>"},{"location":"migration-guide-3.7/#for-custom-template-users","title":"For Custom Template Users","text":"<p>Old command:</p> <pre><code>./opndossier convert config.xml --custom-template my-template.tmpl\n</code></pre> <p>New command (unchanged - automatically enables template mode):</p> <pre><code>./opndossier convert config.xml --custom-template my-template.tmpl\n</code></pre>"},{"location":"migration-guide-3.7/#for-new-users-recommended","title":"For New Users (Recommended)","text":"<p>Use default programmatic mode:</p> <pre><code>./opndossier convert config.xml --comprehensive\n</code></pre>"},{"location":"migration-guide-3.7/#flag-precedence-order","title":"Flag Precedence Order","text":"<ol> <li><code>--engine</code> flag (highest priority)</li> <li><code>--legacy</code> flag (deprecated)</li> <li><code>--custom-template</code> flag (automatically enables template mode)</li> <li><code>--use-template</code> flag</li> <li>Configuration file settings</li> <li>Default (programmatic mode)</li> </ol>"},{"location":"migration-guide-3.7/#configuration-examples","title":"Configuration Examples","text":""},{"location":"migration-guide-3.7/#programmatic-mode-default","title":"Programmatic Mode (Default)","text":"<pre><code># .opnDossier.yaml\nengine: programmatic\nformat: markdown\ncomprehensive: true\n</code></pre>"},{"location":"migration-guide-3.7/#template-mode","title":"Template Mode","text":"<pre><code># .opnDossier.yaml\nengine: template\ntemplate: default\n</code></pre>"},{"location":"migration-guide-3.7/#alternative-template-mode","title":"Alternative Template Mode","text":"<pre><code># .opnDossier.yaml\nuse_template: true\ntemplate: comprehensive\n</code></pre>"},{"location":"migration-guide-3.7/#security-improvements","title":"Security Improvements","text":""},{"location":"migration-guide-3.7/#template-path-validation","title":"Template Path Validation","text":"<ul> <li>Automatic path traversal protection</li> <li>File extension validation</li> <li>Security logging for template operations</li> </ul>"},{"location":"migration-guide-3.7/#examples-of-blocked-paths","title":"Examples of Blocked Paths","text":"<pre><code># These will be blocked:\n./opndossier convert config.xml --custom-template \"../../../etc/passwd\"\n./opndossier convert config.xml --custom-template \"../../sensitive/file\"\n</code></pre>"},{"location":"migration-guide-3.7/#performance-comparison","title":"Performance Comparison","text":"Mode Performance Security Features Programmatic (default) 5/5 5/5 Full feature set Template \u2157 \u2158 Full feature set"},{"location":"migration-guide-3.7/#testing-your-migration","title":"Testing Your Migration","text":""},{"location":"migration-guide-3.7/#test-default-behavior","title":"Test Default Behavior","text":"<pre><code># Should use programmatic mode by default\n./opndossier convert config.xml --verbose\n# Look for: \"Using programmatic engine (default)\"\n</code></pre>"},{"location":"migration-guide-3.7/#test-template-override","title":"Test Template Override","text":"<pre><code># Should use template mode\n./opndossier convert config.xml --use-template --verbose\n# Look for: \"Using template engine (explicit --use-template flag)\"\n</code></pre>"},{"location":"migration-guide-3.7/#test-deprecation-warning","title":"Test Deprecation Warning","text":"<pre><code># Should show deprecation warning\n./opndossier convert config.xml --legacy --verbose\n# Look for: \"Legacy mode is deprecated and will be removed in v3.0\"\n</code></pre>"},{"location":"migration-guide-3.7/#troubleshooting","title":"Troubleshooting","text":""},{"location":"migration-guide-3.7/#template-not-found-error","title":"Template Not Found Error","text":"<p>If you see \"template not found\" errors when using template mode, this is expected behavior when built-in templates are not configured. Use programmatic mode (default) or specify a valid custom template.</p>"},{"location":"migration-guide-3.7/#configuration-validation","title":"Configuration Validation","text":"<pre><code># Test your configuration file\n./opndossier --config your-config.yaml convert --help\n</code></pre>"},{"location":"migration-guide-3.7/#verbose-logging","title":"Verbose Logging","text":"<p>Add <code>--verbose</code> to any command to see detailed engine selection logging:</p> <pre><code>./opndossier convert config.xml --verbose\n</code></pre>"},{"location":"migration-guide-3.7/#support","title":"Support","text":"<p>For questions about migration:</p> <ol> <li>Check the built-in help: <code>./opndossier convert --help</code></li> <li>Review the examples in the help output</li> <li>Use <code>--verbose</code> flag to understand engine selection</li> <li>Refer to this migration guide</li> </ol>"},{"location":"migration-guide-3.7/#timeline","title":"Timeline","text":"<ul> <li>v2.x: Both modes available, programmatic mode default</li> <li>v3.0: Legacy flag will be removed</li> <li>v4.0: Template mode may become optional package</li> </ul>"},{"location":"migration-guide/","title":"Migration Guide: Templates to Programmatic Generation","text":""},{"location":"migration-guide/#overview","title":"Overview","text":"<p>opnDossier v2.0 introduces a new programmatic markdown generation approach that offers better performance, type safety, and maintainability. This guide helps you migrate from custom templates.</p>"},{"location":"migration-guide/#quick-migration","title":"Quick Migration","text":""},{"location":"migration-guide/#option-1-continue-using-templates-temporary","title":"Option 1: Continue Using Templates (Temporary)","text":"<p>Your existing templates will continue to work with the <code>--use-template</code> flag:</p> <pre><code># Old way (still works but deprecated)\nopndossier convert -i config.xml -o report.md\n\n# New way to use templates\nopndossier convert -i config.xml -o report.md --use-template --custom-template ./templates/\n</code></pre>"},{"location":"migration-guide/#option-2-migrate-to-programmatic-recommended","title":"Option 2: Migrate to Programmatic (Recommended)","text":""},{"location":"migration-guide/#custom-template-function-mapping","title":"Custom Template Function Mapping","text":"Template Function Programmatic Method Notes <code>{{ getRiskLevel .severity }}</code> <code>builder.AssessRiskLevel(severity)</code> Returns emoji + text <code>{{ filterTunables .tunables true }}</code> <code>builder.FilterSystemTunables(tunables, true)</code> Same filtering logic <code>{{ .data \\| formatInterfacesAsLinks }}</code> <code>formatInterfacesAsLinks(data)</code> Internal function, use in custom builders <code>{{ default .value \"N/A\" }}</code> <code>builder.DefaultValue(value, \"N/A\")</code> Sprig replacement <code>{{ truncate 50 .text }}</code> <code>builder.TruncateDescription(text, 50)</code> Sprig replacement <code>{{ .value \\| upper }}</code> <code>builder.ToUpper(value)</code> String case conversion <code>{{ .value \\| lower }}</code> <code>builder.ToLower(value)</code> String case conversion <code>{{ escapeTableContent .content }}</code> <code>builder.EscapeTableContent(content)</code> Safe table content <code>{{ formatBoolean .value }}</code> <code>markdown.FormatBoolean(value)</code> Boolean formatting <code>{{ formatUnixTimestamp .timestamp }}</code> <code>markdown.FormatUnixTimestamp(timestamp)</code> Time formatting"},{"location":"migration-guide/#creating-custom-reports","title":"Creating Custom Reports","text":""},{"location":"migration-guide/#before-template","title":"Before (Template)","text":"<pre><code>{{ define \"custom-section\" }}\n## Custom Analysis\nRisk Level: {{ getRiskLevel .severity }}\nInterfaces: {{ .interfaces | formatInterfacesAsLinks }}\n{{ end }}\n</code></pre>"},{"location":"migration-guide/#after-programmatic","title":"After (Programmatic)","text":"<pre><code>func (b *CustomBuilder) WriteCustomSection(data *model.OpnSenseDocument) {\n    var section strings.Builder\n    section.WriteString(\"## Custom Analysis\\n\")\n\n    // Risk assessment using MarkdownBuilder method\n    risk := b.AssessRiskLevel(\"high\")\n    section.WriteString(fmt.Sprintf(\"Risk Level: %s\\n\", risk))\n\n    // Interface links using internal function\n    if !data.Interfaces.IsEmpty() {\n        interfaceLinks := formatInterfacesAsLinks(data.Interfaces.Wan) // Use internal function\n        section.WriteString(fmt.Sprintf(\"Interfaces: %s\\n\", interfaceLinks))\n    }\n\n    return section.String()\n}\n</code></pre>"},{"location":"migration-guide/#extending-the-builder","title":"Extending the Builder","text":""},{"location":"migration-guide/#creating-a-custom-builder","title":"Creating a Custom Builder","text":"<pre><code>package custom\n\nimport \"github.com/EvilBit-Labs/opnDossier/internal/converter\"\n\ntype MyCustomBuilder struct {\n    *converter.MarkdownBuilder\n}\n\nfunc NewCustomBuilder() *MyCustomBuilder {\n    return &amp;MyCustomBuilder{\n        MarkdownBuilder: converter.NewMarkdownBuilder(),\n    }\n}\n\nfunc (b *MyCustomBuilder) AddCustomSection(data *model.OpnSenseDocument) {\n    // Your custom logic here\n    b.WriteHeader(2, \"My Custom Section\")\n    // Use inherited methods\n    risk := b.AssessRiskLevel(\"high\")\n    b.WriteParagraph(\"Risk: \" + risk)\n}\n</code></pre>"},{"location":"migration-guide/#common-migration-patterns","title":"Common Migration Patterns","text":""},{"location":"migration-guide/#pattern-1-conditional-sections","title":"Pattern 1: Conditional Sections","text":"<p>Template:</p> <pre><code>{{ if .showDetails }}\n  {{ template \"details\" . }}\n{{ end }}\n</code></pre> <p>Programmatic:</p> <pre><code>if showDetails {\n    b.WriteDetailsSection(data)\n}\n</code></pre>"},{"location":"migration-guide/#pattern-2-loops-and-formatting","title":"Pattern 2: Loops and Formatting","text":"<p>Template:</p> <pre><code>{{ range .interfaces }}\n- {{ .name }}: {{ .ip }}\n{{ end }}\n</code></pre> <p>Programmatic:</p> <pre><code>for _, iface := range interfaces {\n    b.WriteListItem(fmt.Sprintf(\"%s: %s\", iface.Name, iface.IP))\n}\n</code></pre>"},{"location":"migration-guide/#pattern-3-complex-data-transformation","title":"Pattern 3: Complex Data Transformation","text":"<p>Template:</p> <pre><code>{{ $securityRules := 0 }}\n{{ range .firewall.rules }}\n  {{ if hasPrefix .description \"security\" }}\n    {{ $securityRules = add $securityRules 1 }}\n  {{ end }}\n{{ end }}\nSecurity Rules: {{ $securityRules }}\n</code></pre> <p>Programmatic:</p> <pre><code>securityRules := 0\nfor _, rule := range data.Filter.Rule {\n    if strings.HasPrefix(strings.ToLower(rule.Description), \"security\") {\n        securityRules++\n    }\n}\nsection.WriteString(fmt.Sprintf(\"Security Rules: %d\\n\", securityRules))\n</code></pre>"},{"location":"migration-guide/#advanced-migration-techniques","title":"Advanced Migration Techniques","text":""},{"location":"migration-guide/#migrating-template-functions-to-methods","title":"Migrating Template Functions to Methods","text":"<p>Step 1: Identify Template Functions</p> <p>Review your custom templates for functions like:</p> <ul> <li><code>{{ myCustomFunction .data }}</code></li> <li><code>{{ .value | customFilter }}</code></li> <li><code>{{ calculateSomething .input1 .input2 }}</code></li> </ul>"},{"location":"migration-guide/#step-2-convert-to-markdownbuilder-methods","title":"Step 2: Convert to MarkdownBuilder Methods","text":"<pre><code>// Add to your custom builder\nfunc (b *MyCustomBuilder) MyCustomFunction(data interface{}) string {\n    // Implement your logic here\n    return fmt.Sprintf(\"processed: %v\", data)\n}\n\nfunc (b *MyCustomBuilder) CustomFilter(value string) string {\n    // Implement your filter logic\n    return strings.TrimSpace(strings.ToUpper(value))\n}\n\nfunc (b *MyCustomBuilder) CalculateSomething(input1, input2 string) int {\n    // Implement your calculation\n    return len(input1) + len(input2)\n}\n</code></pre>"},{"location":"migration-guide/#creating-reusable-components","title":"Creating Reusable Components","text":"<p>Template Components:</p> <pre><code>{{ define \"statusBadge\" }}\n  {{ if eq .status \"active\" }}\ud83d\udfe2{{ else }}\ud83d\udd34{{ end }} {{ .status }}\n{{ end }}\n</code></pre> <p>Programmatic Components:</p> <pre><code>func (b *MyCustomBuilder) StatusBadge(status string) string {\n    icon := \"\ud83d\udd34\" // default\n    if status == \"active\" {\n        icon = \"\ud83d\udfe2\"\n    }\n    return fmt.Sprintf(\"%s %s\", icon, status)\n}\n\n// Usage in reports\nbadge := b.StatusBadge(service.Status)\nsection.WriteString(fmt.Sprintf(\"Service Status: %s\\n\", badge))\n</code></pre>"},{"location":"migration-guide/#performance-optimization","title":"Performance Optimization","text":""},{"location":"migration-guide/#memory-efficient-building","title":"Memory-Efficient Building","text":"<pre><code>func (b *MyCustomBuilder) BuildLargeReport(data *model.OpnSenseDocument) string {\n    // Pre-allocate with estimated capacity\n    var section strings.Builder\n    section.Grow(8192) // Pre-allocate 8KB\n\n    // Build content efficiently\n    b.writeSystemInfo(&amp;section, data)\n    b.writeNetworkInfo(&amp;section, data)\n    b.writeSecurityInfo(&amp;section, data)\n\n    return section.String()\n}\n</code></pre>"},{"location":"migration-guide/#caching-expensive-operations","title":"Caching Expensive Operations","text":"<pre><code>type CustomBuilder struct {\n    *converter.MarkdownBuilder\n    securityScoreCache map[string]int\n}\n\nfunc (b *CustomBuilder) GetCachedSecurityScore(key string, data *model.OpnSenseDocument) int {\n    if score, exists := b.securityScoreCache[key]; exists {\n        return score\n    }\n\n    score := b.CalculateSecurityScore(data)\n    b.securityScoreCache[key] = score\n    return score\n}\n</code></pre>"},{"location":"migration-guide/#testing-your-migration","title":"Testing Your Migration","text":""},{"location":"migration-guide/#unit-testing-programmatic-functions","title":"Unit Testing Programmatic Functions","text":"<pre><code>func TestCustomBuilder_StatusBadge(t *testing.T) {\n    builder := NewCustomBuilder()\n\n    tests := []struct {\n        name     string\n        status   string\n        expected string\n    }{\n        {\"active status\", \"active\", \"\ud83d\udfe2 active\"},\n        {\"inactive status\", \"inactive\", \"\ud83d\udd34 inactive\"},\n        {\"unknown status\", \"unknown\", \"\ud83d\udd34 unknown\"},\n    }\n\n    for _, tt := range tests {\n        t.Run(tt.name, func(t *testing.T) {\n            result := builder.StatusBadge(tt.status)\n            assert.Equal(t, tt.expected, result)\n        })\n    }\n}\n</code></pre>"},{"location":"migration-guide/#integration-testing","title":"Integration Testing","text":"<pre><code>func TestMigrationCompatibility(t *testing.T) {\n    // Load test configuration\n    config := loadTestConfig(t)\n\n    // Generate with programmatic approach\n    builder := NewCustomBuilder()\n    programmaticcOutput := builder.BuildReport(config)\n\n    // Verify key content is present\n    assert.Contains(t, programmaticcOutput, \"System Information\")\n    assert.Contains(t, programmaticcOutput, \"Security Assessment\")\n}\n</code></pre>"},{"location":"migration-guide/#troubleshooting-migration-issues","title":"Troubleshooting Migration Issues","text":""},{"location":"migration-guide/#common-problems-and-solutions","title":"Common Problems and Solutions","text":""},{"location":"migration-guide/#problem-1-missing-template-functions","title":"Problem 1: Missing Template Functions","text":"<pre><code>Error: template function \"myCustomFunc\" not found\n</code></pre> <p>Solution: Implement the function as a MarkdownBuilder method:</p> <pre><code>func (b *MyCustomBuilder) MyCustomFunc(input string) string {\n    // Implement the logic that was in your template function\n    return processInput(input)\n}\n</code></pre>"},{"location":"migration-guide/#problem-2-different-output-format","title":"Problem 2: Different Output Format","text":"<pre><code>Expected: \"Value: 123\"\nGot: \"Value: value=123\"\n</code></pre> <p>Solution: Check string formatting and ensure consistent output:</p> <pre><code>// Template might have: {{ printf \"Value: %s\" .value }}\n// Programmatic should be: fmt.Sprintf(\"Value: %s\", value)\n</code></pre>"},{"location":"migration-guide/#problem-3-type-conversion-issues","title":"Problem 3: Type Conversion Issues","text":"<pre><code>Error: cannot convert interface{} to string\n</code></pre> <p>Solution: Add explicit type checking and conversion:</p> <pre><code>func (b *MyCustomBuilder) SafeStringConvert(value interface{}) string {\n    if value == nil {\n        return \"\"\n    }\n    return fmt.Sprintf(\"%v\", value)\n}\n</code></pre>"},{"location":"migration-guide/#migration-timeline-and-deprecation","title":"Migration Timeline and Deprecation","text":""},{"location":"migration-guide/#current-support-status","title":"Current Support Status","text":"<ul> <li>v2.0+: Programmatic generation is default, template mode deprecated with warnings</li> <li>v2.x: Both modes fully supported (template mode shows deprecation warnings)</li> <li>v3.0: Template mode will be removed (planned)</li> <li>Migration Timeline: Users have the entire v2.x series to migrate before removal in v3.0</li> </ul>"},{"location":"migration-guide/#preparing-for-future-versions","title":"Preparing for Future Versions","text":"<ol> <li>Immediate (v2.x): Migrate custom templates to programmatic approach</li> <li>Before v3.0: Test all custom functionality with programmatic generation</li> <li>Before v3.0: Complete migration and remove template dependencies</li> </ol>"},{"location":"migration-guide/#faq","title":"FAQ","text":"<p>Q: Will my custom templates stop working? A: They'll continue to work with the <code>--use-template</code> flag throughout v2.x (with deprecation warnings), but template mode will be removed in v3.0. We recommend migrating to programmatic generation for better performance and maintainability.</p> <p>Q: Can I mix programmatic and template approaches? A: Yes, during migration you can use hybrid approaches, but it's not recommended for production. Choose one approach for consistency.</p> <p>Q: How do I contribute my custom functions? A: Submit a PR adding your functions to the MarkdownBuilder. We welcome contributions! Follow the existing patterns in <code>internal/converter/markdown_*.go</code> files.</p> <p>Q: Is the programmatic approach faster? A: Yes, programmatic generation is significantly faster than template processing. You'll see 40-70% performance improvements for most reports.</p> <p>Q: Can I still customize the output format? A: Yes, programmatic generation gives you more control over output formatting. You can create custom builders that extend the base MarkdownBuilder.</p> <p>Q: What if I need template-like conditional logic? A: Use standard Go conditional statements (if/else, switch) and loops (for, range). This provides better type safety and IDE support.</p> <p>Q: How do I handle errors in programmatic generation? A: Programmatic generation provides explicit error handling. Methods can return errors that you handle appropriately:</p> <pre><code>report, err := builder.BuildReport(config)\nif err != nil {\n    return fmt.Errorf(\"failed to build report: %w\", err)\n}\n</code></pre> <p>Q: Can I reuse my existing template data processing logic? A: Yes, convert your template logic to Go functions. Many template patterns translate directly to Go code with better performance.</p> <p>Q: Where can I find examples of programmatic generation? A: Check the <code>internal/converter/markdown*.go</code> files for extensive examples of programmatic report generation.</p> <p>Q: How do I validate that my migration is correct? A: Compare template and programmatic outputs using the CLI. Run <code>opnDossier convert config.xml --use-template -o template-output.md</code> and <code>opnDossier convert config.xml -o programmatic-output.md</code>, then use <code>diff</code> to compare. Write unit tests for your custom functions.</p>"},{"location":"migration-guide/#contributing-custom-functions","title":"Contributing Custom Functions","text":"<p>We encourage users to contribute useful custom functions back to the project. Here's how:</p>"},{"location":"migration-guide/#1-add-to-markdownbuilder","title":"1. Add to MarkdownBuilder","text":"<p>Place new methods in the appropriate file:</p> <ul> <li><code>internal/converter/markdown_utils.go</code> - Utility functions</li> <li><code>internal/converter/markdown_transformers.go</code> - Data transformation</li> <li><code>internal/converter/markdown_security.go</code> - Security assessment</li> </ul>"},{"location":"migration-guide/#2-follow-existing-patterns","title":"2. Follow Existing Patterns","text":"<pre><code>// Good: Clear naming, proper error handling, documentation\nfunc (b *MarkdownBuilder) FormatNetworkPort(port string) string {\n    if port == \"\" {\n        return \"any\"\n    }\n    if port == \"22\" {\n        return \"22 (SSH)\"\n    }\n    return port\n}\n</code></pre>"},{"location":"migration-guide/#3-add-tests","title":"3. Add Tests","text":"<pre><code>func TestMarkdownBuilder_FormatNetworkPort(t *testing.T) {\n    builder := NewMarkdownBuilder()\n\n    tests := []struct {\n        name     string\n        port     string\n        expected string\n    }{\n        {\"empty port\", \"\", \"any\"},\n        {\"ssh port\", \"22\", \"22 (SSH)\"},\n        {\"custom port\", \"8080\", \"8080\"},\n    }\n\n    for _, tt := range tests {\n        t.Run(tt.name, func(t *testing.T) {\n            result := builder.FormatNetworkPort(tt.port)\n            assert.Equal(t, tt.expected, result)\n        })\n    }\n}\n</code></pre>"},{"location":"migration-guide/#4-update-documentation","title":"4. Update Documentation","text":"<p>Add your functions to the template migration mapping table in this guide.</p>"},{"location":"migration-guide/#getting-help","title":"Getting Help","text":"<p>If you need assistance with migration:</p> <ol> <li>Documentation: Review this guide and the API documentation</li> <li>Examples: Check <code>internal/converter/</code> for working examples</li> <li>Issues: Open a GitHub issue with the <code>migration</code> label</li> <li>Testing: Compare outputs with <code>opnDossier convert config.xml --use-template</code> vs <code>opnDossier convert config.xml</code></li> <li>Community: Ask questions in GitHub Discussions</li> </ol>"},{"location":"migration/","title":"Migration Guide: Template to Programmatic Generation","text":""},{"location":"migration/#overview","title":"Overview","text":"<p>This guide provides step-by-step instructions for migrating from template-based markdown generation (v1.x) to the new programmatic generation approach (v2.0+). The migration is designed to deliver significantly faster generation with reduced memory usage and compile-time type safety. Performance characteristics can be measured using the comparative benchmarks in <code>internal/converter/markdown_bench_test.go</code>.</p>"},{"location":"migration/#why-migrate","title":"Why Migrate?","text":""},{"location":"migration/#performance-improvements","title":"Performance Improvements","text":"<p>The programmatic approach is designed for improved performance across all metrics:</p> <ul> <li>Generation Speed: Faster report generation</li> <li>Memory Usage: Reduced memory allocations</li> <li>Throughput: Improved reports per second</li> <li>Scalability: Consistent performance across all dataset sizes</li> </ul> <p>To measure actual performance gains for your use case, run the comparative benchmarks:</p> <pre><code># Run markdown generation benchmarks\ngo test -bench=BenchmarkReportGeneration ./internal/converter -benchmem\n\n# Run memory usage benchmarks\ngo test -bench=BenchmarkMemoryUsage ./internal/converter -benchmem\n\n# Run throughput benchmarks\ngo test -bench=BenchmarkThroughput ./internal/converter -benchmem\n</code></pre>"},{"location":"migration/#development-experience","title":"Development Experience","text":"<ul> <li>Type Safety: Compile-time validation vs runtime template errors</li> <li>IDE Support: Full IntelliSense and code completion</li> <li>Error Handling: Explicit error reporting with context</li> <li>Debugging: Standard Go debugging tools and techniques</li> </ul>"},{"location":"migration/#security-operations","title":"Security &amp; Operations","text":"<ul> <li>Red Team Features: Enhanced output obfuscation and offline capabilities</li> <li>Reliability: Reduced silent failures and improved error visibility</li> <li>Maintainability: Direct method calls vs template string manipulation</li> </ul>"},{"location":"migration/#deprecation-timeline","title":"Deprecation Timeline","text":"<p>Action Required: Template support will be completely removed in v3.0. Plan your migration now.</p>"},{"location":"migration/#version-roadmap","title":"Version Roadmap","text":"Version Status Template Support Action Required v2.0 (Current) Active Available via <code>--use-template</code> flag None - templates still supported v2.1 - v2.4 Planned Deprecated with warnings Migrate to programmatic mode v2.5 Migration Deadline Deprecated, removal imminent Complete migration by Q2 2025 v3.0 Removal Complete removal Templates will no longer work"},{"location":"migration/#migration-deadlines","title":"Migration Deadlines","text":"<ul> <li>Q2 2025: v2.5 release - Final migration deadline before template removal</li> <li>Q3 2025: v3.0 release - Template support completely removed</li> </ul>"},{"location":"migration/#what-this-means","title":"What This Means","text":"<ul> <li>Currently: v2.0 continues supporting templates with <code>--use-template</code> flag if needed.</li> <li>Deprecation warnings appear: Starting with v2.1-v2.4 when using template mode.</li> <li>By v2.5: This becomes the last version with template support (deprecated).</li> <li>From v3.0 onward: Template mode fails - programmatic mode only.</li> </ul>"},{"location":"migration/#suppressing-warnings","title":"Suppressing Warnings","text":"<p>If you need to suppress deprecation warnings (not recommended), you can use the <code>--quiet</code> flag:</p> <pre><code>opnDossier convert config.xml --use-template --quiet\n</code></pre> <p>Or set it in your configuration file:</p> <pre><code>quiet: true\n</code></pre> <p>Recommendation: Begin migration now to avoid last-minute issues. Use the existing opnDossier tools with template mode to test your configurations.</p>"},{"location":"migration/#migration-checklist","title":"Migration Checklist","text":""},{"location":"migration/#pre-migration-assessment","title":"Pre-Migration Assessment","text":"<ul> <li> Inventory current templates - Document all custom templates and modifications</li> <li> Identify template functions - List all custom template functions in use</li> <li> Test current setup - Establish baseline performance and output quality</li> <li> Backup configurations - Save current working configuration files</li> <li> Plan testing strategy - Define acceptance criteria for migrated functionality</li> </ul>"},{"location":"migration/#custom-template-user-quick-start","title":"Custom Template User Quick Start","text":"<p>If you're using custom templates, follow this three-step assessment process:</p>"},{"location":"migration/#step-1-test-your-current-setup","title":"Step 1: Test Your Current Setup","text":"<p>Test your current template-based setup and compare with programmatic mode:</p> <pre><code># Test template mode (with deprecation warning)\nopnDossier convert config.xml --use-template -o template-report.md\n\n# Test programmatic mode\nopnDossier convert config.xml -o programmatic-report.md\n\n# Compare outputs manually or with diff\ndiff template-report.md programmatic-report.md\n</code></pre>"},{"location":"migration/#step-2-map-template-functions","title":"Step 2: Map Template Functions","text":"<p>Review the function mapping table to identify:</p> <ul> <li>Functions already migrated (ready to use)</li> <li>Functions pending migration (plan workaround)</li> <li>Functions without equivalents (requires custom implementation)</li> </ul>"},{"location":"migration/#step-3-choose-migration-path","title":"Step 3: Choose Migration Path","text":"<p>Option A: Continue with Templates (Temporary)</p> <p>Use the <code>--use-template</code> flag to maintain current functionality:</p> <pre><code>opndossier convert config.xml --use-template -o report.md\n</code></pre> <p>\u26a0\ufe0f Note: This is a temporary solution. Templates will be removed in v3.0.</p> <p>Option B: Migrate to Programmatic (Recommended)</p> <ol> <li>Extend <code>MarkdownBuilder</code> with custom methods (see Real-World Examples)</li> <li>Port template logic to Go methods</li> <li>Test with programmatic mode (default)</li> <li>Remove template dependencies</li> </ol>"},{"location":"migration/#migration-phases","title":"Migration Phases","text":""},{"location":"migration/#phase-1-basic-functionality-migration","title":"Phase 1: Basic Functionality Migration","text":"<ul> <li> Replace simple template calls with programmatic methods</li> <li> Migrate core report generation workflows</li> <li> Update basic string formatting operations</li> <li> Test output equivalence</li> </ul>"},{"location":"migration/#phase-2-advanced-feature-migration","title":"Phase 2: Advanced Feature Migration","text":"<ul> <li> Convert custom template functions to Go methods</li> <li> Migrate complex data transformations</li> <li> Update security assessment logic</li> <li> Integrate performance optimizations</li> </ul>"},{"location":"migration/#phase-3-cleanup-and-optimization","title":"Phase 3: Cleanup and Optimization","text":"<ul> <li> Remove template dependencies</li> <li> Optimize for new performance characteristics</li> <li> Update documentation and examples</li> <li> Implement monitoring and validation</li> </ul>"},{"location":"migration/#step-by-step-migration","title":"Step-by-Step Migration","text":""},{"location":"migration/#step-1-update-installation-and-dependencies","title":"Step 1: Update Installation and Dependencies","text":"<p>Before (v1.x):</p> <pre><code># Old template-based installation\ngo install github.com/EvilBit-Labs/opnDossier@v1.x\n</code></pre> <p>After (v2.0+):</p> <pre><code># New programmatic generation\ngo install github.com/EvilBit-Labs/opnDossier@latest\n\n# Or build from source for latest features\ngit clone https://github.com/EvilBit-Labs/opnDossier.git\ncd opnDossier\njust install\njust build\n</code></pre>"},{"location":"migration/#step-2-update-cli-usage-patterns","title":"Step 2: Update CLI Usage Patterns","text":"<p>Before (Template Mode):</p> <pre><code># Template-based generation (default in v1.x)\nopnDossier convert config.xml -o report.md\n\n# Custom templates\nopnDossier convert config.xml --template-dir ./custom-templates/\n</code></pre> <p>After (Programmatic Mode):</p> <pre><code># Programmatic generation (default in v2.0+)\nopnDossier convert config.xml -o report.md\n\n# Legacy template mode (for compatibility)\nopnDossier convert config.xml -o report.md --use-template\n\n# Custom templates (if still needed)\nopnDossier convert config.xml --template-dir ./custom-templates/ --use-template\n</code></pre>"},{"location":"migration/#step-3-migrate-simple-template-functions","title":"Step 3: Migrate Simple Template Functions","text":"<p>Before (Template Calls):</p> <pre><code>// Template function calls\n{{ getRiskLevel .Severity }}\n{{ formatBoolean .IsEnabled }}\n{{ .Value | upper }}\n{{ .Description | truncate 50 }}\n</code></pre> <p>After (Method Calls):</p> <pre><code>// Direct method calls on MarkdownBuilder\nbuilder.AssessRiskLevel(item.Severity)\nbuilder.FormatBoolean(item.IsEnabled)\nstrings.ToUpper(item.Value)\nbuilder.TruncateDescription(item.Description, 50)\n</code></pre>"},{"location":"migration/#step-4-convert-data-processing-logic","title":"Step 4: Convert Data Processing Logic","text":"<p>Before (Template Logic):</p> <pre><code>// Template-based data processing\n{{ range .System.Tunables }}\n  {{ if hasPrefix .Name \"security\" }}\n    - {{ .Name }}: {{ .Value }}\n  {{ end }}\n{{ end }}\n</code></pre> <p>After (Go Logic):</p> <pre><code>// Programmatic data processing\nbuilder := converter.NewMarkdownBuilder()\nsecurityTunables := builder.FilterSystemTunables(config.Sysctl.Item, true)\n\nvar output strings.Builder\nfor _, tunable := range securityTunables {\n    output.WriteString(fmt.Sprintf(\"- %s: %s\\n\", tunable.Tunable, tunable.Value))\n}\n</code></pre>"},{"location":"migration/#step-5-migrate-complex-templates","title":"Step 5: Migrate Complex Templates","text":"<p>Before (Complex Template):</p> <pre><code>// Complex template with conditional logic\n{{- define \"serviceStatus\" -}}\n{{ $running := 0 }}{{ $stopped := 0 }}\n{{ range .Services }}\n  {{ if eq .Status \"running\" }}{{ $running = add $running 1 }}{{ else }}{{ $stopped = add $stopped 1 }}{{ end }}\n{{ end }}\n**Running:** {{ $running }} | **Stopped:** {{ $stopped }}\n{{- end -}}\n</code></pre> <p>After (Go Method):</p> <pre><code>// Equivalent Go method\nfunc (b *MarkdownBuilder) formatServiceStatus(services []model.Service) string {\n    serviceGroups := b.GroupServicesByStatus(services)\n\n    running := len(serviceGroups[\"running\"])\n    stopped := len(serviceGroups[\"stopped\"])\n\n    return fmt.Sprintf(\"**Running:** %d | **Stopped:** %d\", running, stopped)\n}\n</code></pre>"},{"location":"migration/#step-6-update-error-handling","title":"Step 6: Update Error Handling","text":"<p>Before (Silent Template Failures):</p> <pre><code>// Templates fail silently or with generic errors\n{{ .NonExistentField | default \"N/A\" }}\n</code></pre> <p>After (Explicit Error Handling):</p> <pre><code>// Explicit error handling with context\nfunc safeGetField(config *model.OpnSenseDocument) (string, error) {\n    if config == nil {\n        return \"\", fmt.Errorf(\"configuration is nil\")\n    }\n\n    if config.System.Hostname == \"\" {\n        return \"N/A\", nil  // Explicit default handling\n    }\n\n    return config.System.Hostname, nil\n}\n</code></pre>"},{"location":"migration/#code-examples-before-and-after","title":"Code Examples: Before and After","text":""},{"location":"migration/#example-1-basic-report-generation","title":"Example 1: Basic Report Generation","text":"<p>Before (Template-Based):</p> <pre><code>// template file: report.tmpl\n{{/* Basic report template */}}\n# {{ .System.Hostname }} Configuration Report\n\n## System Information\n- **Hostname:** {{ .System.Hostname }}\n- **Domain:** {{ .System.Domain }}\n- **Version:** {{ .System.Version }}\n\n## Security Assessment\n- **Risk Level:** {{ getRiskLevel .SecurityLevel }}\n- **Score:** {{ calculateScore . }}/100\n\n{{ range .Services }}\n- {{ .Name }}: {{ .Status | upper }}\n{{ end }}\n</code></pre> <pre><code>// Go code using templates\nfunc generateReport(config *model.OpnSenseDocument) (string, error) {\n    tmpl, err := template.ParseFiles(\"report.tmpl\")\n    if err != nil {\n        return \"\", err\n    }\n\n    var buf bytes.Buffer\n    if err := tmpl.Execute(&amp;buf, config); err != nil {\n        return \"\", err\n    }\n\n    return buf.String(), nil\n}\n</code></pre> <p>After (Programmatic):</p> <pre><code>// Direct Go implementation\nfunc generateReport(config *model.OpnSenseDocument) (string, error) {\n    builder := converter.NewMarkdownBuilder()\n\n    var report strings.Builder\n\n    // Header with system information\n    report.WriteString(fmt.Sprintf(\"# %s Configuration Report\\n\\n\",\n        builder.EscapeMarkdownSpecialChars(config.System.Hostname)))\n\n    // System information section\n    report.WriteString(\"## System Information\\n\")\n    report.WriteString(fmt.Sprintf(\"- **Hostname:** %s\\n\", config.System.Hostname))\n    report.WriteString(fmt.Sprintf(\"- **Domain:** %s\\n\", config.System.Domain))\n    report.WriteString(fmt.Sprintf(\"- **Version:** %s\\n\", config.System.Version))\n    report.WriteString(\"\\n\")\n\n    // Security assessment\n    score := builder.CalculateSecurityScore(config)\n    riskLevel := builder.AssessRiskLevel(determineRiskFromScore(score))\n\n    report.WriteString(\"## Security Assessment\\n\")\n    report.WriteString(fmt.Sprintf(\"- **Risk Level:** %s\\n\", riskLevel))\n    report.WriteString(fmt.Sprintf(\"- **Score:** %d/100\\n\\n\", score))\n\n    // Services listing\n    serviceGroups := builder.GroupServicesByStatus(config.Installedpackages.Services)\n    for status, services := range serviceGroups {\n        for _, service := range services {\n            report.WriteString(fmt.Sprintf(\"- %s: %s\\n\",\n                service.Name, strings.ToUpper(status)))\n        }\n    }\n\n    return report.String(), nil\n}\n</code></pre>"},{"location":"migration/#example-2-custom-function-migration","title":"Example 2: Custom Function Migration","text":"<p>Before (Custom Template Functions):</p> <pre><code>// Custom template functions\nfunc createTemplateFunctions() template.FuncMap {\n    return template.FuncMap{\n        \"formatUptime\": func(seconds int) string {\n            hours := seconds / 3600\n            return fmt.Sprintf(\"%d hours\", hours)\n        },\n        \"securityIcon\": func(level string) string {\n            switch level {\n            case \"high\": return \"\ud83d\udd34\"\n            case \"medium\": return \"\ud83d\udfe1\"\n            case \"low\": return \"\ud83d\udfe2\"\n            default: return \"\u26aa\"\n            }\n        },\n        \"formatBytes\": func(bytes int64) string {\n            return fmt.Sprintf(\"%.2f MB\", float64(bytes)/1024/1024)\n        },\n    }\n}\n</code></pre> <p>After (MarkdownBuilder Methods):</p> <pre><code>// Methods on MarkdownBuilder type\nfunc (b *MarkdownBuilder) FormatUptime(seconds int) string {\n    hours := seconds / 3600\n    return fmt.Sprintf(\"%d hours\", hours)\n}\n\nfunc (b *MarkdownBuilder) SecurityIcon(level string) string {\n    switch level {\n    case \"high\": return \"\ud83d\udd34\"\n    case \"medium\": return \"\ud83d\udfe1\"\n    case \"low\": return \"\ud83d\udfe2\"\n    default: return \"\u26aa\"\n    }\n}\n\nfunc (b *MarkdownBuilder) FormatBytes(bytes int64) string {\n    return fmt.Sprintf(\"%.2f MB\", float64(bytes)/1024/1024)\n}\n</code></pre>"},{"location":"migration/#example-3-custom-risk-assessment-section","title":"Example 3: Custom Risk Assessment Section","text":"<p>Before (Template):</p> <pre><code>{{- define \"riskAssessment\" -}}\n## Risk Assessment\n\n{{ range .Services }}\n- **{{ .Name }}**: {{ getRiskLevel .Severity }}\n  - Status: {{ .Status | upper }}\n  - Risk Score: {{ calculateSecurityScore . }}\n{{ end }}\n{{- end -}}\n</code></pre> <p>After (Go Method):</p> <pre><code>// Custom SecurityBuilder extending MarkdownBuilder\ntype SecurityBuilder struct {\n    *MarkdownBuilder\n}\n\nfunc NewSecurityBuilder() *SecurityBuilder {\n    return &amp;SecurityBuilder{\n        MarkdownBuilder: converter.NewMarkdownBuilder(),\n    }\n}\n\nfunc (sb *SecurityBuilder) BuildRiskAssessmentSection(data *model.OpnSenseDocument) string {\n    var section strings.Builder\n\n    section.WriteString(\"## Risk Assessment\\n\\n\")\n\n    for _, service := range data.Installedpackages.Services {\n        // Use inherited methods from MarkdownBuilder\n        // AssessServiceRisk already returns a fully formatted risk label (emoji + text)\n        riskLevel := sb.AssessServiceRisk(service)\n        status := sb.ToUpper(service.Status)\n        score := sb.CalculateSecurityScore(data)\n\n        section.WriteString(fmt.Sprintf(\"- **%s**: %s\\n\", service.Name, riskLevel))\n        section.WriteString(fmt.Sprintf(\"  - Status: %s\\n\", status))\n        section.WriteString(fmt.Sprintf(\"  - Risk Score: %d\\n\\n\", score))\n    }\n\n    return section.String()\n}\n</code></pre> <p>Usage:</p> <pre><code>builder := NewSecurityBuilder()\nriskSection := builder.BuildRiskAssessmentSection(config)\n</code></pre>"},{"location":"migration/#example-4-custom-compliance-report","title":"Example 4: Custom Compliance Report","text":"<p>Before (Template):</p> <pre><code>{{- define \"complianceCheck\" -}}\n## Compliance Report\n\n{{ $rules := .Filter.Rule }}\n{{ range $rules }}\n  {{ if eq .Type \"pass\" }}\n    - [PASS] Rule #{{ .Number }}: {{ .Descr }}\n  {{ else }}\n    - [FAIL] Rule #{{ .Number }}: {{ .Descr }} (Non-compliant)\n  {{ end }}\n{{ end }}\n{{- end -}}\n</code></pre> <p>After (Go Method):</p> <pre><code>func (b *MarkdownBuilder) BuildComplianceReport(data *model.OpnSenseDocument) string {\n    var report strings.Builder\n\n    report.WriteString(\"## Compliance Report\\n\\n\")\n\n    // Filter rules by type using MarkdownBuilder method\n    passRules := b.FilterRulesByType(data.Filter.Rule, \"pass\")\n    blockRules := b.FilterRulesByType(data.Filter.Rule, \"block\")\n\n    report.WriteString(\"### Compliant Rules (Pass)\\n\\n\")\n    for i, rule := range passRules {\n        report.WriteString(fmt.Sprintf(\"- [PASS] Rule #%d: %s\\n\",\n            i+1, b.EscapeTableContent(rule.Descr)))\n    }\n\n    report.WriteString(\"\\n### Non-Compliant Rules (Block)\\n\\n\")\n    for i, rule := range blockRules {\n        report.WriteString(fmt.Sprintf(\"- [FAIL] Rule #%d: %s\\n\",\n            i+1, b.EscapeTableContent(rule.Descr)))\n    }\n\n    return report.String()\n}\n</code></pre> <p>Reference: Uses <code>FilterRulesByType</code> from <code>internal/converter/markdown_transformers.go</code> line 164.</p>"},{"location":"migration/#example-5-custom-network-analysis","title":"Example 5: Custom Network Analysis","text":"<p>Before (Template):</p> <pre><code>{{- define \"networkAnalysis\" -}}\n## Network Interface Analysis\n\n{{ $interfaces := .Interfaces.Items }}\n{{ range $name, $iface := $interfaces }}\n  {{ if eq $iface.Enable \"1\" }}\n    ### {{ $name | upper }} Interface\n    - IP: {{ $iface.IPAddr }}\n    - Subnet: {{ $iface.Subnet }}\n    - Gateway: {{ $iface.Gateway | default \"N/A\" }}\n  {{ end }}\n{{ end }}\n{{- end -}}\n</code></pre> <p>After (Go Method):</p> <pre><code>func (b *MarkdownBuilder) BuildNetworkAnalysis(data *model.OpnSenseDocument) string {\n    var analysis strings.Builder\n\n    analysis.WriteString(\"## Network Interface Analysis\\n\\n\")\n\n    netConfig := data.NetworkConfig()\n\n    for name, iface := range netConfig.Interfaces.Items {\n        // Filter enabled interfaces only\n        if iface.Enable != \"1\" {\n            continue\n        }\n\n        analysis.WriteString(fmt.Sprintf(\"### %s Interface\\n\\n\", b.ToUpper(name)))\n        analysis.WriteString(fmt.Sprintf(\"- IP: %s\\n\", iface.IPAddr))\n        analysis.WriteString(fmt.Sprintf(\"- Subnet: %s\\n\", iface.Subnet))\n\n        // Use DefaultValue for optional fields\n        gateway := b.DefaultValue(iface.Gateway, \"N/A\")\n        analysis.WriteString(fmt.Sprintf(\"- Gateway: %s\\n\\n\", gateway))\n    }\n\n    return analysis.String()\n}\n</code></pre> <p>Reference: Uses <code>ToUpper</code> from <code>internal/converter/markdown_utils.go</code> line 130 and <code>DefaultValue</code> from line 93.</p>"},{"location":"migration/#performance-validation","title":"Performance Validation","text":""},{"location":"migration/#benchmarking-migration-results","title":"Benchmarking Migration Results","text":"<pre><code>// Benchmark comparison function\nfunc BenchmarkMigrationComparison(b *testing.B) {\n    config := loadTestConfig() // Load test configuration\n\n    // Benchmark old template approach\n    b.Run(\"Template\", func(b *testing.B) {\n        for i := 0; i &lt; b.N; i++ {\n            _, err := generateReportTemplate(config)\n            if err != nil {\n                b.Fatal(err)\n            }\n        }\n    })\n\n    // Benchmark new programmatic approach\n    b.Run(\"Programmatic\", func(b *testing.B) {\n        builder := converter.NewMarkdownBuilder()\n        for i := 0; i &lt; b.N; i++ {\n            _, err := builder.BuildStandardReport(config)\n            if err != nil {\n                b.Fatal(err)\n            }\n        }\n    })\n}\n</code></pre> <p>Expected Results:</p> <pre><code>BenchmarkMigrationComparison/Template-8        200    5520000 ns/op    8800000 B/op    93984 allocs/op\nBenchmarkMigrationComparison/Programmatic-8    800    1520000 ns/op    1970000 B/op    39585 allocs/op\n</code></pre>"},{"location":"migration/#validation-checklist","title":"Validation Checklist","text":"<ul> <li> Output Equivalence: Generated reports match template output (content-wise)</li> <li> Performance Improvement: Confirm 50%+ speed improvement</li> <li> Memory Efficiency: Verify significant reduction in allocations</li> <li> Error Handling: Ensure better error reporting and handling</li> <li> Type Safety: Confirm compile-time validation of all operations</li> </ul>"},{"location":"migration/#common-migration-challenges","title":"Common Migration Challenges","text":""},{"location":"migration/#challenge-1-complex-template-logic","title":"Challenge 1: Complex Template Logic","text":"<p>Problem: Nested template conditionals and loops are hard to translate directly.</p> <p>Solution: Break down complex templates into smaller, focused Go functions.</p> <pre><code>// Instead of complex template logic, use focused functions\nfunc (b *MarkdownBuilder) generateServiceSection(services []model.Service) string {\n    if len(services) == 0 {\n        return \"*No services configured.*\\n\"\n    }\n\n    serviceGroups := b.GroupServicesByStatus(services)\n\n    var section strings.Builder\n    section.WriteString(\"## Services\\n\\n\")\n\n    // Handle each group separately\n    b.addServiceGroup(&amp;section, \"Running\", serviceGroups[\"running\"])\n    b.addServiceGroup(&amp;section, \"Stopped\", serviceGroups[\"stopped\"])\n\n    return section.String()\n}\n\nfunc (b *MarkdownBuilder) addServiceGroup(w *strings.Builder, title string, services []model.Service) {\n    if len(services) == 0 {\n        return\n    }\n\n    w.WriteString(fmt.Sprintf(\"### %s Services (%d)\\n\\n\", title, len(services)))\n    for _, service := range services {\n        w.WriteString(fmt.Sprintf(\"- **%s**\", service.Name))\n        if service.Description != \"\" {\n            w.WriteString(fmt.Sprintf(\": %s\", b.TruncateDescription(service.Description, 100)))\n        }\n        w.WriteString(\"\\n\")\n    }\n    w.WriteString(\"\\n\")\n}\n</code></pre>"},{"location":"migration/#challenge-2-sprig-function-dependencies","title":"Challenge 2: Sprig Function Dependencies","text":"<p>Problem: Templates rely heavily on Sprig functions for string manipulation.</p> <p>Solution: Implement essential functions as MarkdownBuilder methods or use standard Go functions.</p> <pre><code>// Replace Sprig functions with Go standard library or custom methods\nfunc migrateSprigFunctions() {\n    // Old: {{ .Value | upper }}\n    // New: strings.ToUpper(value)\n\n    // Old: {{ .List | join \", \" }}\n    // New: strings.Join(list, \", \")\n\n    // Old: {{ .Text | default \"N/A\" }}\n    // New: Use DefaultValue method (works with any type)\n    builder.DefaultValue(text, \"N/A\")\n}\n\n// Note: DefaultValue already exists in MarkdownBuilder\n// For string-specific handling, you can use:\nfunc (b *MarkdownBuilder) DefaultString(value, defaultValue string) string {\n    result := b.DefaultValue(value, defaultValue)\n    if str, ok := result.(string); ok {\n        return str\n    }\n    return defaultValue\n}\n</code></pre>"},{"location":"migration/#challenge-3-template-inheritance","title":"Challenge 3: Template Inheritance","text":"<p>Problem: Template inheritance and includes are harder to replicate.</p> <p>Solution: Use Go composition and method delegation.</p> <pre><code>// Replace template inheritance with Go composition\ntype ReportBuilder struct {\n    *MarkdownBuilder\n    headerBuilder  *HeaderBuilder\n    sectionBuilder *SectionBuilder\n}\n\nfunc (r *ReportBuilder) BuildFullReport(config *model.OpnSenseDocument) (string, error) {\n    var report strings.Builder\n\n    // Compose report from different builders\n    header := r.headerBuilder.BuildHeader(config)\n    system := r.sectionBuilder.BuildSystemSection(config)\n    network := r.sectionBuilder.BuildNetworkSection(config)\n\n    report.WriteString(header)\n    report.WriteString(system)\n    report.WriteString(network)\n\n    return report.String(), nil\n}\n</code></pre>"},{"location":"migration/#testing-migration","title":"Testing Migration","text":""},{"location":"migration/#unit-test-migration","title":"Unit Test Migration","text":"<pre><code>// Test template vs programmatic output equivalence\nfunc TestMigrationEquivalence(t *testing.T) {\n    config := loadTestConfig()\n\n    // Generate with both approaches\n    templateOutput, err := generateReportTemplate(config)\n    require.NoError(t, err)\n\n    builder := converter.NewMarkdownBuilder()\n    programmaticOutput, err := builder.BuildStandardReport(config)\n    require.NoError(t, err)\n\n    // Compare content (allowing for formatting differences)\n    assert.Equal(t, normalizeContent(templateOutput), normalizeContent(programmaticOutput))\n}\n\nfunc normalizeContent(content string) string {\n    // Normalize whitespace and formatting for comparison\n    lines := strings.Split(content, \"\\n\")\n    var normalized []string\n\n    for _, line := range lines {\n        trimmed := strings.TrimSpace(line)\n        if trimmed != \"\" {\n            normalized = append(normalized, trimmed)\n        }\n    }\n\n    return strings.Join(normalized, \"\\n\")\n}\n</code></pre>"},{"location":"migration/#integration-test-migration","title":"Integration Test Migration","text":"<pre><code>func TestEndToEndMigration(t *testing.T) {\n    testCases := []struct {\n        name       string\n        configFile string\n        expected   string\n    }{\n        {\"small-config\", \"testdata/small-config.xml\", \"testdata/small-expected.md\"},\n        {\"medium-config\", \"testdata/medium-config.xml\", \"testdata/medium-expected.md\"},\n        {\"large-config\", \"testdata/large-config.xml\", \"testdata/large-expected.md\"},\n    }\n\n    for _, tc := range testCases {\n        t.Run(tc.name, func(t *testing.T) {\n            // Parse configuration\n            parser := parser.NewXMLParser()\n            config, err := parser.ParseFile(tc.configFile)\n            require.NoError(t, err)\n\n            // Generate report\n            builder := converter.NewMarkdownBuilder()\n            report, err := builder.BuildStandardReport(config)\n            require.NoError(t, err)\n\n            // Validate output\n            expected, err := os.ReadFile(tc.expected)\n            require.NoError(t, err)\n\n            assert.Equal(t, normalizeContent(string(expected)), normalizeContent(report))\n        })\n    }\n}\n</code></pre>"},{"location":"migration/#rollback-strategy","title":"Rollback Strategy","text":""},{"location":"migration/#maintaining-template-compatibility","title":"Maintaining Template Compatibility","text":"<pre><code>// Support both approaches during transition\ntype HybridBuilder struct {\n    useTemplate bool\n    templateGen Generator\n    progGen     *MarkdownBuilder\n}\n\nfunc NewHybridBuilder(useTemplate bool) *HybridBuilder {\n    return &amp;HybridBuilder{\n        useTemplate: useTemplate,\n        templateGen: markdown.NewMarkdownGenerator(nil),\n        progGen:     converter.NewMarkdownBuilder(),\n    }\n}\n\nfunc (h *HybridBuilder) GenerateReport(config *model.OpnSenseDocument) (string, error) {\n    if h.useTemplate {\n        // Fallback to template mode\n        return h.templateGen.Generate(context.Background(), config, markdown.Options{})\n    }\n\n    // Use new programmatic mode\n    return h.progGen.BuildStandardReport(config)\n}\n</code></pre>"},{"location":"migration/#feature-flags","title":"Feature Flags","text":"<pre><code># Environment variables for gradual rollout\nexport OPNDOSSIER_USE_PROGRAMMATIC=true   # Enable programmatic mode\nexport OPNDOSSIER_FALLBACK_TEMPLATE=true  # Fallback to templates on error\nexport OPNDOSSIER_VALIDATE_OUTPUT=true    # Compare template vs programmatic output\n</code></pre>"},{"location":"migration/#post-migration-optimization","title":"Post-Migration Optimization","text":""},{"location":"migration/#performance-tuning","title":"Performance Tuning","text":"<pre><code>// Optimize for new performance characteristics\nfunc optimizeForProgrammaticGeneration() {\n    // 1. Create builder (reuse for multiple reports when possible)\n    builder := converter.NewMarkdownBuilder()\n\n    // 2. Process multiple configs (builder is stateless, safe to reuse)\n    for _, config := range configs {\n        report, _ := builder.BuildStandardReport(config)\n        // Builder is stateless - no Reset() needed, just reuse\n        _ = report\n    }\n\n    // 3. Use concurrent processing for multiple configs\n    // Each goroutine should create its own builder for thread safety\n    processConfigsConcurrently(configs)\n}\n</code></pre>"},{"location":"migration/#monitoring-and-validation","title":"Monitoring and Validation","text":"<pre><code>// Add metrics to track migration success\nfunc trackMigrationMetrics(templateTime, progTime time.Duration, templateErr, progErr error) {\n    metrics := map[string]interface{}{\n        \"template_duration_ms\":     templateTime.Milliseconds(),\n        \"programmatic_duration_ms\": progTime.Milliseconds(),\n        \"performance_improvement\":  float64(templateTime-progTime) / float64(templateTime) * 100,\n        \"template_error\":          templateErr != nil,\n        \"programmatic_error\":      progErr != nil,\n    }\n\n    // Log or send to monitoring system\n    log.Printf(\"Migration metrics: %+v\", metrics)\n}\n</code></pre>"},{"location":"migration/#success-criteria","title":"Success Criteria","text":""},{"location":"migration/#performance-metrics","title":"Performance Metrics","text":"<ul> <li> Generation Speed: Achieve 50%+ improvement over template mode</li> <li> Memory Usage: Reduce allocations by 50%+</li> <li> Throughput: Handle 2x+ more reports per second</li> <li> Scalability: Maintain performance with large configurations</li> </ul>"},{"location":"migration/#quality-metrics","title":"Quality Metrics","text":"<ul> <li> Output Equivalence: Reports match template output functionality</li> <li> Error Handling: Improved error reporting and debugging</li> <li> Type Safety: Zero runtime template errors</li> <li> Maintainability: Easier to extend and modify</li> </ul>"},{"location":"migration/#operational-metrics","title":"Operational Metrics","text":"<ul> <li> Reliability: Reduced failure rates</li> <li> Debugging: Faster issue identification and resolution</li> <li> Development: Faster feature development and testing</li> <li> Documentation: Clear migration path and examples</li> </ul>"},{"location":"migration/#faq","title":"FAQ","text":""},{"location":"migration/#how-long-will-template-support-be-available","title":"How long will template support be available?","text":"<p>Template support will be available until v3.0 (estimated Q3 2025). The <code>--use-template</code> flag will work in v2.0-v2.5, but templates will be completely removed in v3.0.</p>"},{"location":"migration/#can-i-use-both-template-and-programmatic-modes","title":"Can I use both template and programmatic modes?","text":"<p>Yes! The HybridGenerator supports both modes. Use <code>--use-template</code> for template mode, or omit the flag for programmatic mode (default). See <code>internal/markdown/hybrid_generator.go</code> for implementation details.</p>"},{"location":"migration/#what-performance-improvements-can-i-expect","title":"What performance improvements can I expect?","text":"<p>The programmatic approach is designed to deliver significant performance improvements over template-based generation. Actual results depend on your configuration size and system characteristics.</p> <p>To measure performance for your use case:</p> <pre><code># Run comparative benchmarks\ngo test -bench=BenchmarkReportGeneration ./internal/converter -benchmem\ngo test -bench=BenchmarkMemoryUsage ./internal/converter -benchmem\ngo test -bench=BenchmarkThroughput ./internal/converter -benchmem\n</code></pre>"},{"location":"migration/#how-do-i-rollback-if-migration-causes-issues","title":"How do I rollback if migration causes issues?","text":"<p>Use the <code>--use-template</code> flag to temporarily revert to template mode:</p> <pre><code>opndossier convert config.xml --use-template -o report.md\n</code></pre> <p>This allows you to continue using templates while fixing programmatic implementation issues.</p>"},{"location":"migration/#what-if-a-template-function-doesnt-have-a-go-equivalent","title":"What if a template function doesn't have a Go equivalent?","text":"<ol> <li>Check the function mapping table for status</li> <li>If pending, implement as a custom MarkdownBuilder method (see Contributing)</li> <li>Consider contributing your implementation back to the project</li> </ol>"},{"location":"migration/#troubleshooting-common-issues","title":"Troubleshooting Common Issues","text":"<p>Issue: Template functions not found in programmatic mode</p> <p>Solution: Check the function mapping table. If the function is marked \"Pending\", you'll need to implement it or use a workaround.</p> <p>Issue: Output differs between template and programmatic modes</p> <p>Solution: Compare outputs manually and adjust your programmatic implementation to match the expected template output.</p> <p>Issue: Performance is worse after migration</p> <p>Solution: Ensure you're using the latest version of opnDossier. If issues persist, file a bug report with performance benchmarks.</p>"},{"location":"migration/#contributing-custom-functions","title":"Contributing Custom Functions","text":"<p>If you've implemented custom MarkdownBuilder methods that would benefit the community, consider contributing them back to the project.</p>"},{"location":"migration/#contribution-process","title":"Contribution Process","text":"<ol> <li>Implement as MarkdownBuilder Method</li> </ol> <p>Add your method to <code>internal/converter/markdown_custom.go</code> (or appropriate file):</p> <pre><code>// Package converter provides functionality to convert OPNsense configurations to markdown.\npackage converter\n\n// YourCustomMethod provides [description of functionality].\nfunc (b *MarkdownBuilder) YourCustomMethod(params) returnType {\n    // Implementation\n}\n</code></pre> <ol> <li>Add Comprehensive Tests</li> </ol> <p>Create tests in <code>internal/converter/markdown_custom_test.go</code>:</p> <pre><code>func TestMarkdownBuilder_YourCustomMethod(t *testing.T) {\n    builder := NewMarkdownBuilder()\n\n    tests := []struct {\n        name     string\n        input    inputType\n        expected returnType\n    }{\n        // Test cases\n    }\n\n    for _, tt := range tests {\n        t.Run(tt.name, func(t *testing.T) {\n            result := builder.YourCustomMethod(tt.input)\n            assert.Equal(t, tt.expected, result)\n        })\n    }\n}\n</code></pre> <p>Reference existing test patterns from <code>internal/converter/markdown_utils_test.go</code>.</p> <ol> <li>Document in Migration Guide</li> </ol> <p>Update <code>docs/template-function-migration.md</code> with your function mapping:</p> <ul> <li>Add to appropriate phase table</li> <li>Mark status as Migrated</li> <li> <p>Include implementation file reference</p> </li> <li> <p>Submit Pull Request</p> </li> </ul> <p>PR requirements:</p> <ul> <li>Clear use case description</li> <li>Before/after examples (template \u2192 Go method)</li> <li>Test coverage report (&gt;80% for new code)</li> <li>Documentation updates</li> <li>Link to related issues (if any)</li> </ul>"},{"location":"migration/#code-structure-guidelines","title":"Code Structure Guidelines","text":"<ul> <li> <p>File Organization: Add methods to appropriate files:</p> </li> <li> <p><code>markdown_utils.go</code> - Core utility functions</p> </li> <li><code>markdown_security.go</code> - Security and compliance functions</li> <li><code>markdown_transformers.go</code> - Data transformation functions</li> <li> <p><code>markdown_custom.go</code> - Custom/advanced functions</p> </li> <li> <p>Naming Conventions: Follow Go naming conventions:</p> </li> <li> <p>Exported methods: <code>PascalCase</code></p> </li> <li>Private helpers: <code>camelCase</code></li> <li> <p>Descriptive names that indicate purpose</p> </li> <li> <p>Error Handling: Always handle errors explicitly:</p> </li> </ul> <pre><code> if err != nil {\n     return \"\", fmt.Errorf(\"context: %w\", err)\n }\n</code></pre> <ul> <li>Documentation: Include godoc comments:</li> </ul> <pre><code>// YourCustomMethod does [what] for [purpose].\n// It returns [what] and handles [edge cases].\nfunc (b *MarkdownBuilder) YourCustomMethod(...) ... {\n</code></pre>"},{"location":"migration/#next-steps","title":"Next Steps","text":"<ol> <li>Complete Migration: Follow this guide step-by-step</li> <li>Validate Results: Run comprehensive tests and benchmarks</li> <li>Monitor Performance: Track metrics and optimize as needed</li> <li>Update Documentation: Reflect new programmatic approach</li> <li>Train Team: Ensure team understands new development patterns</li> </ol> <p>For additional support and examples:</p> <ul> <li>API Documentation - Complete method reference</li> <li>Examples - Real-world usage patterns</li> <li>Architecture - System design overview</li> <li>Function Migration Guide - Complete function mapping</li> </ul>"},{"location":"pipeline-v2-compliance/","title":"Pipeline v2 Compliance Guide","text":"<p>This document details how opnDossier implements the EvilBit Labs Pipeline v2 Specification for comprehensive OSS project quality gates and tooling.</p>"},{"location":"pipeline-v2-compliance/#overview","title":"Overview","text":"<p>Pipeline v2 defines mandatory tooling and quality gates for all EvilBit Labs public OSS projects, focusing on:</p> <ul> <li>Consistency - Same core tools and gates across all projects</li> <li>Local/CI parity - All CI steps runnable locally via <code>just</code></li> <li>Fail fast - Blocking gates for linting, testing, security, and licensing</li> <li>Trustworthiness - Signed releases with SBOM and provenance</li> <li>Airgap-ready - Offline-capable artifacts with verification metadata</li> </ul>"},{"location":"pipeline-v2-compliance/#implementation-status","title":"Implementation Status","text":""},{"location":"pipeline-v2-compliance/#go-language-tooling-section-31","title":"Go Language Tooling (Section 3.1)","text":"Requirement Implementation Status Build/Release GoReleaser with homebrew, nfpm, archives, Docker Complete Lint <code>golangci-lint</code> with comprehensive configuration Complete Test/Coverage <code>go test ./... -cover -race</code> with 85% minimum coverage Complete Race Detection Mandatory <code>-race</code> flag in all test commands Complete Airgap Builds GOMODCACHE + vendor directory for offline builds Complete <p>Files:</p> <ul> <li><code>.goreleaser.yaml</code> - Complete GoReleaser configuration</li> <li><code>.golangci.yml</code> - Comprehensive linting rules</li> <li><code>justfile</code> - Local testing commands</li> </ul> <p>Go Tooling Details:</p> <ul> <li>Test Coverage: Minimum 85% coverage threshold enforced via <code>go test -coverprofile=coverage.out</code> and coverage analysis</li> <li>Race Detection: All test commands include <code>-race</code> flag for concurrent code safety</li> <li>Airgap Support: Module caching via <code>GOMODCACHE</code> and vendor directory for reproducible offline builds</li> </ul> <p>Airgap Build Strategy:</p> <ul> <li>Module Caching: Use <code>GOMODCACHE</code> environment variable to specify module cache location</li> <li>Vendor Directory: Maintain <code>vendor/</code> directory with <code>go mod vendor</code> for offline builds</li> <li>Reproducible Builds: All builds use locked dependency versions via <code>go.sum</code></li> <li>Offline Verification: Build process validates all dependencies are available locally</li> </ul>"},{"location":"pipeline-v2-compliance/#cross-cutting-tools-section-4","title":"Cross-Cutting Tools (Section 4)","text":"Tool Implementation Status Commit Discipline Conventional Commits via pre-commit + CodeRabbit Complete Security Analysis GitHub CodeQL Complete SBOM Generation Syft (SPDX JSON) via GoReleaser Complete Vulnerability Scanning Grype via GitHub Actions Complete License Scanning FOSSA integration (GitHub App) Complete Signing &amp; Attestation Cosign + SLSA Level 3 Complete Coverage Reporting Codecov integration Complete AI-Assisted Review CodeRabbit.ai Complete <p>Files:</p> <ul> <li><code>.github/workflows/ci-check.yml</code> - Grype vulnerability scanning</li> <li><code>.github/workflows/codeql.yml</code> - GitHub CodeQL</li> <li>FOSSA license scanning (GitHub App integration)</li> <li><code>.github/workflows/release.yml</code> - SLSA + Cosign signing</li> <li><code>.coderabbit.yaml</code> - CodeRabbit configuration</li> </ul>"},{"location":"pipeline-v2-compliance/#enhanced-saas-tools","title":"\u2705 Enhanced SaaS Tools","text":"Tool Implementation Status OSSF Scorecard Weekly repository hygiene scoring \u2705 Complete Snyk Additional dependency + code vulnerability scanning (GitHub App + CLI) \u2705 Complete Dependabot Automated dependency updates \u2705 Complete <p>Files:</p> <ul> <li><code>.github/workflows/scorecard.yml</code> - OSSF Scorecard</li> <li>Snyk scanning (GitHub App integration + local CLI)</li> <li><code>.github/dependabot.yml</code> - Dependabot configuration</li> </ul>"},{"location":"pipeline-v2-compliance/#local-cli-tools","title":"Local CLI Tools","text":"<p>Both Snyk and FOSSA provide local CLI tools for development:</p> <ul> <li>Snyk CLI: <code>just snyk-scan</code> - Local vulnerability scanning with <code>snyk test</code> and <code>snyk monitor</code></li> <li>FOSSA CLI: <code>just fossa-scan</code> - Local license analysis with <code>fossa analyze</code> and <code>fossa test</code></li> </ul> <p>These CLI tools complement the GitHub App integrations and provide local/CI parity for security scanning.</p>"},{"location":"pipeline-v2-compliance/#local-development-workflow","title":"Local Development Workflow","text":"<p>Pipeline v2 requires local/CI parity. All CI steps can be run locally:</p> <pre><code># Core development workflow\njust test              # Run tests locally\njust lint              # Run linters locally\njust check             # Run pre-commit checks\njust ci-check          # Full CI validation locally\n\n# Security scanning\njust scan-vulnerabilities  # Grype vulnerability scan\njust generate-sbom          # Generate SBOM with Syft\njust snyk-scan             # Snyk vulnerability scan (CLI)\njust fossa-scan            # FOSSA license analysis (CLI)\njust security-scan         # Comprehensive security scan\n\n# Release workflow\njust build-for-release     # Test release build\njust check-goreleaser      # Validate GoReleaser config\n</code></pre>"},{"location":"pipeline-v2-compliance/#quality-gates","title":"Quality Gates","text":""},{"location":"pipeline-v2-compliance/#pr-merge-criteria-section-51","title":"PR Merge Criteria (Section 5.1)","text":"<p>Every PR must:</p> <ol> <li>\u2705 Pass all linters (<code>golangci-lint</code>)</li> <li>\u2705 Pass format checks (<code>gofumpt</code>, <code>goimports</code>)</li> <li>\u2705 Pass all tests with race detection (<code>-race</code> flag) and minimum 85% coverage</li> <li>\u2705 Upload coverage to Codecov</li> <li>\u2705 Pass security gates (CodeQL, Grype)</li> <li>\u2705 Pass license compliance (FOSSA GitHub App)</li> <li>\u2705 Use valid Conventional Commits</li> <li>\u2705 Acknowledge CodeRabbit.ai findings</li> </ol>"},{"location":"pipeline-v2-compliance/#release-criteria-section-52","title":"Release Criteria (Section 5.2)","text":"<p>Every release must:</p> <ol> <li>\u2705 Be created via automated GoReleaser flow</li> <li>\u2705 Include signed artifacts with checksums</li> <li>\u2705 Include SBOM (Syft-generated SPDX)</li> <li>\u2705 Include vulnerability scan reports</li> <li>\u2705 Include SLSA Level 3 provenance attestation</li> <li>\u2705 Include Cosign signatures</li> <li>\u2705 Pass all PR criteria above</li> </ol>"},{"location":"pipeline-v2-compliance/#security-features","title":"Security Features","text":""},{"location":"pipeline-v2-compliance/#supply-chain-security","title":"Supply Chain Security","text":"<ul> <li>SLSA Level 3 Provenance: Every release includes cryptographic proof of build integrity</li> <li>Cosign Signatures: All artifacts signed using keyless OIDC signing</li> <li>SBOM Generation: Complete software bill of materials in SPDX format</li> <li>Vulnerability Scanning: Comprehensive scanning with Grype and Snyk (GitHub App)</li> </ul>"},{"location":"pipeline-v2-compliance/#verification","title":"Verification","text":"<p>Users can verify releases:</p> <pre><code># Verify checksums\nsha256sum -c opnDossier_checksums.txt\n\n# Verify SLSA provenance (requires slsa-verifier)\nslsa-verifier verify-artifact \\\n  --provenance-path opnDossier-v1.0.0.intoto.jsonl \\\n  --source-uri github.com/EvilBit-Labs/opnDossier \\\n  opnDossier_checksums.txt\n\n# Verify Cosign signatures (requires cosign)\ncosign verify-blob \\\n  --bundle cosign.bundle \\\n  opnDossier_checksums.txt\n</code></pre>"},{"location":"pipeline-v2-compliance/#continuous-monitoring","title":"Continuous Monitoring","text":""},{"location":"pipeline-v2-compliance/#scheduled-scans","title":"Scheduled Scans","text":"<ul> <li>OSSF Scorecard: Weekly repository hygiene assessment</li> <li>Snyk Vulnerability Scan: Weekly dependency vulnerability scanning (GitHub App)</li> <li>CodeQL Analysis: Weekly code security analysis</li> <li>Dependabot Updates: Weekly dependency updates</li> </ul>"},{"location":"pipeline-v2-compliance/#real-time-monitoring","title":"Real-time Monitoring","text":"<ul> <li>Pull Request Gates: All security and quality checks on every PR</li> <li>Commit Validation: Conventional commits enforced</li> <li>License Policy: FOSSA license policy enforcement (GitHub App)</li> <li>Code Review: CodeRabbit.ai advisory feedback</li> </ul>"},{"location":"pipeline-v2-compliance/#exceptions","title":"Exceptions","text":"<p>Per Pipeline v2 specification, any deviations must be documented in the README under Exceptions.</p> <p>Current Status: No exceptions required - full compliance achieved.</p>"},{"location":"pipeline-v2-compliance/#secret-management","title":"Secret Management","text":"<p>Required secrets for full functionality:</p> Secret Purpose Required For <code>CODECOV_TOKEN</code> Coverage reporting CI <code>FOSSA_API_KEY</code> License scanning (GitHub App) CI + Local <code>SNYK_TOKEN</code> Vulnerability scanning (GitHub App) N/A <code>SCORECARD_TOKEN</code> OSSF Scorecard (optional) CI"},{"location":"pipeline-v2-compliance/#compliance-verification","title":"Compliance Verification","text":"<p>To verify Pipeline v2 compliance:</p> <pre><code># Run full compliance check\njust full-checks\n\n# Check individual components\njust ci-check          # Core quality gates\njust security-scan     # Security compliance\njust check-goreleaser  # Release compliance\n</code></pre>"},{"location":"pipeline-v2-compliance/#resources","title":"Resources","text":"<ul> <li>EvilBit Labs Pipeline v2 Specification</li> <li>SLSA Framework</li> <li>OpenSSF Scorecard</li> <li>Sigstore Cosign</li> <li>SPDX SBOM Standard</li> </ul>"},{"location":"template-function-migration/","title":"Template Function Migration Guide","text":""},{"location":"template-function-migration/#overview","title":"Overview","text":"<p>This document provides a comprehensive mapping of existing template functions to their planned Go method replacements as part of the transition from template-based to programmatic markdown generation.</p>"},{"location":"template-function-migration/#migration-strategy","title":"Migration Strategy","text":"<p>The migration follows a phased approach to minimize disruption:</p> <ol> <li>Phase 1: Core utility functions (formatting, escaping)</li> <li>Phase 2: Data transformation functions</li> <li>Phase 3: Complex aggregation and analysis functions</li> <li>Phase 4: Sprig function replacements</li> </ol>"},{"location":"template-function-migration/#target-architecture","title":"Target Architecture","text":"<p>All template functions will be replaced with methods on a <code>MarkdownBuilder</code> type:</p> <pre><code>type MarkdownBuilder struct {\n    config *model.OpnSenseDocument\n    opts   Options\n    logger *log.Logger\n}\n</code></pre>"},{"location":"template-function-migration/#function-mappings","title":"Function Mappings","text":""},{"location":"template-function-migration/#phase-1-core-utility-functions","title":"Phase 1: Core Utility Functions","text":"Template Function Go Method Status Notes <code>escapeTableContent</code> <code>EscapeTableContent(content any) string</code> Migrated Implemented in <code>markdown_utils.go</code> line 13 <code>isLast</code> <code>IsLastInSlice(index int, slice any) bool</code> Migrated Implemented in <code>markdown_utils.go</code> line 79 <code>formatBoolean</code> <code>FormatBoolean(value any) string</code> Migrated Already exists in formatters.go <code>formatBooleanWithUnset</code> <code>FormatBooleanWithUnset(value any) string</code> Migrated Already exists in formatters.go <code>formatUnixTimestamp</code> <code>FormatUnixTimestamp(timestamp string) string</code> Migrated Already exists in formatters.go <code>isTruthy</code> <code>IsTruthy(value any) bool</code> Migrated Already exists in formatters.go <code>truncateDescription</code> <code>TruncateDescription(description string, maxLength int) string</code> Migrated Implemented in <code>markdown_utils.go</code> line 57"},{"location":"template-function-migration/#phase-2-data-transformation-functions","title":"Phase 2: Data Transformation Functions","text":"Template Function Go Method Status Notes <code>formatInterfacesAsLinks</code> <code>FormatInterfaceLinks(interfaces model.InterfaceList) string</code> Pending Generates markdown anchor links <code>filterTunables</code> <code>FilterSystemTunables(tunables []model.SysctlItem, include bool) []model.SysctlItem</code> Migrated Implemented in <code>markdown_transformers.go</code> line 26, includes security prefix filtering <code>getPowerModeDescription</code> <code>GetPowerModeDescription(mode string) string</code> Migrated Already exists in formatters.go <code>getPortDescription</code> <code>GetPortDescription(port string) string</code> Pending Simple string formatting <code>getProtocolDescription</code> <code>GetProtocolDescription(protocol string) string</code> Pending Simple string formatting"},{"location":"template-function-migration/#phase-3-security-and-compliance-functions","title":"Phase 3: Security and Compliance Functions","text":"Template Function Go Method Status Notes <code>getRiskLevel</code> <code>AssessRiskLevel(severity string) string</code> Migrated Implemented in <code>markdown_security.go</code> line 20 <code>calculateSecurityScore</code> <code>CalculateSecurityScore(data *model.OpnSenseDocument) int</code> Migrated Implemented in <code>markdown_security.go</code> line 42 <code>assessServiceRisk</code> <code>AssessServiceRisk(service model.Service) string</code> Migrated Implemented in <code>markdown_security.go</code> line 91 <code>getSecurityZone</code> <code>DetermineSecurityZone(interfaceName string) string</code> Pending Zone classification logic <code>getSTIGDescription</code> <code>GetSTIGControlDescription(controlID string) string</code> Pending Placeholder - needs STIG database <code>getSANSDescription</code> <code>GetSANSControlDescription(controlID string) string</code> Pending Placeholder - needs SANS database <code>getRuleCompliance</code> <code>AssessFirewallRuleCompliance(rule any) string</code> Pending Placeholder - complex analysis <code>getNATRiskLevel</code> <code>AssessNATRuleRisk(rule any) string</code> Pending Placeholder - security assessment <code>getNATRecommendation</code> <code>GenerateNATRecommendation(rule any) string</code> Pending Placeholder - remediation advice <code>getCertSecurityStatus</code> <code>AssessCertificateSecurityStatus(cert any) string</code> Pending Placeholder - certificate analysis <code>getDHCPSecurity</code> <code>AssessDHCPSecurity(dhcp any) string</code> Pending Placeholder - DHCP security check <code>getRouteSecurityZone</code> <code>DetermineRouteSecurityZone(route any) string</code> Pending Placeholder - route analysis"},{"location":"template-function-migration/#phase-4-sprig-function-replacements-high-priority","title":"Phase 4: Sprig Function Replacements (High Priority)","text":"Sprig Function Go Method Status Notes <code>upper</code> <code>ToUpper(s string) string</code> Migrated Implemented in <code>markdown_utils.go</code> line 130 <code>lower</code> <code>ToLower(s string) string</code> Migrated Implemented in <code>markdown_utils.go</code> line 135 <code>title</code> <code>ToTitle(s string) string</code> Pending Title case conversion <code>trim</code> <code>TrimSpace(s string) string</code> Migrated Implemented in <code>markdown_utils.go</code> line 140 <code>trimPrefix</code> <code>TrimPrefix(s, prefix string) string</code> Pending Prefix removal <code>trimSuffix</code> <code>TrimSuffix(s, suffix string) string</code> Pending Suffix removal <code>replace</code> <code>ReplaceString(s, old, new string) string</code> Pending String replacement <code>split</code> <code>SplitString(s, sep string) []string</code> Pending String splitting <code>join</code> <code>JoinStrings(elems []string, sep string) string</code> Pending String joining <code>contains</code> <code>ContainsString(s, substr string) bool</code> Pending Substring check <code>hasPrefix</code> <code>HasPrefix(s, prefix string) bool</code> Pending Prefix check <code>hasSuffix</code> <code>HasSuffix(s, suffix string) bool</code> Pending Suffix check <code>default</code> <code>DefaultValue(value, defaultVal any) any</code> Migrated Implemented in <code>markdown_utils.go</code> line 93 <code>empty</code> <code>IsEmpty(value any) bool</code> Migrated Implemented in <code>markdown_utils.go</code> line 101 <code>coalesce</code> <code>Coalesce(values ...any) any</code> Pending First non-empty value <code>ternary</code> <code>Ternary(condition bool, trueVal, falseVal any) any</code> Pending Conditional selection <code>toJson</code> <code>ToJSON(obj any) (string, error)</code> Pending JSON serialization <code>toPrettyJson</code> <code>ToPrettyJSON(obj any) (string, error)</code> Pending Pretty JSON serialization <code>toYaml</code> <code>ToYAML(obj any) (string, error)</code> Pending YAML serialization"},{"location":"template-function-migration/#phase-4-sprig-function-replacements-medium-priority","title":"Phase 4: Sprig Function Replacements (Medium Priority)","text":"Sprig Function Go Method Status Notes <code>add</code> <code>Add(a, b int) int</code> Pending Arithmetic operations <code>sub</code> <code>Subtract(a, b int) int</code> Pending Arithmetic operations <code>mul</code> <code>Multiply(a, b int) int</code> Pending Arithmetic operations <code>div</code> <code>Divide(a, b int) int</code> Pending Arithmetic operations <code>mod</code> <code>Modulo(a, b int) int</code> Pending Arithmetic operations <code>max</code> <code>Max(a, b int) int</code> Pending Maximum value <code>min</code> <code>Min(a, b int) int</code> Pending Minimum value <code>len</code> <code>Length(obj any) int</code> Pending Length calculation <code>reverse</code> <code>ReverseSlice(slice any) any</code> Pending Slice reversal <code>first</code> <code>FirstElement(slice any) any</code> Pending First element <code>last</code> <code>LastElement(slice any) any</code> Pending Last element <code>rest</code> <code>RestElements(slice any) any</code> Pending All but first <code>initial</code> <code>InitialElements(slice any) any</code> Pending All but last <code>uniq</code> <code>UniqueElements(slice any) any</code> Pending Remove duplicates <code>sortAlpha</code> <code>SortAlphabetically(slice any) any</code> Pending Alphabetical sort"},{"location":"template-function-migration/#phase-4-sprig-function-replacements-low-priority","title":"Phase 4: Sprig Function Replacements (Low Priority)","text":"Sprig Function Go Method Status Notes <code>date</code> <code>FormatDate(format string, date time.Time) string</code> Pending Date formatting <code>now</code> <code>CurrentTime() time.Time</code> Pending Current timestamp <code>toDate</code> <code>ParseDate(layout, value string) (time.Time, error)</code> Pending Date parsing <code>ago</code> <code>TimeAgo(t time.Time) string</code> Pending Relative time <code>htmlEscape</code> <code>HTMLEscape(s string) string</code> Pending HTML escaping <code>htmlUnescape</code> <code>HTMLUnescape(s string) string</code> Pending HTML unescaping <code>urlEscape</code> <code>URLEscape(s string) string</code> Pending URL escaping <code>urlUnescape</code> <code>URLUnescape(s string) (string, error)</code> Pending URL unescaping"},{"location":"template-function-migration/#phase-5-advanced-data-operations","title":"Phase 5: Advanced Data Operations","text":"Template Function Go Method Status Notes <code>groupServicesByStatus</code> <code>GroupServicesByStatus(services []model.Service) map[string][]model.Service</code> Migrated Implemented in <code>markdown_transformers.go</code> line 77 <code>aggregatePackageStats</code> <code>AggregatePackageStats(packages []model.Package) map[string]int</code> Migrated Implemented in <code>markdown_transformers.go</code> line 120 <code>filterRulesByType</code> <code>FilterRulesByType(rules []model.Rule, ruleType string) []model.Rule</code> Migrated Implemented in <code>markdown_transformers.go</code> line 164 <code>extractUniqueValues</code> <code>ExtractUniqueValues(items []string) []string</code> Migrated Implemented in <code>markdown_transformers.go</code> line 203"},{"location":"template-function-migration/#phase-6-report-building-methods","title":"Phase 6: Report Building Methods","text":"Template Function Go Method Status Notes <code>buildSystemSection</code> <code>BuildSystemSection(data *model.OpnSenseDocument) string</code> Migrated Implemented in <code>markdown.go</code> line 222 <code>buildNetworkSection</code> <code>BuildNetworkSection(data *model.OpnSenseDocument) string</code> Migrated Implemented in <code>markdown.go</code> line 369 <code>buildSecuritySection</code> <code>BuildSecuritySection(data *model.OpnSenseDocument) string</code> Migrated Implemented in <code>markdown.go</code> line 436 <code>buildServicesSection</code> <code>BuildServicesSection(data *model.OpnSenseDocument) string</code> Migrated Implemented in <code>markdown.go</code> line 481 <code>buildStandardReport</code> <code>BuildStandardReport(data *model.OpnSenseDocument) (string, error)</code> Migrated Implemented in <code>markdown.go</code> line 695 <code>buildComprehensiveReport</code> <code>BuildComprehensiveReport(data *model.OpnSenseDocument) (string, error)</code> Migrated Implemented in <code>markdown.go</code> line 751"},{"location":"template-function-migration/#implementation-priority","title":"Implementation Priority","text":""},{"location":"template-function-migration/#completed-functions","title":"Completed Functions","text":"<p>The following functions have been successfully migrated and are available for use:</p> <p>Phase 1: Core Utility Functions</p> <ul> <li><code>EscapeTableContent</code> - Essential for table generation</li> <li><code>IsLastInSlice</code> - Required for template loop logic</li> <li><code>TruncateDescription</code> - Used extensively in reports</li> <li><code>ToUpper</code>, <code>ToLower</code> - Basic string operations</li> <li><code>TrimSpace</code> - Data cleanup</li> <li><code>DefaultValue</code> - Default value handling</li> <li><code>IsEmpty</code> - Empty value check</li> </ul> <p>Phase 2: Data Transformation Functions</p> <ul> <li><code>FilterSystemTunables</code> - Security-focused filtering</li> </ul> <p>Phase 3: Security and Compliance Functions</p> <ul> <li><code>AssessRiskLevel</code> - Security assessment display</li> <li><code>CalculateSecurityScore</code> - Overall security scoring</li> <li><code>AssessServiceRisk</code> - Service risk assessment</li> </ul> <p>Phase 5: Advanced Data Operations</p> <ul> <li><code>GroupServicesByStatus</code> - Service grouping</li> <li><code>AggregatePackageStats</code> - Package statistics</li> <li><code>FilterRulesByType</code> - Rule filtering</li> <li><code>ExtractUniqueValues</code> - Unique value extraction</li> </ul> <p>Phase 6: Report Building Methods</p> <ul> <li><code>BuildSystemSection</code> - System section generation</li> <li><code>BuildNetworkSection</code> - Network section generation</li> <li><code>BuildSecuritySection</code> - Security section generation</li> <li><code>BuildServicesSection</code> - Services section generation</li> <li><code>BuildStandardReport</code> - Standard report generation</li> <li><code>BuildComprehensiveReport</code> - Comprehensive report generation</li> </ul> <p>Total: 30+ methods now available for programmatic generation.</p>"},{"location":"template-function-migration/#priority-2-core-data-functions-remaining","title":"Priority 2: Core Data Functions (Remaining)","text":"<ol> <li><code>FormatInterfaceLinks</code> - Important for navigation</li> <li><code>DetermineSecurityZone</code> - Network categorization</li> <li>String manipulation functions (<code>ReplaceString</code>, <code>SplitString</code>, <code>JoinStrings</code>)</li> </ol>"},{"location":"template-function-migration/#priority-3-advanced-functions-remaining","title":"Priority 3: Advanced Functions (Remaining)","text":"<ol> <li>Placeholder security functions (when data sources available)</li> <li>JSON/YAML serialization functions</li> <li>Mathematical operations</li> <li>Collection manipulation functions</li> </ol>"},{"location":"template-function-migration/#priority-4-nice-to-have-functions","title":"Priority 4: Nice-to-Have Functions","text":"<ol> <li>Date/time formatting beyond timestamp conversion</li> <li>HTML/URL escaping (may not be needed for markdown)</li> <li>Advanced collection operations</li> </ol>"},{"location":"template-function-migration/#breaking-changes","title":"Breaking Changes","text":""},{"location":"template-function-migration/#template-syntax-changes","title":"Template Syntax Changes","text":"<ul> <li>Template calls: <code>{{ getRiskLevel .Severity }}</code> \u2192 Method calls: <code>builder.AssessRiskLevel(item.Severity)</code></li> <li>Sprig functions: <code>{{ .Value | upper }}</code> \u2192 Method calls: <code>builder.ToUpper(item.Value)</code></li> <li>Pipeline operators: No longer available, must use nested method calls</li> </ul>"},{"location":"template-function-migration/#parameter-changes","title":"Parameter Changes","text":"<ul> <li>Type safety: Template functions accept <code>any</code>, Go methods use specific types</li> <li>Error handling: Go methods can return errors, templates silently fail</li> <li>Context: Template functions operate on current context, methods need explicit parameters</li> </ul>"},{"location":"template-function-migration/#return-value-changes","title":"Return Value Changes","text":"<ul> <li>Consistency: All methods return consistent types</li> <li>Error propagation: Errors bubble up instead of silent failures</li> <li>Type safety: Compile-time type checking</li> </ul>"},{"location":"template-function-migration/#migration-complexity-assessment","title":"Migration Complexity Assessment","text":""},{"location":"template-function-migration/#completed-30-functions","title":"Completed (30+ Functions)","text":"<p>The following functions have been successfully migrated and are production-ready:</p> <p>Low Complexity (Completed)</p> <ul> <li>Simple string operations (<code>ToUpper</code>, <code>ToLower</code>, <code>TrimSpace</code>)</li> <li>Basic utility functions (<code>EscapeTableContent</code>, <code>IsLastInSlice</code>, <code>TruncateDescription</code>)</li> <li>Default value handling (<code>DefaultValue</code>, <code>IsEmpty</code>)</li> </ul> <p>Medium Complexity (Completed)</p> <ul> <li>Collection operations (<code>FilterSystemTunables</code>, <code>GroupServicesByStatus</code>)</li> <li>Complex string operations (<code>TruncateDescription</code>)</li> <li>Risk assessment (<code>AssessRiskLevel</code>, <code>CalculateSecurityScore</code>, <code>AssessServiceRisk</code>)</li> <li>Data aggregation (<code>AggregatePackageStats</code>, <code>FilterRulesByType</code>, <code>ExtractUniqueValues</code>)</li> </ul> <p>High Complexity (Completed)</p> <ul> <li>Report building methods (<code>BuildSystemSection</code>, <code>BuildNetworkSection</code>, <code>BuildSecuritySection</code>, <code>BuildServicesSection</code>)</li> <li>Complete report generation (<code>BuildStandardReport</code>, <code>BuildComprehensiveReport</code>)</li> </ul>"},{"location":"template-function-migration/#remaining-work","title":"Remaining Work","text":"<p>Low Complexity (1-2 days each)</p> <ul> <li>Basic formatting functions (<code>GetPortDescription</code>, <code>GetProtocolDescription</code>)</li> <li>Additional string operations (<code>TrimPrefix</code>, <code>TrimSuffix</code>)</li> </ul> <p>Medium Complexity (3-5 days each)</p> <ul> <li>Link generation (<code>FormatInterfaceLinks</code>)</li> <li>Network categorization (<code>DetermineSecurityZone</code>)</li> <li>String manipulation (<code>ReplaceString</code>, <code>SplitString</code>, <code>JoinStrings</code>)</li> </ul> <p>High Complexity (1-2 weeks each)</p> <ul> <li>Security analysis placeholders (requires external data sources)</li> <li>JSON/YAML serialization with proper error handling</li> <li>Complex collection manipulations</li> </ul> <p>Very High Complexity (2-4 weeks each)</p> <ul> <li>Complete Sprig replacement (100+ functions)</li> <li>Template-to-Go code generation tooling</li> <li>Backwards compatibility layer</li> <li>Performance optimization for large configurations</li> </ul>"},{"location":"template-function-migration/#testing-strategy","title":"Testing Strategy","text":""},{"location":"template-function-migration/#unit-tests","title":"Unit Tests","text":"<ul> <li>Test each method with various input types</li> <li>Verify error handling for invalid inputs</li> <li>Compare output with current template function results</li> </ul>"},{"location":"template-function-migration/#integration-tests","title":"Integration Tests","text":"<ul> <li>Test method combinations in realistic scenarios</li> <li>Verify markdown output matches template-generated output</li> <li>Performance benchmarks vs template rendering</li> </ul>"},{"location":"template-function-migration/#migration-tests","title":"Migration Tests","text":"<ul> <li>Side-by-side comparison during migration</li> <li>Regression tests to ensure no functionality loss</li> <li>User acceptance tests for output quality</li> </ul>"},{"location":"template-function-migration/#recommendations","title":"Recommendations","text":"<ol> <li>Start with Priority 1 functions to establish patterns and infrastructure</li> <li>Create comprehensive unit tests before migration to ensure functional equivalence</li> <li>Implement gradual migration with feature flags to enable/disable programmatic generation</li> <li>Consider keeping some Sprig functions for complex operations where Go replacements add little value</li> <li>Profile performance to ensure Go methods are faster than template functions</li> <li>Document migration patterns for future template function additions</li> </ol>"},{"location":"template-function-migration/#notes","title":"Notes","text":"<ul> <li>Placeholder functions marked above need external data sources (STIG/SANS databases, compliance rules)</li> <li>Type safety improvements will catch errors at compile time vs runtime template failures</li> <li>Performance should improve significantly by eliminating template parsing overhead</li> <li>Maintainability will improve with explicit interfaces and dependency injection</li> <li>Testing becomes much easier with direct method calls vs template execution</li> </ul>"},{"location":"theme-usage/","title":"Theme System Usage","text":"<p>This document describes how to use the comprehensive theme system in opnDossier.</p>"},{"location":"theme-usage/#theme-configuration","title":"Theme Configuration","text":"<p>The theme system supports multiple configuration methods with the following precedence:</p> <ol> <li>CLI flag (highest priority): <code>--theme light|dark|custom</code></li> <li>Environment variable: <code>OPNDOSSIER_THEME=light|dark|custom</code></li> <li>YAML configuration file: <code>theme: light|dark|custom</code></li> <li>Auto-detection (lowest priority): Based on terminal capabilities</li> </ol>"},{"location":"theme-usage/#usage-examples","title":"Usage Examples","text":""},{"location":"theme-usage/#cli-flag-override","title":"CLI Flag Override","text":"<pre><code># Force light theme\nopnDossier --theme light convert config.xml\n\n# Force dark theme\nopnDossier --theme dark convert config.xml\n\n# Use custom theme\nopnDossier --theme custom convert config.xml\n</code></pre>"},{"location":"theme-usage/#environment-variable","title":"Environment Variable","text":"<pre><code># Set theme via environment variable\nexport OPNDOSSIER_THEME=dark\nopnDossier convert config.xml\n\n# One-time override\nOPNDOSSIER_THEME=light opnDossier convert config.xml\n</code></pre>"},{"location":"theme-usage/#yaml-configuration","title":"YAML Configuration","text":"<pre><code># ~/.opnDossier.yaml\ntheme: dark\nlog_level: info\nlog_format: text\n</code></pre>"},{"location":"theme-usage/#auto-detection","title":"Auto-Detection","text":"<p>When no theme is explicitly set, the system automatically detects the appropriate theme based on:</p> <ul> <li><code>COLORTERM</code> environment variable (truecolor, 24bit)</li> <li><code>TERM</code> environment variable (256color, dark variants)</li> <li><code>TERM_PROGRAM</code> environment variable (dark variants)</li> </ul>"},{"location":"theme-usage/#theme-properties","title":"Theme Properties","text":""},{"location":"theme-usage/#light-theme","title":"Light Theme","text":"<ul> <li>Background: <code>#FFFFFF</code> (white)</li> <li>Foreground: <code>#000000</code> (black)</li> <li>Primary: <code>#007ACC</code> (blue)</li> <li>Error: <code>#DC3545</code> (red)</li> <li>Warning: <code>#FFC107</code> (yellow)</li> <li>Success: <code>#28A745</code> (green)</li> </ul>"},{"location":"theme-usage/#dark-theme","title":"Dark Theme","text":"<ul> <li>Background: <code>#1E1E1E</code> (dark grey)</li> <li>Foreground: <code>#FFFFFF</code> (white)</li> <li>Primary: <code>#4FC3F7</code> (light blue)</li> <li>Error: <code>#F44336</code> (red)</li> <li>Warning: <code>#FF9800</code> (orange)</li> <li>Success: <code>#4CAF50</code> (green)</li> </ul>"},{"location":"theme-usage/#custom-theme","title":"Custom Theme","text":"<p>The custom theme allows for user-defined color schemes (implementation depends on specific requirements).</p>"},{"location":"theme-usage/#integration-with-glamour","title":"Integration with Glamour","text":"<p>The theme system integrates with Glamour for markdown rendering:</p> <ul> <li>Light theme uses Glamour's \"light\" style</li> <li>Dark theme uses Glamour's \"dark\" style</li> <li>Custom theme uses Glamour's \"auto\" style</li> </ul>"},{"location":"theme-usage/#terminal-compatibility","title":"Terminal Compatibility","text":"<p>The theme system respects terminal capabilities:</p> <ul> <li>Basic terminals (xterm): Default to light theme</li> <li>Modern terminals (256color, truecolor): Prefer dark theme</li> <li>Terminal programs with dark variants: Automatically use dark theme</li> </ul> <p>This ensures optimal display across different terminal environments.</p>"},{"location":"dev-guide/api/","title":"API Reference","text":"<p>This document provides detailed information about the opnDossier API and its components.</p>"},{"location":"dev-guide/api/#migration-notice-new-validate-method","title":"Migration Notice: New Validate Method","text":"<p>Important for downstream consumers: A new <code>Validate</code> method has been added to the <code>XMLParser</code> interface in this release.</p>"},{"location":"dev-guide/api/#what-changed","title":"What Changed","text":"<p>The <code>XMLParser</code> now includes a dedicated validation method:</p> <pre><code>// New method added to XMLParser interface\nfunc (p *XMLParser) Validate(cfg *model.Opnsense) error\n</code></pre>"},{"location":"dev-guide/api/#migration-guide","title":"Migration Guide","text":""},{"location":"dev-guide/api/#for-library-users","title":"For Library Users","text":"<p>If you're using opnDossier as a library and have implemented custom parsers based on the <code>XMLParser</code> interface, you'll need to implement the new <code>Validate</code> method:</p> <pre><code>// Before: Your custom parser only needed Parse method\ntype CustomParser struct{}\n\nfunc (p *CustomParser) Parse(ctx context.Context, r io.Reader) (*model.Opnsense, error) {\n    // Your implementation\n}\n\n// After: You must also implement Validate method\nfunc (p *CustomParser) Validate(cfg *model.Opnsense) error {\n    // Your validation implementation\n    // You can return nil if no validation is needed\n    return nil\n}\n</code></pre>"},{"location":"dev-guide/api/#for-cli-users","title":"For CLI Users","text":"<p>No changes are required for CLI usage. The validation is automatically integrated into existing commands.</p>"},{"location":"dev-guide/api/#recommended-integration","title":"Recommended Integration","text":"<p>For new integrations, consider using the combined <code>ParseAndValidate</code> method:</p> <pre><code>// Recommended approach for new code\nparser := parser.NewXMLParser()\ncfg, err := parser.ParseAndValidate(ctx, reader)\nif err != nil {\n    // Handle both parse and validation errors\n    return err\n}\n</code></pre>"},{"location":"dev-guide/api/#backward-compatibility","title":"Backward Compatibility","text":"<p>Existing code using only the <code>Parse</code> method will continue to work without validation. Validation is opt-in through explicit method calls or CLI flags.</p>"},{"location":"dev-guide/api/#overview","title":"Overview","text":"<p>opnDossier is structured with clear separation between CLI interface (cmd/) and internal implementation (internal/). This design ensures maintainable code while providing stable interfaces for future extensions.</p>"},{"location":"dev-guide/api/#package-structure","title":"Package Structure","text":"<pre><code>opndossier/\n\u251c\u2500\u2500 cmd/                    # CLI commands (public interface)\n\u251c\u2500\u2500 internal/\n\u2502   \u251c\u2500\u2500 config/            # Configuration management\n\u2502   \u251c\u2500\u2500 parser/            # XML parsing\n\u2502   \u251c\u2500\u2500 converter/         # Data conversion\n\u2502   \u251c\u2500\u2500 display/           # Terminal output\n\u2502   \u251c\u2500\u2500 export/            # File operations\n\u2502   \u2514\u2500\u2500 log/               # Logging utilities\n\u2514\u2500\u2500 main.go                # Application entry point\n</code></pre>"},{"location":"dev-guide/api/#cli-package-cmd","title":"CLI Package (cmd/)","text":""},{"location":"dev-guide/api/#root-command","title":"Root Command","text":"<p>The root command provides the main CLI interface with global configuration management.</p>"},{"location":"dev-guide/api/#functions","title":"Functions","text":""},{"location":"dev-guide/api/#getrootcmd-cobracommand","title":"<code>GetRootCmd() *cobra.Command</code>","text":"<p>Returns the root Cobra command for the opnDossier CLI application.</p> <pre><code>rootCmd := cmd.GetRootCmd()\nrootCmd.Execute()\n</code></pre>"},{"location":"dev-guide/api/#getlogger-loglogger","title":"<code>GetLogger() *log.Logger</code>","text":"<p>Returns the current application logger instance configured with user settings. This returns a <code>*log.Logger</code> from the internal/log package, which wraps <code>charmbracelet/log.Logger</code> for structured logging.</p> <pre><code>logger := cmd.GetLogger()\nlogger.Info(\\\"Operation completed\\\", \\\"file\\\", filename)\n</code></pre>"},{"location":"dev-guide/api/#getconfig-configconfig","title":"<code>GetConfig() *config.Config</code>","text":"<p>Returns the current application configuration instance with all precedence applied.</p> <pre><code>cfg := cmd.GetConfig()\nif cfg.IsVerbose() {\n    // Enable detailed logging\n}\n</code></pre>"},{"location":"dev-guide/api/#global-flags","title":"Global Flags","text":"<p>All commands inherit these global flags:</p> Flag Type Default Description <code>--config</code> string <code>~/.opnDossier.yaml</code> Configuration file path <code>--verbose, -v</code> bool false Enable debug logging <code>--quiet, -q</code> bool false Suppress non-error output <code>--log_level</code> string \"info\" Log level (debug, info, warn, error) <code>--log_format</code> string \"text\" Log format (text, json)"},{"location":"dev-guide/api/#convert-command","title":"Convert Command","text":"<p>The convert command processes OPNsense configuration files.</p>"},{"location":"dev-guide/api/#usage","title":"Usage","text":"<pre><code>opndossier convert [file ...] [flags]\n</code></pre>"},{"location":"dev-guide/api/#flags","title":"Flags","text":"Flag Type Default Description <code>--output, -o</code> string \"\" Output file path"},{"location":"dev-guide/api/#examples","title":"Examples","text":"<pre><code>// Programmatic usage (if needed for testing)\nconvertCmd := cmd.GetRootCmd().Commands()[0] // \\\"convert\\\" command\nconvertCmd.SetArgs([]string{\\\"config.xml\\\", \\\"-o\\\", \\\"output.md\\\"})\nerr := convertCmd.Execute()\n</code></pre>"},{"location":"dev-guide/api/#configuration-package-internalconfig","title":"Configuration Package (internal/config)","text":""},{"location":"dev-guide/api/#types","title":"Types","text":""},{"location":"dev-guide/api/#config","title":"Config","text":"<pre><code>type Config struct {\n    InputFile  string `mapstructure:\\\"input_file\\\"`\n    OutputFile string `mapstructure:\\\"output_file\\\"`\n    Verbose    bool   `mapstructure:\\\"verbose\\\"`\n    Quiet      bool   `mapstructure:\\\"quiet\\\"`\n    LogLevel   string `mapstructure:\\\"log_level\\\"`\n    LogFormat  string `mapstructure:\\\"log_format\\\"`\n}\n</code></pre>"},{"location":"dev-guide/api/#validationerror","title":"ValidationError","text":"<pre><code>type ValidationError struct {\n    Field   string\n    Message string\n}\n</code></pre>"},{"location":"dev-guide/api/#functions_1","title":"Functions","text":""},{"location":"dev-guide/api/#loadconfigcfgfile-string-config-error","title":"<code>LoadConfig(cfgFile string) (*Config, error)</code>","text":"<p>Loads configuration from file, environment variables, and defaults.</p> <pre><code>cfg, err := config.LoadConfig(\\\"\\\") // Use default location\nif err != nil {\n    return fmt.Errorf(\\\"config load failed: %w\\\", err)\n}\n</code></pre>"},{"location":"dev-guide/api/#loadconfigwithflagscfgfile-string-flags-pflagflagset-config-error","title":"<code>LoadConfigWithFlags(cfgFile string, flags *pflag.FlagSet) (*Config, error)</code>","text":"<p>Loads configuration with CLI flag binding for proper precedence.</p> <pre><code>cfg, err := config.LoadConfigWithFlags(configFile, cmd.Flags())\nif err != nil {\n    return fmt.Errorf(\\\"config load failed: %w\\\", err)\n}\n</code></pre>"},{"location":"dev-guide/api/#methods","title":"Methods","text":""},{"location":"dev-guide/api/#configvalidate-error","title":"<code>(*Config).Validate() error</code>","text":"<p>Validates configuration for consistency and correctness.</p> <pre><code>if err := cfg.Validate(); err != nil {\n    log.Fatalf(\\\"Invalid configuration: %v\\\", err)\n}\n</code></pre>"},{"location":"dev-guide/api/#configgetloglevel-string","title":"<code>(*Config).GetLogLevel() string</code>","text":"<p>Returns the configured log level.</p>"},{"location":"dev-guide/api/#configgetlogformat-string","title":"<code>(*Config).GetLogFormat() string</code>","text":"<p>Returns the configured log format.</p>"},{"location":"dev-guide/api/#configisverbose-bool","title":"<code>(*Config).IsVerbose() bool</code>","text":"<p>Returns true if verbose logging is enabled.</p>"},{"location":"dev-guide/api/#configisquiet-bool","title":"<code>(*Config).IsQuiet() bool</code>","text":"<p>Returns true if quiet mode is enabled.</p>"},{"location":"dev-guide/api/#parser-package-internalparser","title":"Parser Package (internal/parser)","text":""},{"location":"dev-guide/api/#interfaces","title":"Interfaces","text":""},{"location":"dev-guide/api/#xmlparser","title":"XMLParser","text":"<pre><code>type XMLParser interface {\n    Parse(ctx context.Context, reader io.Reader) (*OPNsense, error)\n}\n</code></pre>"},{"location":"dev-guide/api/#types_1","title":"Types","text":""},{"location":"dev-guide/api/#opnsense","title":"OPNsense","text":"<pre><code>type OPNsense struct {\n    XMLName xml.Name `xml:\\\"opnsense\\\"`\n    // Configuration structure mirrors OPNsense XML format\n    System   System   `xml:\\\"system\\\"`\n    Firewall Firewall `xml:\\\"filter\\\"`\n    // Additional fields as needed\n}\n</code></pre>"},{"location":"dev-guide/api/#functions_2","title":"Functions","text":""},{"location":"dev-guide/api/#newxmlparser-xmlparser","title":"<code>NewXMLParser() XMLParser</code>","text":"<p>Creates a new XML parser instance.</p> <pre><code>parser := parser.NewXMLParser()\nopnsense, err := parser.Parse(ctx, reader)\n</code></pre>"},{"location":"dev-guide/api/#converter-package-internalconverter","title":"Converter Package (internal/converter)","text":""},{"location":"dev-guide/api/#interfaces_1","title":"Interfaces","text":""},{"location":"dev-guide/api/#markdownconverter","title":"MarkdownConverter","text":"<pre><code>type MarkdownConverter interface {\n    ToMarkdown(ctx context.Context, opnsense *parser.OPNsense) (string, error)\n}\n</code></pre>"},{"location":"dev-guide/api/#functions_3","title":"Functions","text":""},{"location":"dev-guide/api/#newmarkdownconverter-markdownconverter","title":"<code>NewMarkdownConverter() MarkdownConverter</code>","text":"<p>Creates a new markdown converter instance.</p> <pre><code>converter := converter.NewMarkdownConverter()\nmarkdown, err := converter.ToMarkdown(ctx, opnsenseConfig)\n</code></pre>"},{"location":"dev-guide/api/#export-package-internalexport","title":"Export Package (internal/export)","text":""},{"location":"dev-guide/api/#interfaces_2","title":"Interfaces","text":""},{"location":"dev-guide/api/#fileexporter","title":"FileExporter","text":"<pre><code>type FileExporter interface {\n    Export(ctx context.Context, content string, filepath string) error\n}\n</code></pre>"},{"location":"dev-guide/api/#functions_4","title":"Functions","text":""},{"location":"dev-guide/api/#newfileexporter-fileexporter","title":"<code>NewFileExporter() FileExporter</code>","text":"<p>Creates a new file exporter instance.</p> <pre><code>exporter := export.NewFileExporter()\nerr := exporter.Export(ctx, markdownContent, \\\"output.md\\\")\n</code></pre>"},{"location":"dev-guide/api/#log-package-internallog","title":"Log Package (internal/log)","text":"<p>The log package provides a wrapper around <code>charmbracelet/log</code> for structured logging with additional application-specific functionality.</p>"},{"location":"dev-guide/api/#types_2","title":"Types","text":""},{"location":"dev-guide/api/#logger","title":"Logger","text":"<pre><code>type Logger struct {\n    *log.Logger  // Embeds charmbracelet/log.Logger\n}\n</code></pre> <p>The <code>Logger</code> type wraps <code>charmbracelet/log.Logger</code> to provide structured logging capabilities with key-value pairs and context support.</p>"},{"location":"dev-guide/api/#config_1","title":"Config","text":"<pre><code>type Config struct {\n    Level           string\n    Format          string\n    Output          io.Writer\n    ReportCaller    bool\n    ReportTimestamp bool\n}\n</code></pre>"},{"location":"dev-guide/api/#functions_5","title":"Functions","text":""},{"location":"dev-guide/api/#newconfig-config-logger-error","title":"<code>New(config Config) (*Logger, error)</code>","text":"<p>Creates a new logger instance with the specified configuration. Returns a <code>*log.Logger</code> from the internal/log package that wraps <code>charmbracelet/log.Logger</code>.</p> <pre><code>logger, err := log.New(log.Config{\n    Level:           \\\"info\\\",\n    Format:          \\\"text\\\",\n    Output:          os.Stderr,\n    ReportCaller:    true,\n    ReportTimestamp: true,\n})\nif err != nil {\n    return fmt.Errorf(\\\"failed to create logger: %w\\\", err)\n}\n</code></pre>"},{"location":"dev-guide/api/#methods_1","title":"Methods","text":""},{"location":"dev-guide/api/#loggerinfomsg-string-keyvals-interface","title":"<code>(*Logger).Info(msg string, keyvals ...interface{})</code>","text":"<p>Logs an info-level message with optional key-value pairs.</p> <pre><code>logger.Info(\\\"Processing file\\\", \\\"filename\\\", path, \\\"size\\\", fileSize)\n</code></pre>"},{"location":"dev-guide/api/#loggerdebugmsg-string-keyvals-interface","title":"<code>(*Logger).Debug(msg string, keyvals ...interface{})</code>","text":"<p>Logs a debug-level message with optional key-value pairs.</p>"},{"location":"dev-guide/api/#loggerwarnmsg-string-keyvals-interface","title":"<code>(*Logger).Warn(msg string, keyvals ...interface{})</code>","text":"<p>Logs a warning-level message with optional key-value pairs.</p>"},{"location":"dev-guide/api/#loggererrormsg-string-keyvals-interface","title":"<code>(*Logger).Error(msg string, keyvals ...interface{})</code>","text":"<p>Logs an error-level message with optional key-value pairs.</p>"},{"location":"dev-guide/api/#loggerwithcontextctx-contextcontext-logger","title":"<code>(*Logger).WithContext(ctx context.Context) *Logger</code>","text":"<p>Returns a logger that includes context information.</p> <pre><code>ctxLogger := logger.WithContext(ctx)\nctxLogger.Info(\\\"Starting operation\\\")\n</code></pre>"},{"location":"dev-guide/api/#loggerwithfieldskeyvals-interface-logger","title":"<code>(*Logger).WithFields(keyvals ...interface{}) *Logger</code>","text":"<p>Returns a logger with additional fields pre-configured.</p> <pre><code>fileLogger := logger.WithFields(\\\"operation\\\", \\\"convert\\\", \\\"file\\\", filename)\nfileLogger.Info(\\\"Processing started\\\")\n</code></pre>"},{"location":"dev-guide/api/#configuration-precedence","title":"Configuration Precedence","text":"<p>The configuration system follows this precedence order (highest to lowest):</p> <ol> <li>CLI Flags - Immediate overrides via command-line</li> <li>Environment Variables - <code>OPNDOSSIER_*</code> prefixed variables</li> <li>Configuration File - YAML file at <code>~/.opnDossier.yaml</code> or custom path</li> <li>Default Values - Built-in defaults</li> </ol>"},{"location":"dev-guide/api/#environment-variable-mapping","title":"Environment Variable Mapping","text":"Config Field Environment Variable Default <code>input_file</code> <code>OPNDOSSIER_INPUT_FILE</code> \"\" <code>output_file</code> <code>OPNDOSSIER_OUTPUT_FILE</code> \"\" <code>verbose</code> <code>OPNDOSSIER_VERBOSE</code> false <code>quiet</code> <code>OPNDOSSIER_QUIET</code> false <code>log_level</code> <code>OPNDOSSIER_LOG_LEVEL</code> \"info\" <code>log_format</code> <code>OPNDOSSIER_LOG_FORMAT</code> \"text\""},{"location":"dev-guide/api/#error-handling","title":"Error Handling","text":""},{"location":"dev-guide/api/#error-types","title":"Error Types","text":"<p>All packages use standard Go error handling with context-aware error wrapping:</p> <pre><code>if err := someOperation(); err != nil {\n    return fmt.Errorf(\\\"operation failed: %w\\\", err)\n}\n</code></pre>"},{"location":"dev-guide/api/#validation-errors","title":"Validation Errors","text":"<p>Configuration validation errors implement a specific type:</p> <pre><code>type ValidationError struct {\n    Field   string\n    Message string\n}\n\nfunc (e ValidationError) Error() string {\n    return fmt.Sprintf(\\\"validation error for field '%s': %s\\\", e.Field, e.Message)\n}\n</code></pre>"},{"location":"dev-guide/api/#best-practices","title":"Best Practices","text":"<ol> <li>Always wrap errors with context</li> <li>Use structured logging for debugging</li> <li>Validate inputs early</li> <li>Return errors, don't log and return</li> </ol>"},{"location":"dev-guide/api/#testing-interfaces","title":"Testing Interfaces","text":""},{"location":"dev-guide/api/#test-helpers","title":"Test Helpers","text":"<p>For testing CLI commands:</p> <pre><code>func TestConvertCommand(t *testing.T) {\n    // Set up test command\n    cmd := cmd.GetRootCmd()\n    cmd.SetArgs([]string{\\\"convert\\\", \\\"testdata/config.xml\\\"})\n\n    // Capture output\n    var buf bytes.Buffer\n    cmd.SetOutput(&amp;buf)\n\n    // Execute and verify\n    err := cmd.Execute()\n    assert.NoError(t, err)\n    assert.Contains(t, buf.String(), \\\"expected output\\\")\n}\n</code></pre> <p>For testing configuration:</p> <pre><code>func TestConfigPrecedence(t *testing.T) {\n    // Set environment variable\n    t.Setenv(\\\"OPNDOSSIER_LOG_LEVEL\\\", \\\"debug\\\")\n\n    // Load config\n    cfg, err := config.LoadConfig(\\\"\\\")\n    require.NoError(t, err)\n\n    // Verify precedence\n    assert.Equal(t, \\\"debug\\\", cfg.LogLevel)\n}\n</code></pre>"},{"location":"dev-guide/api/#extension-points","title":"Extension Points","text":""},{"location":"dev-guide/api/#adding-new-commands","title":"Adding New Commands","text":"<ol> <li>Create command file in <code>cmd/</code></li> <li>Implement command with proper configuration precedence</li> <li>Add to root command in init()</li> <li>Update help text with configuration info</li> </ol>"},{"location":"dev-guide/api/#adding-configuration-options","title":"Adding Configuration Options","text":"<ol> <li>Add field to <code>Config</code> struct</li> <li>Set default in <code>LoadConfigWithViper</code></li> <li>Add CLI flag in <code>cmd/root.go</code></li> <li>Add validation if needed</li> <li>Update documentation</li> </ol>"},{"location":"dev-guide/api/#adding-new-output-formats","title":"Adding New Output Formats","text":"<ol> <li>Create new converter implementing the interface</li> <li>Add format option to configuration</li> <li>Update convert command to handle new format</li> <li>Add tests and documentation</li> </ol> <p>This API reference covers the current stable interfaces. For the most up-to-date information, refer to the source code and inline documentation.</p>"},{"location":"dev-guide/architecture/","title":"System Architecture","text":"<p>This document provides a comprehensive overview of the opnDossier system architecture, including high-level design, data flow, storage patterns, and external integrations.</p>"},{"location":"dev-guide/architecture/#table-of-contents","title":"Table of Contents","text":"<ul> <li>High-Level Architecture</li> <li>System Components</li> <li>Data Flow Architecture</li> <li>Storage Strategy</li> <li>External Integrations</li> <li>Air-Gap/Offline Considerations</li> <li>Versioned Data Strategy</li> <li>Deployment Architecture</li> <li>Security Architecture</li> </ul>"},{"location":"dev-guide/architecture/#high-level-architecture","title":"High-Level Architecture","text":"<p>opnDossier follows a monolithic CLI architecture with clear separation of concerns, designed for operator-centric workflows in offline environments.</p> <pre><code>graph TB\n    subgraph \"User Environment\"\n        U[Network Operator]\n        XML[OPNsense config.xml]\n        MD[Markdown Output]\n        TERM[Terminal Display]\n    end\n\n    subgraph \"opnDossier CLI Application\"\n        CLI[CLI Interface&lt;br/&gt;Cobra Framework]\n\n        subgraph \"Core Processing Engine\"\n            CFG[Configuration Layer&lt;br/&gt;Fang]\n            PARSER[XML Parser&lt;br/&gt;encoding/xml]\n            CONV[Data Converter]\n            RENDER[Output Renderer]\n        end\n\n        subgraph \"Output Systems\"\n            DISP[Terminal Display&lt;br/&gt;Lipgloss + Glamour]\n            FILE[File Writer]\n        end\n    end\n\n    subgraph \"External Systems (Optional)\"\n        DOCS[Documentation Site&lt;br/&gt;MkDocs]\n        PKG[Package Managers&lt;br/&gt;APT/RPM/Homebrew]\n    end\n\n    U --&gt;|Provides| XML\n    U --&gt;|Executes| CLI\n    CLI --&gt;|Configures| CFG\n    CLI --&gt;|Parses| PARSER\n    PARSER --&gt;|Structured Data| CONV\n    CONV --&gt;|Processed Data| RENDER\n    RENDER --&gt;|Styled Output| DISP\n    RENDER --&gt;|Files| FILE\n    DISP --&gt;|Terminal| TERM\n    FILE --&gt;|Exports| MD\n\n    CLI -.-&gt;|Documentation| DOCS\n    CLI -.-&gt;|Distribution| PKG\n\n    classDef userLayer fill:#e1f5fe\n    classDef coreLayer fill:#f3e5f5\n    classDef outputLayer fill:#e8f5e8\n    classDef externalLayer fill:#fff3e0\n\n    class U,XML,MD,TERM userLayer\n    class CLI,CFG,PARSER,CONV,RENDER coreLayer\n    class DISP,FILE outputLayer\n    class DOCS,PKG externalLayer</code></pre>"},{"location":"dev-guide/architecture/#architecture-principles","title":"Architecture Principles","text":"<ol> <li>Offline-First: No external dependencies required for core functionality</li> <li>Operator-Focused: Designed for network administrators and operators</li> <li>Framework-First: Leverages established Go libraries and patterns</li> <li>Structured Data: All processing maintains data structure and relationships</li> <li>Security-First: No telemetry, no external network calls, input validation</li> </ol>"},{"location":"dev-guide/architecture/#system-components","title":"System Components","text":""},{"location":"dev-guide/architecture/#cli-interface-layer","title":"CLI Interface Layer","text":"<p>Technology: Cobra CLI Framework</p> <p>Responsibilities:</p> <ul> <li>Command-line argument parsing and validation</li> <li>User interaction and help system</li> <li>Command routing and execution</li> <li>Error handling and user feedback</li> </ul> <p>Key Components:</p> <ul> <li>Root command handler (<code>cmd/root.go</code>)</li> <li>OPNsense processing command (<code>cmd/opnsense.go</code>)</li> <li>Configuration management integration</li> </ul>"},{"location":"dev-guide/architecture/#configuration-management-layer","title":"Configuration Management Layer","text":"<p>Technology: spf13/viper</p> <p>Responsibilities:</p> <ul> <li>Configuration file parsing (YAML)</li> <li>Environment variable processing</li> <li>Command-line flag integration</li> <li>Configuration precedence management</li> </ul> <p>Configuration Sources (in order of precedence):</p> <ol> <li>Command-line flags (highest priority)</li> <li>Environment variables (<code>OPNDOSSIER_*</code>)</li> <li>Configuration file (<code>~/.opnDossier.yaml</code>)</li> <li>Default values (lowest priority)</li> </ol> <p>This follows the standard precedence order used by most CLI tools, where environment variables can override configuration file settings for deployment flexibility and security.</p>"},{"location":"dev-guide/architecture/#data-processing-engine","title":"Data Processing Engine","text":""},{"location":"dev-guide/architecture/#xml-parser-component","title":"XML Parser Component","text":"<p>Technology: Go's built-in <code>encoding/xml</code></p> <p>Responsibilities:</p> <ul> <li>OPNsense XML configuration parsing</li> <li>Schema validation and error reporting</li> <li>Structured data extraction</li> <li>Malformed input handling</li> </ul> <p>Data Structures:</p> <ul> <li><code>Opnsense</code> struct with complete XML mapping</li> <li>Nested structures for system, interfaces, firewall rules</li> <li>JSON tags for alternative serialization</li> </ul>"},{"location":"dev-guide/architecture/#data-converter-component","title":"Data Converter Component","text":"<p>Responsibilities:</p> <ul> <li>XML-to-Markdown transformation</li> <li>Configuration hierarchy preservation</li> <li>Metadata injection (timestamps, versions)</li> <li>Template-based output generation</li> </ul>"},{"location":"dev-guide/architecture/#output-renderer-component","title":"Output Renderer Component","text":"<p>Responsibilities:</p> <ul> <li>Markdown formatting and styling</li> <li>Template processing</li> <li>Output format selection</li> <li>Content structuring</li> </ul>"},{"location":"dev-guide/architecture/#output-systems","title":"Output Systems","text":""},{"location":"dev-guide/architecture/#terminal-display-system","title":"Terminal Display System","text":"<p>Technologies:</p> <ul> <li>Charm Lipgloss (terminal styling)</li> <li>Charm Glamour (markdown rendering)</li> </ul> <p>Responsibilities:</p> <ul> <li>Syntax highlighting</li> <li>Color theme management</li> <li>Terminal compatibility</li> <li>Interactive display modes</li> </ul>"},{"location":"dev-guide/architecture/#file-export-system","title":"File Export System","text":"<p>Responsibilities:</p> <ul> <li>File system operations</li> <li>Directory creation</li> <li>Permission handling</li> <li>Output validation</li> </ul>"},{"location":"dev-guide/architecture/#data-flow-architecture","title":"Data Flow Architecture","text":"<pre><code>sequenceDiagram\n    participant U as User\n    participant CLI as CLI Interface\n    participant CFG as Config Manager\n    participant P as XML Parser\n    participant C as Converter\n    participant R as Renderer\n    participant O as Output System\n\n    U-&gt;&gt;CLI: opndossier convert config.xml\n    CLI-&gt;&gt;CFG: Load configuration\n    CFG--&gt;&gt;CLI: Configuration object\n    CLI-&gt;&gt;P: Parse XML file\n\n    alt Valid XML\n        P-&gt;&gt;P: Validate structure\n        P--&gt;&gt;CLI: Opnsense struct\n        CLI-&gt;&gt;C: Convert to markdown\n        C-&gt;&gt;C: Transform data\n        C--&gt;&gt;CLI: Markdown content\n        CLI-&gt;&gt;R: Render output\n\n        alt Terminal display\n            R-&gt;&gt;O: Format for terminal\n            O--&gt;&gt;U: Styled terminal output\n        else File export\n            R-&gt;&gt;O: Write to file\n            O--&gt;&gt;U: Confirmation message\n        end\n\n    else Invalid XML\n        P--&gt;&gt;CLI: Parse error\n        CLI--&gt;&gt;U: Error message with details\n    end</code></pre>"},{"location":"dev-guide/architecture/#data-transformation-pipeline","title":"Data Transformation Pipeline","text":"<ol> <li> <p>Input Validation</p> </li> <li> <p>File existence verification</p> </li> <li>XML syntax validation</li> <li> <p>Permission checks</p> </li> <li> <p>Parsing Phase</p> </li> <li> <p>XML deserialization</p> </li> <li>Structure validation</li> <li> <p>Error context preservation</p> </li> <li> <p>Conversion Phase</p> </li> <li> <p>Data mapping and transformation</p> </li> <li>Hierarchy preservation</li> <li> <p>Metadata enrichment</p> </li> <li> <p>Rendering Phase</p> </li> <li> <p>Template application</p> </li> <li>Format-specific rendering</li> <li> <p>Output optimization</p> </li> <li> <p>Output Phase</p> </li> <li> <p>Terminal display or file writing</p> </li> <li>User feedback</li> <li>Error handling</li> </ol>"},{"location":"dev-guide/architecture/#storage-strategy","title":"Storage Strategy","text":""},{"location":"dev-guide/architecture/#local-file-system","title":"Local File System","text":"<p>Configuration Storage:</p> <ul> <li>Default location: <code>~/.opnDossier.yaml</code></li> <li>Format: YAML</li> <li>Scope: User-specific preferences</li> </ul> <p>Input Files:</p> <ul> <li>Format: XML (OPNsense config.xml)</li> <li>Location: User-specified paths</li> <li>Validation: Schema-based</li> </ul> <p>Output Files:</p> <ul> <li>Format: Markdown</li> <li>Location: User-specified or current directory</li> <li>Naming: Configurable with defaults</li> </ul>"},{"location":"dev-guide/architecture/#memory-management","title":"Memory Management","text":"<p>Structured Data:</p> <ul> <li>Go structs for type safety</li> <li>Efficient XML unmarshaling</li> <li>Garbage collection optimized</li> </ul> <p>Large File Handling:</p> <ul> <li>Streaming XML parsing for large configurations</li> <li>Memory-efficient processing</li> <li>Progress indicators for long operations</li> </ul>"},{"location":"dev-guide/architecture/#external-integrations","title":"External Integrations","text":""},{"location":"dev-guide/architecture/#documentation-system","title":"Documentation System","text":"<p>Technology: MkDocs with Material theme</p> <p>Integration Points:</p> <ul> <li>Static documentation generation</li> <li>Example usage and tutorials</li> <li>API reference documentation</li> <li>Development guides</li> </ul> <p>Deployment:</p> <ul> <li>Local development server</li> <li>Static site generation</li> <li>No runtime dependencies</li> </ul>"},{"location":"dev-guide/architecture/#package-distribution","title":"Package Distribution","text":"<p>Technologies:</p> <ul> <li>GoReleaser for multi-platform builds</li> <li>GitHub Releases for distribution</li> <li>Package managers (APT, RPM, Homebrew)</li> </ul> <p>Supported Platforms:</p> <ul> <li>Linux (amd64, arm64)</li> <li>macOS (amd64, arm64, universal binaries)</li> <li>Windows (amd64, arm64)</li> </ul> <p>Package Formats:</p> <ul> <li>Binary releases (tar.gz, zip)</li> <li>System packages (deb, rpm, apk)</li> <li>Homebrew formula</li> <li>Arch Linux packages</li> </ul>"},{"location":"dev-guide/architecture/#development-integration","title":"Development Integration","text":"<p>CI/CD Pipeline:</p> <ul> <li>GitHub Actions for automated testing</li> <li>Cross-platform build verification</li> <li>Security scanning</li> <li>Documentation deployment</li> </ul> <p>Development Tools:</p> <ul> <li>Just task runner for development workflows</li> <li>Pre-commit hooks for code quality</li> <li>golangci-lint for static analysis</li> <li>GoReleaser for release automation</li> </ul>"},{"location":"dev-guide/architecture/#air-gapoffline-considerations","title":"Air-Gap/Offline Considerations","text":""},{"location":"dev-guide/architecture/#core-design-principles","title":"Core Design Principles","text":"<ol> <li>Zero External Dependencies: The application functions completely offline</li> <li>No Outbound Network Calls: No telemetry, updates, or external API calls</li> <li>Self-Contained: All required libraries embedded in the binary</li> <li>Portable: Single binary deployment with no installation requirements</li> </ol>"},{"location":"dev-guide/architecture/#offline-functionality","title":"Offline Functionality","text":"<pre><code>graph LR\n    subgraph \"Air-Gapped Environment\"\n        subgraph \"Secure Network\"\n            FW[OPNsense Firewall]\n            OPS[Operator Workstation]\n            DOCS[Documentation Server]\n        end\n\n        subgraph \"opnDossier Application\"\n            BIN[Single Binary]\n            CFG[Local Config]\n            TEMP[Templates]\n        end\n    end\n\n    FW --&gt;|config.xml| OPS\n    OPS --&gt;|Executes| BIN\n    BIN --&gt;|Reads| CFG\n    BIN --&gt;|Uses| TEMP\n    BIN --&gt;|Generates| DOCS\n\n    classDef secure fill:#ffebee\n    classDef app fill:#e8f5e8\n    class FW,OPS,DOCS secure\n    class BIN,CFG,TEMP app</code></pre>"},{"location":"dev-guide/architecture/#data-exchange-patterns","title":"Data Exchange Patterns","text":"<p>Import Mechanisms:</p> <ul> <li>Local file system access</li> <li>USB drive compatibility</li> <li>Network share mounting</li> <li>Secure file transfer protocols</li> </ul> <p>Export Formats:</p> <ul> <li>Markdown files for documentation</li> <li>JSON for structured data exchange</li> <li>Plain text for simple viewing</li> <li>HTML for web-based viewing (planned)</li> </ul>"},{"location":"dev-guide/architecture/#security-considerations","title":"Security Considerations","text":"<p>Input Validation:</p> <ul> <li>XML schema validation</li> <li>Path traversal prevention</li> <li>File size limits</li> <li>Content sanitization</li> </ul> <p>Data Handling:</p> <ul> <li>No sensitive data logging</li> <li>Secure memory management</li> <li>Temporary file cleanup</li> <li>Permission-based access control</li> </ul>"},{"location":"dev-guide/architecture/#versioned-data-strategy","title":"Versioned Data Strategy","text":""},{"location":"dev-guide/architecture/#configuration-versioning","title":"Configuration Versioning","text":"<pre><code>graph TB\n    subgraph \"Version Management\"\n        V1[Config v1.0&lt;br/&gt;Basic parsing]\n        V2[Config v2.0&lt;br/&gt;Enhanced features]\n        V3[Config v3.0&lt;br/&gt;Extended support]\n    end\n\n    subgraph \"Compatibility Layer\"\n        COMPAT[Version Compatibility&lt;br/&gt;Handler]\n        MIGRATE[Migration&lt;br/&gt;Engine]\n        VALIDATE[Schema&lt;br/&gt;Validator]\n    end\n\n    subgraph \"Processing Engine\"\n        PARSER[XML Parser]\n        CONVERTER[Data Converter]\n        RENDERER[Output Renderer]\n    end\n\n    V1 --&gt; COMPAT\n    V2 --&gt; COMPAT\n    V3 --&gt; COMPAT\n\n    COMPAT --&gt; VALIDATE\n    COMPAT --&gt; MIGRATE\n    MIGRATE --&gt; PARSER\n    VALIDATE --&gt; PARSER\n\n    PARSER --&gt; CONVERTER\n    CONVERTER --&gt; RENDERER\n\n    classDef version fill:#e3f2fd\n    classDef compat fill:#f3e5f5\n    classDef process fill:#e8f5e8\n\n    class V1,V2,V3 version\n    class COMPAT,MIGRATE,VALIDATE compat\n    class PARSER,CONVERTER,RENDERER process</code></pre>"},{"location":"dev-guide/architecture/#data-structure-evolution","title":"Data Structure Evolution","text":"<p>Schema Management:</p> <ul> <li>Backward compatibility for older OPNsense versions</li> <li>Forward compatibility for newer configurations</li> <li>Migration utilities for format changes</li> <li>Deprecation warnings for obsolete features</li> </ul> <p>Version Detection:</p> <ul> <li>Automatic OPNsense version detection</li> <li>Schema validation based on version</li> <li>Feature availability mapping</li> <li>Compatibility warnings</li> </ul> <p>Output Versioning:</p> <ul> <li>Markdown format versioning</li> <li>Template evolution management</li> <li>Metadata version tracking</li> <li>Change documentation</li> </ul>"},{"location":"dev-guide/architecture/#non-destructive-updates","title":"Non-Destructive Updates","text":"<p>Principles:</p> <ul> <li>Original files never modified</li> <li>New versions create new outputs</li> <li>Rollback capabilities maintained</li> <li>Audit trail preservation</li> </ul> <p>Implementation:</p> <ul> <li>Timestamped output files</li> <li>Version metadata in headers</li> <li>Change tracking in outputs</li> <li>Diff generation capabilities</li> </ul>"},{"location":"dev-guide/architecture/#deployment-architecture","title":"Deployment Architecture","text":""},{"location":"dev-guide/architecture/#single-binary-distribution","title":"Single Binary Distribution","text":"<pre><code>graph TB\n    subgraph \"Build Process\"\n        SRC[Source Code]\n        BUILD[GoReleaser Build]\n        TEST[Automated Testing]\n        SIGN[Code Signing]\n    end\n\n    subgraph \"Distribution Channels\"\n        GH[GitHub Releases]\n        PKG[Package Managers]\n        DIRECT[Direct Download]\n    end\n\n    subgraph \"Target Environments\"\n        LINUX[Linux Systems]\n        MACOS[macOS Systems]\n        WIN[Windows Systems]\n        AIRGAP[Air-Gapped Networks]\n    end\n\n    SRC --&gt; BUILD\n    BUILD --&gt; TEST\n    TEST --&gt; SIGN\n    SIGN --&gt; GH\n    SIGN --&gt; PKG\n    SIGN --&gt; DIRECT\n\n    GH --&gt; LINUX\n    GH --&gt; MACOS\n    GH --&gt; WIN\n\n    PKG --&gt; LINUX\n    PKG --&gt; MACOS\n    PKG --&gt; WIN\n\n    DIRECT --&gt; AIRGAP\n\n    classDef build fill:#fff3e0\n    classDef dist fill:#e8f5e8\n    classDef target fill:#e3f2fd\n\n    class SRC,BUILD,TEST,SIGN build\n    class GH,PKG,DIRECT dist\n    class LINUX,MACOS,WIN,AIRGAP target</code></pre>"},{"location":"dev-guide/architecture/#installation-patterns","title":"Installation Patterns","text":"<p>System Installation:</p> <ul> <li>Package manager integration</li> <li>System-wide availability</li> <li>Automatic updates (where permitted)</li> <li>Dependency management</li> </ul> <p>Portable Installation:</p> <ul> <li>Single binary execution</li> <li>No installation required</li> <li>USB drive compatibility</li> <li>Network share deployment</li> </ul> <p>Containerized Deployment:</p> <ul> <li>Docker image availability (planned)</li> <li>Kubernetes compatibility (planned)</li> <li>Isolated execution environment</li> <li>Reproducible builds</li> </ul>"},{"location":"dev-guide/architecture/#security-architecture","title":"Security Architecture","text":""},{"location":"dev-guide/architecture/#security-boundaries","title":"Security Boundaries","text":"<pre><code>graph TB\n    subgraph \"External Boundary\"\n        INPUT[User Input&lt;br/&gt;XML Files]\n        OUTPUT[Generated Files&lt;br/&gt;Markdown/JSON]\n    end\n\n    subgraph \"Application Boundary\"\n        VALIDATE[Input Validation]\n        PROCESS[Core Processing]\n        SANITIZE[Output Sanitization]\n    end\n\n    subgraph \"System Boundary\"\n        FS[File System&lt;br/&gt;Access]\n        MEM[Memory&lt;br/&gt;Management]\n        PROC[Process&lt;br/&gt;Isolation]\n    end\n\n    INPUT --&gt; VALIDATE\n    VALIDATE --&gt; PROCESS\n    PROCESS --&gt; SANITIZE\n    SANITIZE --&gt; OUTPUT\n\n    VALIDATE -.-&gt; FS\n    PROCESS -.-&gt; MEM\n    SANITIZE -.-&gt; PROC\n\n    classDef external fill:#ffebee\n    classDef app fill:#fff3e0\n    classDef system fill:#e8f5e8\n\n    class INPUT,OUTPUT external\n    class VALIDATE,PROCESS,SANITIZE app\n    class FS,MEM,PROC system</code></pre>"},{"location":"dev-guide/architecture/#security-controls","title":"Security Controls","text":"<p>Input Security:</p> <ul> <li>XML parser security (XXE prevention)</li> <li>Path traversal protection</li> <li>File size limitations</li> <li>Content validation</li> </ul> <p>Processing Security:</p> <ul> <li>Memory safety (Go runtime)</li> <li>Type safety (static typing)</li> <li>Error handling (no panics)</li> <li>Resource limits</li> </ul> <p>Output Security:</p> <ul> <li>Path validation</li> <li>Permission checks</li> <li>Content sanitization</li> <li>Secure file creation</li> </ul>"},{"location":"dev-guide/architecture/#threat-model","title":"Threat Model","text":"<p>Threats Addressed:</p> <ul> <li>Malicious XML files</li> <li>Path traversal attacks</li> <li>Resource exhaustion</li> <li>Information disclosure</li> </ul> <p>Threats Not Addressed (by design):</p> <ul> <li>Network-based attacks (offline operation)</li> <li>Multi-user environments (single-user tool)</li> <li>Privilege escalation (user-level operation)</li> <li>Data exfiltration (local processing only)</li> </ul> <p>This architecture documentation provides a comprehensive overview of the opnDossier system design, emphasizing its offline-first, operator-focused approach while maintaining security and reliability for network infrastructure management tasks.</p>"},{"location":"dev-guide/authoritative_role_definitions/","title":"Authoritative Role Definitions","text":"<p>This document captures the single-sentence \"official\" purpose of each library used in the opnDossier project, compiled from <code>tasks.md</code> and <code>AGENTS.md</code>.</p>"},{"location":"dev-guide/authoritative_role_definitions/#library-role-definitions","title":"Library Role Definitions","text":""},{"location":"dev-guide/authoritative_role_definitions/#cobra","title":"Cobra","text":"<p>Purpose: Command structure &amp; argument parsing Introduced in: TASK-001 (Update Go dependencies to match requirements) Context: Use <code>cobra</code> for CLI command organization with consistent verb patterns (<code>create</code>, <code>list</code>, <code>get</code>, <code>update</code>, <code>delete</code>)</p>"},{"location":"dev-guide/authoritative_role_definitions/#fang-charmbraceletfang","title":"Fang (charmbracelet/fang)","text":"<p>Purpose: Enhanced UX layer on top of Cobra (styled help, version, completion) Introduced in: TASK-003a (Implement CLI enhancement with fang) Context: Add fang for enhanced CLI experience with styled help, errors, and automatic features including styled help/usage pages, styled error messages, automatic <code>--version</code> flag, hidden <code>man</code> command for manpage generation, <code>completion</code> command for shell completions, and themeable appearance</p>"},{"location":"dev-guide/authoritative_role_definitions/#viper-spf13viper","title":"Viper (spf13/viper)","text":"<p>Purpose: Layered configuration (files, env, flags) Introduced in: TASK-003 (Set up configuration management with viper) Context: Implement YAML config files, environment variables, CLI overrides using viper with standard precedence (CLI flags &gt; env vars &gt; config file &gt; defaults)</p>"},{"location":"dev-guide/authoritative_role_definitions/#charmbraceletlog","title":"charmbracelet/log","text":"<p>Purpose: Structured, leveled logging Introduced in: TASK-002 (Implement structured logging with <code>charmbracelet/log</code>) Context: Replace current <code>log</code> usage with structured logging throughout application using charmbracelet/log with proper levels (Debug, Info, Warn, Error)</p>"},{"location":"dev-guide/authoritative_role_definitions/#supporting-libraries","title":"Supporting Libraries","text":""},{"location":"dev-guide/authoritative_role_definitions/#charmbraceletlipgloss","title":"charmbracelet/lipgloss","text":"<p>Purpose: Styled terminal output formatting Introduced in: TASK-014 (Implement terminal display with lipgloss) Context: Create styled terminal output with colored, syntax-highlighted markdown</p>"},{"location":"dev-guide/authoritative_role_definitions/#charmbraceletglamour","title":"charmbracelet/glamour","text":"<p>Purpose: Markdown rendering in terminal Introduced in: TASK-016 (Implement markdown rendering with glamour) Context: Integrate glamour for markdown rendering in terminal with syntax highlighting</p>"},{"location":"dev-guide/authoritative_role_definitions/#task-reference-summary","title":"Task Reference Summary","text":"<ul> <li>TASK-001: Dependency management and technology stack setup</li> <li>TASK-002: Structured logging implementation</li> <li>TASK-003: Configuration management with viper</li> <li>TASK-003a: CLI enhancement with fang</li> </ul>"},{"location":"dev-guide/authoritative_role_definitions/#configuration-precedence","title":"Configuration Precedence","text":"<p>As established in TASK-003 and TASK-028, the configuration system follows standard precedence:</p> <ol> <li>CLI flags (highest precedence)</li> <li>Environment variables</li> <li>Configuration file</li> <li>Defaults (lowest precedence)</li> </ol>"},{"location":"dev-guide/authoritative_role_definitions/#cli-architecture-pattern","title":"CLI Architecture Pattern","text":"<p>The project implements a layered CLI architecture:</p> <ul> <li>Cobra: Foundation for command structure and argument parsing</li> <li>Fang: Enhancement layer providing styled UX, automatic features, and improved user experience</li> <li>Viper: Configuration layer managing settings from multiple sources</li> <li>charmbracelet/log: Logging layer providing structured, contextual logging throughout the application</li> </ul>"},{"location":"dev-guide/contributing/","title":"Contributing Guide","text":"<p>Thank you for your interest in contributing to the OPNsense Configuration Processor! This guide will help you get started with development and understand our contribution process.</p>"},{"location":"dev-guide/contributing/#development-environment-setup","title":"Development Environment Setup","text":""},{"location":"dev-guide/contributing/#prerequisites","title":"Prerequisites","text":"<ul> <li>Go 1.21 or later</li> <li>Git</li> <li>golangci-lint - Go linter (latest version recommended)</li> <li>MkDocs - Documentation generator (latest version recommended)</li> <li>Just (command runner) - optional but recommended</li> </ul>"},{"location":"dev-guide/contributing/#getting-started","title":"Getting Started","text":"<ol> <li> <p>Fork the repository on GitHub</p> </li> <li> <p>Clone your fork locally:</p> </li> </ol> <pre><code>git clone https://github.com/yourusername/opnDossier.git\ncd opnDossier\n</code></pre> <ol> <li>Install dependencies:</li> </ol> <pre><code>go mod download\n</code></pre> <ol> <li>Run tests to ensure everything works:</li> </ol> <pre><code>go test ./...\n</code></pre>"},{"location":"dev-guide/contributing/#development-workflow","title":"Development Workflow","text":""},{"location":"dev-guide/contributing/#code-organization","title":"Code Organization","text":"<p>The project follows standard Go conventions:</p> <ul> <li><code>cmd/</code> - CLI commands and main entry points</li> <li><code>internal/</code> - Internal packages not exported to external users</li> <li><code>config/</code> - Configuration management and validation</li> <li><code>parser/</code> - XML parsing and streaming logic</li> <li><code>model/</code> - Data structures representing OPNsense configuration</li> <li><code>docs/</code> - Documentation (MkDocs format)</li> <li><code>testdata/</code> - Test fixtures and sample files</li> </ul>"},{"location":"dev-guide/contributing/#making-changes","title":"Making Changes","text":"<ol> <li>Create a feature branch:</li> </ol> <pre><code>git checkout -b feature/your-feature-name\n</code></pre> <ol> <li> <p>Make your changes following our development standards</p> </li> <li> <p>Add tests for new functionality:</p> </li> </ol> <pre><code>go test ./... -v\n</code></pre> <ol> <li>Run benchmarks if modifying parser performance:</li> </ol> <pre><code>go test -run=^$ -bench=. ./internal/parser/\n</code></pre> <ol> <li>Run linting:</li> </ol> <pre><code>golangci-lint run\n</code></pre>"},{"location":"dev-guide/contributing/#validation-development","title":"Validation Development","text":"<p>When working on configuration validation:</p> <ul> <li>Follow the patterns established in <code>internal/config/validator.go</code></li> <li>Add comprehensive test cases covering both valid and invalid inputs</li> <li>Use the <code>ValidationError</code> type for reporting validation issues</li> <li>Include field paths and descriptive error messages</li> <li>See Validator Patterns for detailed guidance</li> </ul>"},{"location":"dev-guide/contributing/#parser-development","title":"Parser Development","text":"<p>When modifying XML parsing logic:</p> <ul> <li>Maintain streaming behavior to handle large files efficiently</li> <li>Ensure memory usage remains constant (O(1)) as file size increases</li> <li>Add benchmarks for performance-critical changes</li> <li>Test with both small sample files and large generated XML</li> <li>Preserve backward compatibility in the <code>Parser</code> interface</li> </ul>"},{"location":"dev-guide/contributing/#testing","title":"Testing","text":"<p>We maintain several types of tests:</p> <ul> <li>Unit tests: Test individual functions and methods</li> <li>Integration tests: Test complete workflows end-to-end</li> <li>Validation tests: Comprehensive coverage of validation rules</li> <li>Performance tests: Benchmarks for parser memory and speed</li> <li>Error handling tests: Verify proper error reporting</li> </ul> <p>Run specific test suites:</p> <pre><code># All tests\ngo test ./...\n\n# Specific package\ngo test ./internal/config/\n\n# Benchmarks only\ngo test -run=^$ -bench=. ./internal/parser/\n\n# With coverage\ngo test -cover ./...\n</code></pre>"},{"location":"dev-guide/contributing/#pull-request-process","title":"Pull Request Process","text":"<ol> <li> <p>Before submitting:</p> </li> <li> <p>Ensure all tests pass</p> </li> <li>Run linting tools</li> <li>Update documentation if needed</li> <li> <p>Add changelog entry if appropriate</p> </li> <li> <p>PR Description:</p> </li> <li> <p>Clearly describe what changes were made</p> </li> <li>Reference any related issues</li> <li>Include examples of new functionality</li> <li> <p>Note any breaking changes</p> </li> <li> <p>Review process:</p> </li> <li> <p>All PRs require at least one review</p> </li> <li>CI must pass (tests, linting, benchmarks)</li> <li>Documentation updates may be requested</li> </ol>"},{"location":"dev-guide/contributing/#coding-standards","title":"Coding Standards","text":"<p>Please follow our Development Standards which cover:</p> <ul> <li>Go coding conventions</li> <li>Error handling patterns</li> <li>Validation architecture</li> <li>Testing practices</li> <li>Performance guidelines</li> </ul>"},{"location":"dev-guide/contributing/#documentation","title":"Documentation","text":"<ul> <li>Update relevant documentation for user-facing changes</li> <li>Add inline comments for complex logic</li> <li>Update API documentation for interface changes</li> <li>Follow MkDocs formatting for documentation updates</li> </ul>"},{"location":"dev-guide/contributing/#performance-considerations","title":"Performance Considerations","text":"<p>This project processes potentially large XML files, so performance matters:</p> <ul> <li>Profile memory usage for parser changes</li> <li>Maintain streaming behavior rather than loading entire files</li> <li>Add benchmarks for significant algorithmic changes</li> <li>Consider memory allocation patterns</li> </ul>"},{"location":"dev-guide/contributing/#getting-help","title":"Getting Help","text":"<ul> <li>Check existing issues and documentation first</li> <li>Open an issue for bugs or feature requests</li> <li>Ask questions in GitHub discussions</li> <li>Review the development standards and architecture documentation</li> </ul>"},{"location":"dev-guide/contributing/#license","title":"License","text":"<p>By contributing, you agree that your contributions will be licensed under the same license as the project.</p> <p>Thank you for contributing to making OPNsense configuration processing better!</p>"},{"location":"dev-guide/plugin-development/","title":"Plugin Development Guide","text":""},{"location":"dev-guide/plugin-development/#overview","title":"Overview","text":"<p>opnDossier uses a plugin-based architecture for compliance standards, allowing developers to create custom compliance plugins that integrate seamlessly with the core audit engine. Plugins can be either statically registered (baked into the binary) or dynamically loaded at runtime as Go plugins (<code>.so</code> files). This guide explains how to create, implement, and integrate new compliance plugins.</p>"},{"location":"dev-guide/plugin-development/#plugin-architecture","title":"Plugin Architecture","text":""},{"location":"dev-guide/plugin-development/#core-components","title":"Core Components","text":"<ul> <li><code>CompliancePlugin</code> Interface: Defines the contract that all plugins must implement</li> <li><code>PluginRegistry</code>: Manages plugin registration, dynamic loading, and lifecycle</li> <li><code>PluginManager</code>: Coordinates plugin operations and provides high-level APIs</li> <li><code>Control</code> Struct: Represents individual compliance controls within a standard</li> </ul>"},{"location":"dev-guide/plugin-development/#plugin-interface","title":"Plugin Interface","text":"<p>All plugins must implement the <code>CompliancePlugin</code> interface:</p> <pre><code>import \"github.com/EvilBit-Labs/opnDossier/internal/plugin\"\n\ntype CompliancePlugin interface {\n    Name() string                    // Unique plugin identifier\n    Version() string                 // Plugin version\n    Description() string             // Human-readable description\n    RunChecks(config *model.OpnSenseDocument) []plugin.Finding // Execute compliance checks\n    GetControls() []plugin.Control   // Return all controls\n    GetControlByID(id string) (*plugin.Control, error) // Get specific control\n    ValidateConfiguration() error    // Validate plugin config\n}\n</code></pre> <p>The <code>Finding</code> struct is generic and uses <code>References</code>, <code>Tags</code>, and <code>Metadata</code> fields:</p> <pre><code>// plugin.Finding\nType        string              // e.g. \"compliance\"\nTitle       string\nDescription string\nRecommendation string\nComponent   string\nReference   string\nReferences  []string            // Control IDs or external references\nTags        []string            // Arbitrary tags for filtering/categorization\nMetadata    map[string]string   // Optional extra data\n</code></pre>"},{"location":"dev-guide/plugin-development/#creating-a-new-plugin","title":"Creating a New Plugin","text":""},{"location":"dev-guide/plugin-development/#step-1-plugin-structure","title":"Step 1: Plugin Structure","text":"<p>For static plugins, create a new directory in <code>internal/plugins/</code>:</p> <pre><code>internal/plugins/\n\u251c\u2500\u2500 stig/\n\u2502   \u2514\u2500\u2500 stig.go\n\u251c\u2500\u2500 sans/\n\u2502   \u2514\u2500\u2500 sans.go\n\u251c\u2500\u2500 firewall/\n\u2502   \u2514\u2500\u2500 firewall.go\n\u2514\u2500\u2500 your_plugin/\n    \u2514\u2500\u2500 your_plugin.go\n</code></pre> <p>For dynamic plugins, create a new Go module or directory with a <code>main</code> package.</p>"},{"location":"dev-guide/plugin-development/#step-2-plugin-implementation","title":"Step 2: Plugin Implementation","text":""},{"location":"dev-guide/plugin-development/#static-plugin-example","title":"Static Plugin Example","text":"<pre><code>package plugins\n\nimport (\n    \"fmt\"\n    \"github.com/EvilBit-Labs/opnDossier/internal/plugin\"\n    \"github.com/EvilBit-Labs/opnDossier/internal/model\"\n)\n\ntype CustomPlugin struct {\n    controls []plugin.Control\n}\n\nfunc NewCustomPlugin() *CustomPlugin {\n    return &amp;CustomPlugin{\n        controls: []plugin.Control{\n            {\n                ID:          \"CUSTOM-001\",\n                Title:       \"Custom Security Control\",\n                Description: \"Description of the custom security control\",\n                Category:    \"Security\",\n                Severity:    \"high\",\n                Rationale:   \"Why this control is important\",\n                Remediation: \"How to fix compliance issues\",\n                Tags:        []string{\"custom\", \"security\", \"compliance\"},\n            },\n        },\n    }\n}\n\nfunc (cp *CustomPlugin) Name() string        { return \"custom\" }\nfunc (cp *CustomPlugin) Version() string     { return \"1.0.0\" }\nfunc (cp *CustomPlugin) Description() string { return \"Custom compliance checks for specific security requirements\" }\nfunc (cp *CustomPlugin) GetControls() []plugin.Control { return cp.controls }\nfunc (cp *CustomPlugin) GetControlByID(id string) (*plugin.Control, error) {\n    for _, control := range cp.controls {\n        if control.ID == id {\n            return &amp;control, nil\n        }\n    }\n    return nil, fmt.Errorf(\"control '%s' not found\", id)\n}\nfunc (cp *CustomPlugin) ValidateConfiguration() error {\n    if len(cp.controls) == 0 {\n        return fmt.Errorf(\"no controls defined\")\n    }\n    return nil\n}\nfunc (cp *CustomPlugin) RunChecks(config *model.OpnSenseDocument) []plugin.Finding {\n    var findings []plugin.Finding\n    // Implement your compliance checks here\n    // Example:\n    findings = append(findings, plugin.Finding{\n        Type:           \"compliance\",\n        Title:          \"Missing Custom Security Feature\",\n        Description:    \"The configuration is missing required custom security feature\",\n        Recommendation: \"Enable the custom security feature in the configuration\",\n        Component:      \"security\",\n        Reference:      \"CUSTOM-001\",\n        References:     []string{\"CUSTOM-001\"},\n        Tags:           []string{\"custom\", \"security\", \"compliance\"},\n    })\n    return findings\n}\n</code></pre>"},{"location":"dev-guide/plugin-development/#dynamic-plugin-example","title":"Dynamic Plugin Example","text":"<pre><code>package main\n\nimport (\n    \"github.com/EvilBit-Labs/opnDossier/internal/plugin\"\n    \"github.com/EvilBit-Labs/opnDossier/internal/model\"\n)\n\ntype MyDynamicPlugin struct{}\n\n// Implement CompliancePlugin methods...\n\nvar Plugin plugin.CompliancePlugin = &amp;MyDynamicPlugin{}\n</code></pre> <p>Build with:</p> <pre><code>go build -buildmode=plugin -o myplugin.so main.go\n</code></pre>"},{"location":"dev-guide/plugin-development/#step-3-plugin-registration","title":"Step 3: Plugin Registration","text":"<ul> <li>Static plugins: Register in the plugin manager as before.</li> <li>Dynamic plugins: Drop <code>.so</code> files into the plugin directory (default: <code>./plugins</code>). They will be loaded automatically at startup.</li> </ul>"},{"location":"dev-guide/plugin-development/#dynamic-plugin-loading","title":"Dynamic Plugin Loading","text":"<ul> <li>The audit engine will scan a configurable directory for <code>.so</code> files and load any plugin that exports <code>var Plugin plugin.CompliancePlugin</code>.</li> <li>Dynamic plugins must be built with the same Go version and dependencies as the main binary.</li> <li>Both static and dynamic plugins are supported and can coexist.</li> </ul>"},{"location":"dev-guide/plugin-development/#plugin-development-best-practices","title":"Plugin Development Best Practices","text":"<ul> <li>Use unique, descriptive control IDs and titles.</li> <li>Provide actionable remediation and clear rationale.</li> <li>Use the <code>References</code> and <code>Tags</code> fields for all findings.</li> <li>Write comprehensive tests for your plugin.</li> <li>Document your controls and plugin usage.</li> </ul>"},{"location":"dev-guide/plugin-development/#troubleshooting","title":"Troubleshooting","text":"<ul> <li>Plugin not loaded? Ensure it is built as a Go plugin (<code>-buildmode=plugin</code>), exports <code>var Plugin</code>, and is in the correct directory.</li> <li>Go version mismatch? All plugins and the main binary must be built with the exact same Go version and dependencies.</li> <li>Platform support: Go plugins are supported on Linux and macOS, not Windows.</li> </ul>"},{"location":"dev-guide/plugin-development/#examples","title":"Examples","text":"<ul> <li>See <code>internal/plugins/</code> for static plugin examples.</li> <li>See the above dynamic plugin example for external plugins.</li> </ul>"},{"location":"dev-guide/plugin-development/#conclusion","title":"Conclusion","text":"<p>The opnDossier plugin system is flexible: you can extend compliance coverage by adding new plugins statically or dynamically, with a simple, generic interface and robust integration with the audit engine.</p>"},{"location":"development/architecture/","title":"opnDossier System Architecture","text":""},{"location":"development/architecture/#overview","title":"Overview","text":"<p>opnDossier is a CLI-based OPNsense configuration processor designed with an offline-first, operator-focused architecture. The system transforms complex XML configuration files into human-readable markdown documentation, following security-first principles and air-gap compatibility.</p> <p></p>"},{"location":"development/architecture/#high-level-architecture","title":"High-Level Architecture","text":""},{"location":"development/architecture/#core-design-principles","title":"Core Design Principles","text":"<ol> <li>Offline-First: Zero external dependencies, complete air-gap compatibility</li> <li>Operator-Focused: Built for network administrators and operators</li> <li>Framework-First: Leverages established Go libraries (Cobra, Charm ecosystem)</li> <li>Structured Data: Maintains configuration hierarchy and relationships</li> <li>Security-First: No telemetry, input validation, secure processing</li> </ol>"},{"location":"development/architecture/#architecture-pattern","title":"Architecture Pattern","text":"<ul> <li>Monolithic CLI Application with clear separation of concerns</li> <li>Single Binary Distribution for easy deployment</li> <li>Local Processing Only - no external network calls</li> <li>Streaming Data Pipeline from XML input to various output formats</li> </ul>"},{"location":"development/architecture/#technology-stack","title":"Technology Stack","text":"<p>Built with modern Go practices and established libraries:</p> Component Technology CLI Framework Cobra Configuration Viper CLI Enhancement Charm Fang Terminal Styling Charm Lipgloss Markdown Rendering Charm Glamour XML Processing Go's built-in <code>encoding/xml</code> Structured Logging Charm Log <p>The CLI uses a layered architecture: Cobra provides command structure and argument parsing, Viper handles layered configuration management (files, env, flags), and Fang adds enhanced UX features like styled help, automatic version flags, and shell completion.</p>"},{"location":"development/architecture/#services-and-components","title":"Services and Components","text":""},{"location":"development/architecture/#1-cli-interface-layer","title":"1. CLI Interface Layer","text":"<ul> <li>Framework: Cobra CLI</li> <li>Responsibility: Command parsing, user interaction, error handling</li> <li>Key Files: <code>cmd/root.go</code>, <code>cmd/opnsense.go</code></li> </ul>"},{"location":"development/architecture/#2-configuration-management","title":"2. Configuration Management","text":"<ul> <li>Framework: spf13/viper</li> <li>Sources: CLI flags &gt; Environment variables &gt; Config file &gt; Defaults</li> <li>Format: YAML configuration files</li> <li>Precedence: Standard order where environment variables override config files for deployment flexibility</li> </ul>"},{"location":"development/architecture/#3-data-processing-engine","title":"3. Data Processing Engine","text":""},{"location":"development/architecture/#xml-parser-component","title":"XML Parser Component","text":"<ul> <li>Technology: Go's built-in <code>encoding/xml</code></li> <li>Input: OPNsense config.xml files</li> <li>Output: Structured Go data types</li> <li>Features: Schema validation, error reporting</li> </ul>"},{"location":"development/architecture/#data-converter-component","title":"Data Converter Component","text":"<ul> <li>Input: Parsed XML structures</li> <li>Output: Markdown content</li> <li>Features: Hierarchy preservation, metadata injection</li> </ul>"},{"location":"development/architecture/#output-renderer-component","title":"Output Renderer Component","text":"<ul> <li>Formats: Terminal display, Markdown files, JSON (planned)</li> <li>Technologies: Charm Lipgloss (styling) + Charm Glamour (rendering)</li> </ul>"},{"location":"development/architecture/#4-output-systems","title":"4. Output Systems","text":"<ul> <li>Terminal Display: Syntax-highlighted, styled terminal output</li> <li>File Export: Markdown file generation with metadata</li> <li>Future: HTML, JSON, and other structured formats</li> </ul>"},{"location":"development/architecture/#data-model-architecture","title":"Data Model Architecture","text":"<p>opnDossier uses a hierarchical model structure that mirrors the OPNsense XML configuration while organizing functionality into logical domains:</p> <pre><code>graph TB\n    subgraph \"Root Configuration\"\n        ROOT[Opnsense Root]\n        META[Metadata &amp; Global Settings]\n    end\n\n    subgraph \"System Domain\"\n        SYS[System Configuration]\n        USERS[User Management]\n        GROUPS[Group Management]\n        SYSCFG[System Services Config]\n    end\n\n    subgraph \"Network Domain\"\n        NET[Network Configuration]\n        IFACES[Interface Management]\n        ROUTING[Routing &amp; Gateways]\n        VLAN[VLAN Configuration]\n    end\n\n    subgraph \"Security Domain\"\n        SEC[Security Configuration]\n        FIREWALL[Firewall Rules]\n        NAT[NAT Configuration]\n        VPN[VPN Services]\n        CERTS[Certificate Management]\n    end\n\n    subgraph \"Services Domain\"\n        SVC[Services Configuration]\n        DNS[DNS Services]\n        DHCP[DHCP Services]\n        MONITOR[Monitoring Services]\n        WEB[Web Services]\n    end\n\n    ROOT --&gt; META\n    ROOT --&gt; SYS\n    ROOT --&gt; NET\n    ROOT --&gt; SEC\n    ROOT --&gt; SVC\n\n    SYS --&gt; USERS\n    SYS --&gt; GROUPS\n    SYS --&gt; SYSCFG\n\n    NET --&gt; IFACES\n    NET --&gt; ROUTING\n    NET --&gt; VLAN\n\n    SEC --&gt; FIREWALL\n    SEC --&gt; NAT\n    SEC --&gt; VPN\n    SEC --&gt; CERTS\n\n    SVC --&gt; DNS\n    SVC --&gt; DHCP\n    SVC --&gt; MONITOR\n    SVC --&gt; WEB</code></pre> <p>This hierarchical structure provides:</p> <ul> <li>Logical Organization: Related configuration grouped by functional domain</li> <li>Maintainability: Easier to locate and modify specific configuration types</li> <li>Extensibility: New features can be added to appropriate domains</li> <li>Validation: Domain-specific validation rules improve data integrity</li> <li>API Evolution: JSON tags enable better REST API integration</li> </ul>"},{"location":"development/architecture/#data-flow-architecture","title":"Data Flow Architecture","text":"<pre><code>sequenceDiagram\n    participant User\n    participant CLI\n    participant ConfigMgr as Config Manager\n    participant Parser as XML Parser\n    participant Converter\n    participant Renderer\n    participant Output\n\n    User-&gt;&gt;CLI: opndossier convert config.xml\n    CLI-&gt;&gt;ConfigMgr: Load configuration\n    ConfigMgr--&gt;&gt;CLI: Configuration object\n    CLI-&gt;&gt;Parser: Parse XML file\n\n    alt Valid XML\n        Parser-&gt;&gt;Parser: Validate structure\n        Parser--&gt;&gt;CLI: Structured data\n        CLI-&gt;&gt;Converter: Transform data\n        Converter--&gt;&gt;CLI: Markdown content\n        CLI-&gt;&gt;Renderer: Format output\n\n        alt Terminal display\n            Renderer-&gt;&gt;Output: Styled terminal\n            Output--&gt;&gt;User: Visual output\n        else File export\n            Renderer-&gt;&gt;Output: Write file\n            Output--&gt;&gt;User: Confirmation\n        end\n    else Invalid XML\n        Parser--&gt;&gt;CLI: Error details\n        CLI--&gt;&gt;User: Error message\n    end</code></pre>"},{"location":"development/architecture/#programmatic-generation-architecture-v20","title":"Programmatic Generation Architecture (v2.0+)","text":""},{"location":"development/architecture/#evolution-from-template-based-to-programmatic-generation","title":"Evolution from Template-Based to Programmatic Generation","text":"<p>opnDossier v2.0 introduces a major architectural shift from template-based markdown generation to programmatic generation, delivering significant performance improvements and enhanced developer experience.</p>"},{"location":"development/architecture/#previous-architecture-v1x","title":"Previous Architecture (v1.x)","text":"<pre><code>sequenceDiagram\n    participant User\n    participant CLI\n    participant Parser as XML Parser\n    participant TmplEngine as Template Engine\n    participant TmplFiles as Template Files\n    participant Renderer\n    participant Output\n\n    User-&gt;&gt;CLI: opndossier convert config.xml\n    CLI-&gt;&gt;Parser: Parse XML file\n    Parser--&gt;&gt;CLI: Structured data\n    CLI-&gt;&gt;TmplEngine: Load templates\n    TmplEngine-&gt;&gt;TmplFiles: Read template files\n    TmplFiles--&gt;&gt;TmplEngine: Template content\n    TmplEngine-&gt;&gt;TmplEngine: Parse templates\n    TmplEngine-&gt;&gt;TmplEngine: Execute with data\n    TmplEngine--&gt;&gt;CLI: Rendered content\n    CLI-&gt;&gt;Renderer: Format output\n    Renderer-&gt;&gt;Output: Final markdown\n    Output--&gt;&gt;User: Generated report</code></pre>"},{"location":"development/architecture/#new-architecture-v20","title":"New Architecture (v2.0+)","text":"<pre><code>sequenceDiagram\n    participant User\n    participant CLI\n    participant Parser as XML Parser\n    participant Builder as MarkdownBuilder\n    participant Methods as Go Methods\n    participant Renderer\n    participant Output\n\n    User-&gt;&gt;CLI: opndossier convert config.xml\n    CLI-&gt;&gt;Parser: Parse XML file\n    Parser--&gt;&gt;CLI: Structured data\n    CLI-&gt;&gt;Builder: Create builder instance\n    Builder-&gt;&gt;Methods: Direct method calls\n    Methods-&gt;&gt;Methods: Type-safe operations\n    Methods--&gt;&gt;Builder: Structured content\n    Builder-&gt;&gt;Renderer: Optimized string building\n    Renderer-&gt;&gt;Output: Final markdown\n    Output--&gt;&gt;User: Generated report</code></pre>"},{"location":"development/architecture/#key-architectural-improvements","title":"Key Architectural Improvements","text":""},{"location":"development/architecture/#1-elimination-of-template-overhead","title":"1. Elimination of Template Overhead","text":"<ul> <li>Before: Parse templates \u2192 String interpolation \u2192 Variable resolution \u2192 Output generation</li> <li>After: Direct method calls \u2192 Structured building \u2192 Optimized output</li> </ul>"},{"location":"development/architecture/#2-performance-optimizations","title":"2. Performance Optimizations","text":"<p>The programmatic approach is designed for significant performance improvements:</p> <ul> <li>Memory Usage: Reduced allocations through direct string building</li> <li>Generation Speed: Faster generation via method-based approach</li> <li>Throughput: Increased reports per second</li> <li>Scalability: Consistent performance across all dataset sizes</li> </ul> <p>Actual performance can be measured using comparative benchmarks in <code>internal/converter/markdown_bench_test.go</code>.</p>"},{"location":"development/architecture/#3-enhanced-type-safety","title":"3. Enhanced Type Safety","text":"<pre><code>graph TB\n    subgraph \"Template Mode (v1.x)\"\n        T1[Template String] --&gt; T2[Runtime Parsing]\n        T2 --&gt; T3[Variable Resolution]\n        T3 --&gt; T4[Silent Failures]\n        T4 --&gt; T5[Runtime Errors]\n    end\n\n    subgraph \"Programmatic Mode (v2.0+)\"\n        P1[Go Methods] --&gt; P2[Compile-time Validation]\n        P2 --&gt; P3[Type-safe Operations]\n        P3 --&gt; P4[Explicit Error Handling]\n        P4 --&gt; P5[Structured Results]\n    end\n\n    style T4 fill:#ff9999\n    style T5 fill:#ff9999\n    style P2 fill:#99ff99\n    style P3 fill:#99ff99\n    style P4 fill:#99ff99</code></pre>"},{"location":"development/architecture/#4-security-enhancements-red-team-focus","title":"4. Security Enhancements (Red Team Focus)","text":"<ul> <li>Output Obfuscation: Built-in capabilities for sensitive data handling</li> <li>Complete Offline Support: No external template dependencies</li> <li>Memory Safety: Improved handling of large configurations</li> <li>Error Isolation: Structured error handling prevents information leakage</li> </ul>"},{"location":"development/architecture/#markdownbuilder-component-architecture","title":"MarkdownBuilder Component Architecture","text":"<pre><code>classDiagram\n    class ReportBuilder {\n        &lt;&lt;interface&gt;&gt;\n        +BuildStandardReport(data) string\n        +BuildCustomReport(data, options) string\n        +BuildSystemSection(data) string\n        +BuildNetworkSection(data) string\n        +BuildSecuritySection(data) string\n        +BuildServicesSection(data) string\n    }\n\n    class MarkdownBuilder {\n        -config *OpnSenseDocument\n        -options BuildOptions\n        -logger *Logger\n        +CalculateSecurityScore(data) int\n        +AssessRiskLevel(severity) string\n        +FilterSystemTunables(tunables, filter) []SysctlItem\n        +GroupServicesByStatus(services) map[string][]Service\n        +FormatInterfaceLinks(interfaces) string\n        +EscapeMarkdownSpecialChars(input) string\n    }\n\n    class SecurityAssessor {\n        +CalculateSecurityScore(data) int\n        +AssessRiskLevel(severity) string\n        +AssessServiceRisk(service) string\n        +DetermineSecurityZone(interface) string\n    }\n\n    class DataTransformer {\n        +FilterSystemTunables(tunables, filter) []SysctlItem\n        +GroupServicesByStatus(services) map[string][]Service\n        +FormatSystemStats(data) map[string]interface{}\n    }\n\n    class StringFormatter {\n        +EscapeMarkdownSpecialChars(input) string\n        +FormatTimestamp(timestamp) string\n        +TruncateDescription(text, length) string\n        +FormatBoolean(value) string\n    }\n\n    ReportBuilder &lt;|.. MarkdownBuilder\n    MarkdownBuilder o-- SecurityAssessor\n    MarkdownBuilder o-- DataTransformer\n    MarkdownBuilder o-- StringFormatter</code></pre>"},{"location":"development/architecture/#data-flow-pipeline-programmatic-mode","title":"Data Flow Pipeline (Programmatic Mode)","text":"<pre><code>graph TD\n    subgraph \"Input Processing\"\n        XML[OPNsense XML] --&gt; Parser[Enhanced Parser]\n        Parser --&gt; Model[Structured Model]\n    end\n\n    subgraph \"Programmatic Generation Engine\"\n        Model --&gt; Builder[MarkdownBuilder]\n        Builder --&gt; Security[SecurityAssessor]\n        Builder --&gt; Transform[DataTransformer]\n        Builder --&gt; Format[StringFormatter]\n\n        Security --&gt; Methods[Method-Based Generation]\n        Transform --&gt; Methods\n        Format --&gt; Methods\n    end\n\n    subgraph \"Output Optimization\"\n        Methods --&gt; StringBuild[Optimized String Building]\n        StringBuild --&gt; Render[Direct Rendering]\n        Render --&gt; Output[Markdown Output]\n    end\n\n    subgraph \"Performance Characteristics\"\n        Metrics[Performance Metrics&lt;br/&gt;\u2022 Faster generation&lt;br/&gt;\u2022 Reduced memory&lt;br/&gt;\u2022 Increased throughput&lt;br/&gt;\u2022 Type-safe operations]\n    end\n\n    Output -.-&gt; Metrics\n\n    style Builder fill:#99ff99,stroke:#333,stroke-width:4px\n    style Methods fill:#99ff99,stroke:#333,stroke-width:2px\n    style StringBuild fill:#99ff99,stroke:#333,stroke-width:2px</code></pre>"},{"location":"development/architecture/#hybrid-architecture-support","title":"Hybrid Architecture Support","text":"<p>To ensure smooth migration, v2.0 supports both template and programmatic modes:</p> <pre><code>graph TB\n    subgraph \"Hybrid Architecture\"\n        Input[User Input] --&gt; Decision{Generation Mode?}\n\n        Decision --&gt;|--use-template| TemplatePath[Template Mode]\n        Decision --&gt;|Default| ProgPath[Programmatic Mode]\n\n        TemplatePath --&gt; TemplateEngine[Template Engine]\n        ProgPath --&gt; MarkdownBuilder[MarkdownBuilder]\n\n        TemplateEngine --&gt; Output[Markdown Output]\n        MarkdownBuilder --&gt; Output\n    end\n\n    subgraph \"Migration Support\"\n        Compare[Output Comparison]\n        Validate[Validation Engine]\n        Fallback[Fallback Mechanism]\n    end\n\n    Output --&gt; Compare\n    Compare --&gt; Validate\n    Validate --&gt; Fallback\n\n    style ProgPath fill:#99ff99,stroke:#333,stroke-width:2px\n    style MarkdownBuilder fill:#99ff99,stroke:#333,stroke-width:2px</code></pre>"},{"location":"development/architecture/#method-categories-and-performance","title":"Method Categories and Performance","text":""},{"location":"development/architecture/#security-assessment-methods","title":"Security Assessment Methods","text":"<ul> <li>CalculateSecurityScore: 1.59M operations/sec</li> <li>AssessRiskLevel: 92M operations/sec</li> <li>AssessServiceRisk: High-frequency assessment capability</li> </ul>"},{"location":"development/architecture/#data-transformation-methods","title":"Data Transformation Methods","text":"<ul> <li>FilterSystemTunables: 797K operations/sec</li> <li>GroupServicesByStatus: 1.01M operations/sec</li> <li>FormatSystemStats: Optimized for large datasets</li> </ul>"},{"location":"development/architecture/#string-utility-methods","title":"String Utility Methods","text":"<ul> <li>EscapeMarkdownSpecialChars: Ultra-fast character processing</li> <li>FormatTimestamp: Efficient time formatting</li> <li>TruncateDescription: Word-boundary aware truncation</li> </ul>"},{"location":"development/architecture/#section-builders","title":"Section Builders","text":"<ul> <li>BuildSystemSection: 1.7K operations/sec (comprehensive sections)</li> <li>BuildNetworkSection: 6.7K operations/sec</li> <li>BuildSecuritySection: 5.1K operations/sec</li> <li>BuildServicesSection: 13K operations/sec</li> </ul>"},{"location":"development/architecture/#memory-management-architecture","title":"Memory Management Architecture","text":"<pre><code>graph LR\n    subgraph \"Template Mode (v1.x)\"\n        T1[Template Files] --&gt; T2[Template Parsing]\n        T2 --&gt; T3[Variable Context]\n        T3 --&gt; T4[String Interpolation]\n        T4 --&gt; T5[8.80MB Memory]\n        T5 --&gt; T6[93,984 Allocations]\n    end\n\n    subgraph \"Programmatic Mode (v2.0+)\"\n        P1[Direct Methods] --&gt; P2[Structured Building]\n        P2 --&gt; P3[Pre-allocated Buffers]\n        P3 --&gt; P4[Optimized Strings]\n        P4 --&gt; P5[1.97MB Memory]\n        P5 --&gt; P6[39,585 Allocations]\n    end\n\n    style T5 fill:#ff9999\n    style T6 fill:#ff9999\n    style P5 fill:#99ff99\n    style P6 fill:#99ff99</code></pre>"},{"location":"development/architecture/#error-handling-architecture","title":"Error Handling Architecture","text":""},{"location":"development/architecture/#template-mode-error-handling","title":"Template Mode Error Handling","text":"<ul> <li>Silent failures with default values</li> <li>Runtime template parsing errors</li> <li>Difficult debugging and troubleshooting</li> <li>Generic error messages</li> </ul>"},{"location":"development/architecture/#programmatic-mode-error-handling","title":"Programmatic Mode Error Handling","text":"<pre><code>// Structured error types\ntype ValidationError struct {\n    Field   string\n    Value   any\n    Message string\n}\n\ntype GenerationError struct {\n    Component string\n    Operation string\n    Cause     error\n}\n\n// Context-aware error handling\nfunc (b *MarkdownBuilder) BuildSection(data *model.OpnSenseDocument) (string, error) {\n    if err := b.validateInput(data); err != nil {\n        return \"\", &amp;ValidationError{\n            Field:   \"input_data\",\n            Value:   data,\n            Message: fmt.Sprintf(\"invalid input: %v\", err),\n        }\n    }\n\n    result, err := b.generateContent(data)\n    if err != nil {\n        return \"\", &amp;GenerationError{\n            Component: \"section_builder\",\n            Operation: \"content_generation\",\n            Cause:     err,\n        }\n    }\n\n    return result, nil\n}\n</code></pre>"},{"location":"development/architecture/#data-storage-strategy","title":"Data Storage Strategy","text":""},{"location":"development/architecture/#local-file-system","title":"Local File System","text":"<ul> <li>Configuration: <code>~/.opnDossier.yaml</code> (user preferences)</li> <li>Input: OPNsense XML files (any location)</li> <li>Output: Markdown files (user-specified or current directory)</li> </ul>"},{"location":"development/architecture/#memory-management","title":"Memory Management","text":"<ul> <li>Structured Data: Go structs with XML/JSON tags</li> <li>Large Files: Streaming processing for memory efficiency</li> <li>Type Safety: Strong typing throughout the pipeline</li> </ul>"},{"location":"development/architecture/#no-persistent-storage","title":"No Persistent Storage","text":"<ul> <li>Stateless Operation: Each run is independent</li> <li>No Database: All data flows through memory</li> <li>Temporary Files: Cleaned up automatically</li> </ul>"},{"location":"development/architecture/#external-integrations","title":"External Integrations","text":""},{"location":"development/architecture/#documentation-system","title":"Documentation System","text":"<ul> <li>Technology: MkDocs with Material theme</li> <li>Purpose: Static documentation generation</li> <li>Deployment: Local development server, no runtime dependencies</li> </ul>"},{"location":"development/architecture/#package-distribution","title":"Package Distribution","text":"<ul> <li>Build System: GoReleaser for multi-platform builds</li> <li>Platforms: Linux, macOS, Windows (amd64, arm64)</li> <li>Distribution: GitHub Releases, package managers, direct download</li> <li>Formats: Binary archives, system packages (deb, rpm, apk)</li> </ul>"},{"location":"development/architecture/#development-integration","title":"Development Integration","text":"<ul> <li>CI/CD: GitHub Actions</li> <li>Quality: golangci-lint, pre-commit hooks</li> <li>Testing: Go's built-in testing framework</li> <li>Task Runner: Just for development workflows</li> </ul>"},{"location":"development/architecture/#air-gapoffline-considerations","title":"Air-Gap/Offline Considerations","text":""},{"location":"development/architecture/#design-for-isolation","title":"Design for Isolation","text":"<pre><code>graph LR\n    subgraph \"Air-Gapped Environment\"\n        subgraph \"Secure Network\"\n            FW[OPNsense Firewall]\n            OPS[Operator Workstation]\n            DOCS[Documentation Server]\n        end\n\n        subgraph \"opnDossier Application\"\n            BIN[Single Binary]\n            CFG[Local Config]\n            TEMP[Templates]\n        end\n    end\n\n    FW --&gt;|config.xml| OPS\n    OPS --&gt;|Executes| BIN\n    BIN --&gt;|Uses| CFG\n    BIN --&gt;|Uses| TEMP\n    BIN --&gt;|Generates| DOCS</code></pre>"},{"location":"development/architecture/#offline-capabilities","title":"Offline Capabilities","text":"<ol> <li>Zero External Dependencies: All libraries embedded in binary</li> <li>No Network Calls: Completely self-contained operation</li> <li>Portable Deployment: Single binary, no installation required</li> <li>Data Exchange: File-based import/export only</li> </ol>"},{"location":"development/architecture/#data-exchange-patterns","title":"Data Exchange Patterns","text":"<ul> <li>Import: Local files, USB drives, network shares</li> <li>Export: Markdown, JSON, plain text</li> <li>Transfer: Standard file transfer protocols (SCP, SFTP, etc.)</li> </ul>"},{"location":"development/architecture/#versioned-data-strategy","title":"Versioned Data Strategy","text":""},{"location":"development/architecture/#configuration-versioning","title":"Configuration Versioning","text":"<ul> <li>Backward Compatibility: Support for older OPNsense versions</li> <li>Forward Compatibility: Graceful handling of newer configurations</li> <li>Version Detection: Automatic OPNsense version identification</li> <li>Migration Support: Utilities for format changes</li> </ul>"},{"location":"development/architecture/#non-destructive-processing","title":"Non-Destructive Processing","text":"<ul> <li>Original Preservation: Input files never modified</li> <li>Timestamped Outputs: Version metadata in all outputs</li> <li>Audit Trail: Change tracking and diff generation</li> <li>Rollback Support: Easy reversion to previous states</li> </ul>"},{"location":"development/architecture/#schema-evolution","title":"Schema Evolution","text":"<pre><code>graph TB\n    subgraph \"Version Management\"\n        V1[OPNsense v1.x&lt;br/&gt;Basic features]\n        V2[OPNsense v2.x&lt;br/&gt;Enhanced features]\n        V3[OPNsense v3.x&lt;br/&gt;Latest features]\n    end\n\n    subgraph \"Compatibility Layer\"\n        COMPAT[Version Handler]\n        MIGRATE[Migration Engine]\n        VALIDATE[Schema Validator]\n    end\n\n    subgraph \"Processing Pipeline\"\n        PARSER[XML Parser]\n        CONVERTER[Data Converter]\n        RENDERER[Output Renderer]\n    end\n\n    V1 --&gt; COMPAT\n    V2 --&gt; COMPAT\n    V3 --&gt; COMPAT\n\n    COMPAT --&gt; VALIDATE\n    COMPAT --&gt; MIGRATE\n    MIGRATE --&gt; PARSER\n    VALIDATE --&gt; PARSER\n\n    PARSER --&gt; CONVERTER\n    CONVERTER --&gt; RENDERER</code></pre>"},{"location":"development/architecture/#security-architecture","title":"Security Architecture","text":""},{"location":"development/architecture/#threat-model","title":"Threat Model","text":"<ul> <li>Primary Threats: Malicious XML files, path traversal, resource exhaustion</li> <li>Not Addressed: Network attacks (offline operation), privilege escalation (user-level tool)</li> </ul>"},{"location":"development/architecture/#security-controls","title":"Security Controls","text":"<ul> <li>Input Validation: XML schema validation, path sanitization, size limits</li> <li>Processing Security: Memory safety (Go runtime), type safety, error handling</li> <li>Output Security: Path validation, permission checks, content sanitization</li> </ul>"},{"location":"development/architecture/#air-gap-security-benefits","title":"Air-Gap Security Benefits","text":"<ul> <li>No Network Attack Surface: Offline operation eliminates network-based threats</li> <li>No Data Exfiltration: Local processing only</li> <li>No Unauthorized Updates: Manual deployment only</li> <li>Audit-Friendly: All operations are local and traceable</li> </ul>"},{"location":"development/architecture/#deployment-patterns","title":"Deployment Patterns","text":""},{"location":"development/architecture/#single-binary-distribution","title":"Single Binary Distribution","text":"<ul> <li>Build: Cross-compiled Go binary</li> <li>Size: Minimal footprint (~10-20MB)</li> <li>Dependencies: None (all embedded)</li> <li>Installation: Drop-in replacement, no setup required</li> </ul>"},{"location":"development/architecture/#multi-platform-support","title":"Multi-Platform Support","text":"<ul> <li>Operating Systems: Linux, macOS, Windows</li> <li>Architectures: amd64, arm64</li> <li>Special: macOS universal binaries</li> <li>Packages: Native package formats for each platform</li> </ul>"},{"location":"development/architecture/#enterprise-deployment","title":"Enterprise Deployment","text":"<ul> <li>Package Management: APT, RPM, Homebrew integration</li> <li>Code Signing: Verified binaries for security</li> <li>Bulk Deployment: Network share or USB distribution</li> <li>Configuration Management: YAML-based configuration</li> </ul>"},{"location":"development/architecture/#quick-start-architecture-summary","title":"Quick Start Architecture Summary","text":"<ol> <li>User provides OPNsense config.xml file</li> <li>CLI parses command-line arguments and loads configuration</li> <li>XML Parser validates and structures the input data</li> <li>Data Converter transforms XML to markdown with metadata</li> <li>Output Renderer formats for terminal display or file export</li> <li>User receives human-readable documentation</li> </ol> <p>Key Benefits: Offline operation, security-first design, operator-focused workflows, cross-platform compatibility, and comprehensive documentation generation from complex network configurations.</p> <p>For detailed architecture information, see the complete architecture documentation.</p>"},{"location":"development/releasing/","title":"Releasing opnDossier","text":"<p>This document outlines the complete process for preparing and releasing a new version of opnDossier. The project uses GoReleaser for automated releases, git-cliff for changelog generation, and follows semantic versioning principles with comprehensive security compliance.</p>"},{"location":"development/releasing/#overview","title":"Overview","text":"<p>The opnDossier release process is designed to be:</p> <ul> <li>Local-First: All commands run locally using the justfile and GoReleaser</li> <li>Consistent: Following conventional commits and semantic versioning</li> <li>Comprehensive: Includes binaries, Docker images, checksums, and SBOMs</li> <li>Secure: Includes SLSA Level 3 provenance, Cosign signatures, and comprehensive security scanning</li> <li>Security Compliant: Full compliance with industry security standards</li> </ul>"},{"location":"development/releasing/#prerequisites","title":"Prerequisites","text":"<p>Before starting a release, ensure you have:</p> <ol> <li> <p>Required Tools:</p> </li> <li> <p><code>git-cliff</code> installed (run <code>just install-git-cliff</code> if needed)</p> </li> <li><code>goreleaser</code> installed</li> <li><code>cosign</code> for artifact signing (run <code>just install-cosign</code> if needed)</li> <li><code>grype</code> for vulnerability scanning (run <code>just install-grype</code> if needed)</li> <li><code>syft</code> for SBOM generation (run <code>just install-syft</code> if needed)</li> <li><code>snyk</code> CLI for additional vulnerability scanning (optional)</li> <li><code>fossa</code> CLI for license analysis (optional)</li> <li> <p>Proper GitHub permissions for the repository</p> </li> <li> <p>Environment Setup:</p> </li> <li> <p><code>GITHUB_TOKEN</code> with appropriate permissions</p> </li> <li>For macOS notarization (optional):<ul> <li><code>MACOS_SIGN_P12</code></li> <li><code>MACOS_SIGN_PASSWORD</code></li> <li><code>MACOS_NOTARY_ISSUER_ID</code></li> <li><code>MACOS_NOTARY_KEY_ID</code></li> <li><code>MACOS_NOTARY_KEY</code></li> </ul> </li> <li> <p>For enhanced security scanning (optional):</p> <ul> <li><code>SNYK_TOKEN</code> for Snyk vulnerability scanning</li> <li><code>FOSSA_API_KEY</code> for FOSSA license analysis</li> </ul> </li> <li> <p>Clean Working Directory:</p> </li> </ol> <pre><code>git status  # Should show no uncommitted changes\ngit pull origin main  # Ensure you're up to date\n</code></pre> <ol> <li>Docker Login (for pushing container images):</li> </ol> <pre><code>echo $GITHUB_TOKEN | docker login ghcr.io -u YOUR_GITHUB_USERNAME --password-stdin\n</code></pre>"},{"location":"development/releasing/#release-process","title":"Release Process","text":""},{"location":"development/releasing/#step-1-pre-release-validation","title":"Step 1: Pre-Release Validation","text":"<ol> <li>Run Full Test Suite:</li> </ol> <pre><code>just full-checks\n</code></pre> <p>This runs:</p> <ul> <li>Code formatting checks (<code>just format-check</code>)</li> <li>Linting (<code>just lint</code>)</li> <li>All tests with race detection (<code>just test</code>)</li> <li>Security scanning (<code>just security-scan</code>)</li> <li>GoReleaser configuration validation (<code>just check-goreleaser</code>)</li> </ul> <p>The <code>full-checks</code> command includes:</p> <ul> <li>Vulnerability Scanning: Grype for dependency vulnerabilities</li> <li>SBOM Generation: Syft for Software Bill of Materials</li> <li>License Analysis: FOSSA for license compliance</li> <li> <p>Additional Security: Snyk for enhanced vulnerability scanning</p> </li> <li> <p>Test Release Build (Optional but Recommended):</p> </li> </ul> <pre><code>just build-snapshot\n</code></pre> <p>This creates a snapshot build without publishing to verify everything works.</p> <ol> <li>Security Validation:</li> </ol> <pre><code># Run comprehensive security scan\njust security-scan\n\n# Or run individual security checks\njust scan-vulnerabilities  # Grype vulnerability scan\njust generate-sbom         # Generate SBOM with Syft\njust snyk-scan            # Snyk vulnerability scan (requires SNYK_TOKEN)\njust fossa-scan           # FOSSA license analysis (requires FOSSA_API_KEY)\n</code></pre>"},{"location":"development/releasing/#step-2-update-changelog","title":"Step 2: Update Changelog","text":"<p>The project uses <code>git-cliff</code> with conventional commits to automatically generate changelogs.</p> <ol> <li>Generate Changelog for Unreleased Changes:</li> </ol> <pre><code>just changelog-unreleased\n</code></pre> <ol> <li> <p>Review the Generated Changelog:</p> </li> <li> <p>Open <code>CHANGELOG.md</code> and review the unreleased section</p> </li> <li>Ensure all important changes are captured</li> <li> <p>Verify that conventional commit formatting is working correctly</p> </li> <li> <p>Generate Changelog for Specific Version (if needed):</p> </li> </ol> <pre><code>just changelog-version v1.2.3\n</code></pre>"},{"location":"development/releasing/#step-3-version-tagging","title":"Step 3: Version Tagging","text":"<p>opnDossier follows semantic versioning (SemVer) with the format <code>vMAJOR.MINOR.PATCH</code>:</p> <ul> <li>MAJOR: Incompatible API changes or breaking changes</li> <li>MINOR: New functionality in a backwards compatible manner</li> <li> <p>PATCH: Backwards compatible bug fixes</p> </li> <li> <p>Create Version Tag:</p> </li> </ul> <pre><code># Replace X.Y.Z with your version number\ngit tag vX.Y.Z\n</code></pre> <p>Note: Don't push the tag yet - this will be done after the release is created.</p> <p>Examples:</p> <ul> <li><code>v1.0.0</code> - First stable release</li> <li><code>v1.1.0</code> - New features added</li> <li><code>v1.0.1</code> - Bug fixes only</li> <li><code>v2.0.0-rc1</code> - Release candidate</li> <li><code>v2.0.0-beta1</code> - Beta release</li> </ul>"},{"location":"development/releasing/#step-4-local-release","title":"Step 4: Local Release","text":"<p>All releases are performed locally using the justfile commands:</p> <ol> <li>Login to GitHub Container Registry (for Docker images):</li> </ol> <pre><code>echo $GITHUB_TOKEN | docker login ghcr.io -u YOUR_GITHUB_USERNAME --password-stdin\n</code></pre> <ol> <li>Run the Release:</li> </ol> <pre><code>just release\n</code></pre> <p>This runs <code>goreleaser release --clean</code> which:</p> <ul> <li>Dynamically generates shell completions (bash, zsh, fish, PowerShell) using Cobra</li> <li>Dynamically generates man pages for all commands using Cobra</li> <li>Builds binaries for all platforms (FreeBSD, Linux, macOS, Windows)</li> <li>Creates archives with proper naming and includes LICENSE, README.md, CHANGELOG.md</li> <li>Generates native packages (.deb, .rpm, .apk, .pkg.tar.xz) with nfpm including:<ul> <li>Man pages in <code>/usr/share/man/man1/</code></li> <li>Shell completions for bash, zsh, and fish</li> <li>Complete documentation</li> </ul> </li> <li>Generates checksums file (<code>opnDossier_checksums.txt</code>)</li> <li>Creates Software Bill of Materials (SBOM) for archives and packages</li> <li>Signs all artifacts with Cosign (keyless signing)</li> <li>Builds and pushes Docker images to GitHub Container Registry</li> <li>Creates the GitHub release with all artifacts attached</li> <li> <p>Uses git-cliff generated changelog for release notes</p> </li> <li> <p>Push the Git Tag (after successful release):</p> </li> </ul> <pre><code>git push origin vX.Y.Z\n</code></pre>"},{"location":"development/releasing/#alternative-snapshot-release","title":"Alternative: Snapshot Release","text":"<p>For testing the release process without publishing:</p> <pre><code>just release-snapshot\n</code></pre> <p>This creates all artifacts locally but doesn't publish to GitHub or push Docker images.</p>"},{"location":"development/releasing/#security-features","title":"Security Features","text":""},{"location":"development/releasing/#automated-security-scanning","title":"Automated Security Scanning","text":"<p>The release process includes comprehensive security scanning:</p> <ol> <li>Vulnerability Scanning: Grype scans all dependencies for known vulnerabilities</li> <li>SBOM Generation: Syft generates Software Bill of Materials in SPDX format</li> <li>License Analysis: FOSSA verifies license compliance</li> <li>Additional Security: Snyk provides enhanced vulnerability scanning</li> </ol>"},{"location":"development/releasing/#slsa-level-3-provenance","title":"SLSA Level 3 Provenance","text":"<p>Every release includes SLSA Level 3 provenance attestation:</p> <ul> <li>Build Integrity: Cryptographic proof of build process integrity</li> <li>Source Verification: Links artifacts to exact source code versions</li> <li>Build Environment: Documents the build environment and tools used</li> <li>Automated Generation: Generated automatically via GitHub Actions</li> </ul>"},{"location":"development/releasing/#cosign-signatures","title":"Cosign Signatures","text":"<p>All release artifacts are signed using Cosign:</p> <ul> <li>Keyless Signing: Uses OIDC-based keyless signing</li> <li>Artifact Verification: Users can verify artifact authenticity</li> <li>Bundle Format: Signatures include in-toto attestation bundles</li> <li>Automated Process: Integrated into the release workflow</li> </ul>"},{"location":"development/releasing/#verification-commands","title":"Verification Commands","text":"<p>Users can verify releases using:</p> <pre><code># Verify checksums\nsha256sum -c opnDossier_checksums.txt\n\n# Verify Cosign signatures (requires cosign)\ncosign verify-blob \\\n  --bundle cosign.bundle \\\n  opnDossier_checksums.txt\n\n# Verify individual artifacts with Cosign\ncosign verify-blob \\\n  --bundle cosign.bundle \\\n  opnDossier_Linux_x86_64.tar.gz\n</code></pre> <p>Note: SLSA provenance is generated via GitHub Actions for automated releases. For manual releases, SLSA provenance can be generated separately using the SLSA framework tools.</p>"},{"location":"development/releasing/#goreleaser-configuration","title":"GoReleaser Configuration","text":"<p>The <code>.goreleaser.yaml</code> file configures the following release artifacts:</p>"},{"location":"development/releasing/#binaries","title":"Binaries","text":"<ul> <li>Platforms: FreeBSD, Linux, macOS, Windows</li> <li>Architectures: amd64, arm64 (FreeBSD arm64 excluded)</li> <li>Binary Name: <code>opnDossier</code></li> <li>Build Flags: CGO disabled, stripped binaries with version info</li> </ul>"},{"location":"development/releasing/#archives","title":"Archives","text":"<ul> <li>Format: tar.gz (zip for Windows)</li> <li>Naming: <code>opnDossier_OS_ARCH</code> format</li> <li>Includes: LICENSE, README.md, CHANGELOG.md</li> </ul>"},{"location":"development/releasing/#docker-images","title":"Docker Images","text":"<p>Two Docker image variants are built:</p> <ol> <li> <p>Standard Image:</p> </li> <li> <p><code>ghcr.io/evilbit-labs/opndossier:latest</code></p> </li> <li><code>ghcr.io/evilbit-labs/opndossier:vX.Y.Z</code></li> <li><code>ghcr.io/evilbit-labs/opndossier:vX.Y</code></li> <li> <p><code>ghcr.io/evilbit-labs/opndossier:vX</code></p> </li> <li> <p>POCL Variant:</p> </li> <li> <p>Same tags with <code>-pocl</code> suffix</p> </li> <li>Uses different build branch</li> </ol>"},{"location":"development/releasing/#additional-artifacts","title":"Additional Artifacts","text":"<ul> <li>Checksums: <code>opnDossier_checksums.txt</code></li> <li>SBOM: Software Bill of Materials for archives and packages</li> <li>Source Code: Automatically included</li> <li>Universal Binaries: For macOS (replaces individual arch binaries)</li> </ul>"},{"location":"development/releasing/#dynamic-documentation-generation","title":"Dynamic Documentation Generation","text":"<p>opnDossier uses Cobra's built-in capabilities to dynamically generate shell completions and man pages during the release process. This ensures documentation is always current with the actual command structure.</p>"},{"location":"development/releasing/#shell-completions","title":"Shell Completions","text":"<p>The CLI supports generating completions for multiple shells:</p> <pre><code># Generate bash completion\nopndossier completion bash &gt; ~/.bash_completion\n\n# Generate zsh completion\nopndossier completion zsh &gt; \"${fpath[1]}/_opndossier\"\n\n# Generate fish completion\nopndossier completion fish &gt; ~/.config/fish/completions/opndossier.fish\n\n# Generate PowerShell completion\nopndossier completion powershell &gt; opndossier.ps1\n</code></pre>"},{"location":"development/releasing/#man-pages","title":"Man Pages","text":"<p>Generate comprehensive man pages for all commands:</p> <pre><code># Generate man pages in current directory\nopndossier man ./\n\n# Generate man pages in system location\nsudo opndossier man /usr/local/share/man/man1/\n</code></pre>"},{"location":"development/releasing/#release-integration","title":"Release Integration","text":"<p>During the release process, GoReleaser automatically:</p> <ol> <li>Builds a temporary binary with correct version information</li> <li>Generates shell completions for bash, zsh, fish, and PowerShell</li> <li>Generates man pages for all commands and subcommands</li> <li>Includes these files in native packages (.deb, .rpm, .apk, .pkg.tar.xz)</li> <li>Cleans up temporary files</li> </ol> <p>This ensures that:</p> <ul> <li>Package installations include working completions and man pages</li> <li>Documentation is always synchronized with the actual CLI interface</li> <li>No manual maintenance of static documentation files is required</li> </ul>"},{"location":"development/releasing/#version-information","title":"Version Information","text":"<p>Version information is injected into the binary at build time:</p> <ul> <li>Main Version: Set via ldflags in GoReleaser (<code>main.version</code>)</li> <li>Build Date: Available in CLI via <code>opnDossier version</code></li> <li>Git Commit: Available in CLI via <code>opnDossier version</code></li> </ul> <p>The version is displayed using:</p> <pre><code>opnDossier version\n</code></pre>"},{"location":"development/releasing/#changelog-generation","title":"Changelog Generation","text":"<p>The project uses <code>git-cliff</code> with a custom <code>cliff.toml</code> configuration:</p>"},{"location":"development/releasing/#commit-categories","title":"Commit Categories","text":"<p>Commits are automatically categorized based on conventional commit prefixes:</p> <ul> <li>Features: <code>feat:</code> commits</li> <li>Bug Fixes: <code>fix:</code> commits</li> <li>Security: <code>fix(security):</code> commits or security-related changes</li> <li>Documentation: <code>doc:</code> commits</li> <li>Performance: <code>perf:</code> commits</li> <li>Refactor: <code>refactor:</code> commits</li> <li>Styling: <code>style:</code> commits</li> <li>Testing: <code>test:</code> commits</li> <li>Miscellaneous: <code>chore:</code> and <code>ci:</code> commits</li> <li>Revert: <code>revert:</code> commits</li> </ul>"},{"location":"development/releasing/#commit-message-format","title":"Commit Message Format","text":"<p>Follow conventional commits:</p> <pre><code>type(scope): description\n\n[optional body]\n\n[optional footer]\n</code></pre> <p>Examples:</p> <ul> <li><code>feat(auth): add OAuth2 support</code></li> <li><code>fix(parser): handle malformed XML gracefully</code></li> <li><code>docs: update installation instructions</code></li> </ul>"},{"location":"development/releasing/#troubleshooting","title":"Troubleshooting","text":""},{"location":"development/releasing/#common-issues","title":"Common Issues","text":"<ol> <li>GoReleaser Configuration Errors:</li> </ol> <pre><code>just check-goreleaser\n</code></pre> <ol> <li>Missing git-cliff:</li> </ol> <pre><code>just install-git-cliff\n</code></pre> <ol> <li>Missing Security Tools:</li> </ol> <pre><code>just install-grype    # Install Grype vulnerability scanner\njust install-syft     # Install Syft SBOM generator\n</code></pre> <ol> <li> <p>Build Failures:</p> </li> <li> <p>Check Go version compatibility (requires Go 1.24+)</p> </li> <li>Ensure all tests pass: <code>just test</code></li> <li> <p>Verify dependencies: <code>go mod tidy</code></p> </li> <li> <p>Docker Login Issues:</p> </li> <li> <p>Verify GITHUB_TOKEN permissions</p> </li> <li>Check container registry access</li> <li>Ensure you're logged in: <code>docker login ghcr.io</code></li> <li> <p>Test Docker access: <code>docker pull ghcr.io/evilbit-labs/opndossier:latest</code></p> </li> <li> <p>Security Scan Failures:</p> </li> <li> <p>Check for high-severity vulnerabilities in dependencies</p> </li> <li>Review SBOM for unexpected dependencies</li> <li>Verify license compliance with FOSSA</li> </ol>"},{"location":"development/releasing/#release-validation","title":"Release Validation","text":"<p>After a release, verify:</p> <ol> <li> <p>GitHub Release Page:</p> </li> <li> <p>Release notes are generated correctly</p> </li> <li>All binary artifacts are attached</li> <li>Checksums file is present</li> <li>SBOM files are included</li> <li> <p>SLSA provenance attestation is attached</p> </li> <li> <p>Docker Images:</p> </li> </ol> <pre><code>docker pull ghcr.io/evilbit-labs/opndossier:latest\ndocker run --rm ghcr.io/evilbit-labs/opndossier:latest version\n</code></pre> <ol> <li> <p>Binary Downloads:</p> </li> <li> <p>Test download and execution of binaries for your platform</p> </li> <li> <p>Verify version information is correct</p> </li> <li> <p>Security Verification:</p> </li> </ol> <pre><code># Verify checksums\nsha256sum -c opnDossier_checksums.txt\n\n# Verify SLSA provenance\nslsa-verifier verify-artifact \\\n  --provenance-path opnDossier-v1.0.0.intoto.jsonl \\\n  --source-uri github.com/EvilBit-Labs/opnDossier \\\n  opnDossier_checksums.txt\n</code></pre>"},{"location":"development/releasing/#release-schedule","title":"Release Schedule","text":"<p>opnDossier follows these release practices:</p> <ul> <li>Patch Releases: As needed for critical bug fixes</li> <li>Minor Releases: When new features are ready and tested</li> <li>Major Releases: For breaking changes or significant milestones</li> <li>Pre-releases: Beta and RC versions for testing before major releases</li> </ul>"},{"location":"development/releasing/#security-considerations","title":"Security Considerations","text":"<ul> <li>All releases are signed and checksummed</li> <li>Docker images include security labels and provenance information</li> <li>macOS binaries can be notarized when certificates are configured</li> <li>Dependencies are automatically updated via Dependabot</li> <li>CodeQL analysis runs on all releases</li> <li>SLSA Level 3 provenance provides build integrity verification</li> <li>Cosign signatures ensure artifact authenticity</li> <li>Comprehensive vulnerability scanning with Grype and Snyk</li> <li>License compliance verified with FOSSA</li> </ul>"},{"location":"development/releasing/#post-release-tasks","title":"Post-Release Tasks","text":"<p>After a successful release:</p> <ol> <li>Update Documentation: Ensure docs reflect new features</li> <li>Close Milestones: Close the GitHub milestone for the release</li> <li>Announce Release: Update relevant channels about the new version</li> <li>Monitor Issues: Watch for any issues reported with the new release</li> <li>Security Monitoring: Monitor for any security issues in dependencies</li> </ol>"},{"location":"development/releasing/#rollback-procedure","title":"Rollback Procedure","text":"<p>If a release has critical issues:</p> <ol> <li>Create Hotfix: Fix the issue in a new patch release</li> <li>Update GitHub Release: Mark problematic release as pre-release if needed</li> <li>Docker Images: Latest tag will point to the new fixed version</li> <li>Communication: Notify users about the issue and fix</li> <li>Security Assessment: Re-run security scans to ensure no new vulnerabilities</li> </ol> <p>For questions about the release process, please refer to the project's CONTRIBUTING.md or open an issue.</p>"},{"location":"development/standards/","title":"Development Standards for opnDossier","text":"<p>This document provides coding standards, development workflows, and technical guidelines for contributors to the opnDossier CLI tool. It focuses on practical development tasks, code quality, and maintainability. It complements the AI agent guidelines in AGENTS.md.</p>"},{"location":"development/standards/#table-of-contents","title":"Table of Contents","text":"<ol> <li>Development Environment Setup</li> <li>Code Quality Standards</li> <li>Testing Requirements</li> <li>Development Workflow</li> <li>Architecture Guidelines</li> <li>Security Standards</li> </ol>"},{"location":"development/standards/#development-environment-setup","title":"Development Environment Setup","text":""},{"location":"development/standards/#prerequisites","title":"Prerequisites","text":"<ul> <li>Go 1.21.6+ (recommended: 1.24.5+)</li> <li>Git with conventional commit support</li> <li>Just task runner (<code>just --version</code> to verify)</li> <li>Python 3.11+ (for documentation)</li> </ul>"},{"location":"development/standards/#initial-setup","title":"Initial Setup","text":"<pre><code># Clone and setup\ngit clone https://github.com/EvilBit-Labs/opnDossier.git\ncd opnDossier\n\n# Install dependencies and tools\njust install\n\n# Verify setup\njust test\njust lint\n</code></pre>"},{"location":"development/standards/#ide-configuration","title":"IDE Configuration","text":"<p>VS Code Extensions:</p> <ul> <li>Go extension (official)</li> <li>Pre-commit hooks</li> <li>YAML support</li> <li>Markdown preview</li> </ul> <p>GoLand/IntelliJ:</p> <ul> <li>Enable <code>gofmt</code> on save</li> <li>Configure <code>golangci-lint</code> integration</li> <li>Set up run configurations for <code>just</code> commands</li> </ul>"},{"location":"development/standards/#environment-variables","title":"Environment Variables","text":"<pre><code># Development environment\nexport OPNDOSSIER_LOG_LEVEL=debug\nexport OPNDOSSIER_LOG_FORMAT=text\n\n# For testing\nexport OPNDOSSIER_TEST_MODE=true\n</code></pre>"},{"location":"development/standards/#code-quality-standards","title":"Code Quality Standards","text":""},{"location":"development/standards/#technology-stack","title":"Technology Stack","text":"Component Technology Purpose CLI Framework <code>cobra</code> Command organization and help system Configuration <code>spf13/viper</code> Configuration management CLI Enhancement <code>charmbracelet/fang</code> Enhanced CLI experience Terminal Styling <code>charmbracelet/lipgloss</code> Colored output and styling Markdown Rendering <code>charmbracelet/glamour</code> Terminal markdown display Logging <code>charmbracelet/log</code> Structured logging Data Processing <code>encoding/xml</code>, <code>encoding/json</code> Standard library XML/JSON handling Testing Go's built-in <code>testing</code> package Table-driven tests with &gt;80% coverage"},{"location":"development/standards/#code-style-and-formatting","title":"Code Style and Formatting","text":"<p>Required Tools:</p> <ul> <li><code>gofmt</code> - Code formatting (automatic)</li> <li><code>gofumpt</code> - Enhanced formatting</li> <li><code>golangci-lint</code> - Comprehensive linting</li> <li><code>go vet</code> - Static analysis</li> <li><code>goimports</code> - Import organization</li> <li><code>gosec</code> - Security scanning (via golangci-lint)</li> </ul> <p>Conventions:</p> <ul> <li>Formatting: Use <code>gofmt</code> with default settings</li> <li>Line Length: 80-120 characters (Go conventions)</li> <li>Indentation: Use tabs (Go standard)</li> <li>Naming:</li> <li>Packages: <code>snake_case</code> or single word, lowercase</li> <li>Variables/functions: <code>camelCase</code> for private, <code>PascalCase</code> for exported</li> <li>Constants: <code>camelCase</code> for private, <code>PascalCase</code> for exported (avoid <code>ALL_CAPS</code>)</li> <li>Types: <code>PascalCase</code></li> <li>Interfaces: <code>PascalCase</code>, ending with <code>-er</code> when appropriate</li> <li>Receivers: Single-letter names (e.g., <code>c *Config</code>)</li> </ul>"},{"location":"development/standards/#error-handling-patterns","title":"Error Handling Patterns","text":"<pre><code>// Always check errors and provide context\nfunc parseXMLConfig(filename string) (*Config, error) {\n    data, err := os.ReadFile(filename)\n    if err != nil {\n        return nil, fmt.Errorf(\"failed to read config file %s: %w\", filename, err)\n    }\n\n    var config Config\n    if err := xml.Unmarshal(data, &amp;config); err != nil {\n        return nil, fmt.Errorf(\"failed to parse XML config: %w\", err)\n    }\n\n    return &amp;config, nil\n}\n\n// Use structured logging\nlogger := log.New(os.Stderr, \"\", log.LstdFlags)\nlogger.Info(\"processing config file\", \"filename\", filename)\n</code></pre>"},{"location":"development/standards/#commit-message-conventions","title":"Commit Message Conventions","text":"<p>All commit messages MUST follow the Conventional Commits specification:</p> <p>Format: <code>&lt;type&gt;(&lt;scope&gt;): &lt;description&gt;</code></p> <p>Types:</p> <ul> <li><code>feat</code> - New features</li> <li><code>fix</code> - Bug fixes</li> <li><code>docs</code> - Documentation changes</li> <li><code>style</code> - Code style changes (formatting, etc.)</li> <li><code>refactor</code> - Code refactoring</li> <li><code>perf</code> - Performance improvements</li> <li><code>test</code> - Adding or updating tests</li> <li><code>build</code> - Build system changes</li> <li><code>ci</code> - CI/CD changes</li> <li><code>chore</code> - Maintenance tasks</li> </ul> <p>Scopes: <code>(cli)</code>, <code>(parser)</code>, <code>(converter)</code>, <code>(display)</code>, <code>(config)</code>, <code>(docs)</code>, etc.</p> <p>Examples:</p> <pre><code>feat(cli): add support for custom config path\nfix(parser): handle malformed XML gracefully\ndocs: update README with install instructions\nperf(converter): optimize markdown generation\ntest(parser): add integration tests for XML parsing\n</code></pre>"},{"location":"development/standards/#testing-requirements","title":"Testing Requirements","text":""},{"location":"development/standards/#test-standards","title":"Test Standards","text":"<p>Requirements:</p> <ul> <li>Coverage Target: &gt;80% test coverage</li> <li>Test Organization: Table-driven tests with <code>t.Run()</code> subtests</li> <li>Performance: Individual tests \\&lt;100ms</li> <li>Integration Tests: Use build tags (<code>//go:build integration</code>)</li> </ul>"},{"location":"development/standards/#test-structure","title":"Test Structure","text":"<pre><code>func TestParseXMLConfig(t *testing.T) {\n    tests := []struct {\n        name     string\n        input    string\n        expected *Config\n        wantErr  bool\n    }{\n        {\n            name:     \"valid config\",\n            input:    `&lt;config&gt;&lt;system&gt;&lt;hostname&gt;test&lt;/hostname&gt;&lt;/system&gt;&lt;/config&gt;`,\n            expected: &amp;Config{System: System{Hostname: \"test\"}},\n            wantErr:  false,\n        },\n        {\n            name:     \"invalid XML\",\n            input:    `&lt;config&gt;&lt;unclosed&gt;`,\n            expected: nil,\n            wantErr:  true,\n        },\n    }\n\n    for _, tt := range tests {\n        t.Run(tt.name, func(t *testing.T) {\n            result, err := parseXMLConfig(tt.input)\n            if (err != nil) != tt.wantErr {\n                t.Errorf(\"parseXMLConfig() error = %v, wantErr %v\", err, tt.wantErr)\n                return\n            }\n            if !reflect.DeepEqual(result, tt.expected) {\n                t.Errorf(\"parseXMLConfig() = %v, want %v\", result, tt.expected)\n            }\n        })\n    }\n}\n</code></pre>"},{"location":"development/standards/#testing-commands","title":"Testing Commands","text":"<pre><code># Run all tests\njust test\n\n# Run with coverage\njust coverage\n\n# Run benchmarks\njust bench\n\n# Run memory benchmarks\njust bench-memory\n\n# Run race detection\ngo test -race ./...\n</code></pre>"},{"location":"development/standards/#development-workflow","title":"Development Workflow","text":""},{"location":"development/standards/#daily-development-tasks","title":"Daily Development Tasks","text":"<pre><code># Start development session\njust dev --help                    # Test CLI functionality\njust test                         # Run tests before making changes\njust lint                         # Check code quality\n\n# Make changes, then:\njust format                       # Format code\njust check                        # Run pre-commit checks\njust test                         # Verify tests still pass\n</code></pre>"},{"location":"development/standards/#adding-new-features","title":"Adding New Features","text":"<ol> <li>Create feature branch:</li> </ol> <pre><code>git checkout -b feat/your-feature-name\n</code></pre> <ol> <li> <p>Implement feature:</p> </li> <li> <p>Follow existing patterns in similar code</p> </li> <li>Add tests for new functionality</li> <li> <p>Update documentation if needed</p> </li> <li> <p>Quality checks:</p> </li> </ol> <pre><code>just ci-check                   # Run all checks locally\n</code></pre> <ol> <li>Commit changes:</li> </ol> <pre><code>git add .\ngit commit -m \"feat(scope): description\"\n</code></pre>"},{"location":"development/standards/#debugging","title":"Debugging","text":"<p>Common debugging scenarios:</p> <pre><code># Debug CLI commands\njust dev --verbose convert testdata/config.xml\n\n# Debug with specific log level\nOPNDOSSIER_LOG_LEVEL=debug just dev convert testdata/config.xml\n\n# Profile performance\ngo test -bench=. -cpuprofile=cpu.prof ./internal/parser\ngo tool pprof cpu.prof\n\n# Memory profiling\ngo test -bench=. -memprofile=mem.prof ./internal/parser\ngo tool pprof mem.prof\n</code></pre> <p>Debugging tips:</p> <ul> <li>Use <code>log.Debug()</code> for temporary debugging output</li> <li>Check <code>internal/log/</code> for structured logging patterns</li> <li>Use <code>go test -v</code> for verbose test output</li> <li>Use <code>golangci-lint run --verbose</code> for detailed linting info</li> </ul>"},{"location":"development/standards/#performance-optimization","title":"Performance Optimization","text":"<p>Benchmarking:</p> <pre><code># Run benchmarks\njust bench\n\n# Compare benchmarks\ngo test -bench=. -benchmem ./internal/parser &gt; old.txt\n# Make changes\ngo test -bench=. -benchmem ./internal/parser &gt; new.txt\nbenchcmp old.txt new.txt\n</code></pre> <p>Profiling:</p> <pre><code># CPU profiling\ngo test -cpuprofile=cpu.prof -bench=. ./internal/parser\ngo tool pprof cpu.prof\n\n# Memory profiling\ngo test -memprofile=mem.prof -bench=. ./internal/parser\ngo tool pprof mem.prof\n</code></pre>"},{"location":"development/standards/#architecture-guidelines","title":"Architecture Guidelines","text":""},{"location":"development/standards/#project-structure","title":"Project Structure","text":"<pre><code>opnDossier/\n\u251c\u2500\u2500 main.go                           # Application entry point\n\u251c\u2500\u2500 cmd/                              # CLI commands\n\u2502   \u251c\u2500\u2500 root.go                       # Root command and CLI setup\n\u2502   \u251c\u2500\u2500 convert.go                    # Convert command implementation\n\u2502   \u251c\u2500\u2500 display.go                    # Display command implementation\n\u2502   \u251c\u2500\u2500 validate.go                   # Validate command implementation\n\u2502   \u2514\u2500\u2500 *_test.go                     # Command tests\n\u251c\u2500\u2500 internal/                         # Private application logic\n\u2502   \u251c\u2500\u2500 config/                       # Configuration handling\n\u2502   \u251c\u2500\u2500 parser/                       # XML parsing logic\n\u2502   \u251c\u2500\u2500 converter/                    # Data conversion logic\n\u2502   \u251c\u2500\u2500 display/                      # Output formatting\n\u2502   \u251c\u2500\u2500 export/                       # File export logic\n\u2502   \u251c\u2500\u2500 processor/                    # Configuration processing pipeline\n\u2502   \u251c\u2500\u2500 markdown/                     # Markdown generation\n\u2502   \u251c\u2500\u2500 model/                        # Data models\n\u2502   \u251c\u2500\u2500 validator/                    # Validation logic\n\u2502   \u251c\u2500\u2500 log/                          # Structured logging\n\u2502   \u251c\u2500\u2500 templates/                    # Report templates\n\u2502   \u251c\u2500\u2500 walker.go                     # XML walker utilities\n\u2502   \u2514\u2500\u2500 *_test.go                     # Package tests\n\u251c\u2500\u2500 docs/                             # Documentation\n\u251c\u2500\u2500 project_spec/                     # Project requirements\n\u251c\u2500\u2500 testdata/                         # Test data files\n\u2514\u2500\u2500 justfile                          # Task runner\n</code></pre>"},{"location":"development/standards/#key-design-principles","title":"Key Design Principles","text":"<ol> <li>Framework-First: Use established libraries (cobra, viper, charmbracelet)</li> <li>Operator-Centric: Build for security operators' workflows</li> <li>Offline-First: No external dependencies or telemetry</li> <li>Structured Data: Versioned, portable data models</li> </ol>"},{"location":"development/standards/#configuration-management","title":"Configuration Management","text":"<pre><code>// Using spf13/viper for configuration\ntype Config struct {\n    InputFile  string `flag:\"input\" desc:\"Input XML file path\"`\n    OutputFile string `flag:\"output\" desc:\"Output markdown file path\"`\n    Verbose    bool   `flag:\"verbose\" desc:\"Enable verbose output\"`\n}\n\n// Configuration precedence: CLI flags &gt; environment variables &gt; config file &gt; defaults\n</code></pre>"},{"location":"development/standards/#error-handling","title":"Error Handling","text":"<ul> <li>Always wrap errors with context using <code>fmt.Errorf</code> with <code>%w</code></li> <li>Create domain-specific error types for better error handling</li> <li>Use <code>errors.Is()</code> and <code>errors.As()</code> for error type checking</li> <li>Provide actionable error messages for users</li> </ul>"},{"location":"development/standards/#logging","title":"Logging","text":"<ul> <li>Use <code>charmbracelet/log</code> for structured logging</li> <li>Include context in log messages (filename, operation, duration)</li> <li>Use appropriate log levels (debug, info, warn, error)</li> <li>Avoid logging sensitive information</li> </ul>"},{"location":"development/standards/#security-standards","title":"Security Standards","text":""},{"location":"development/standards/#general-security-principles","title":"General Security Principles","text":"<ol> <li>No Secrets in Code: Never hardcode API keys, passwords, or sensitive data</li> <li>Environment Variables: Use environment variables with <code>OPNDOSSIER_</code> prefix for configuration</li> <li>Input Validation: Always validate and sanitize XML input files</li> <li>Secure Defaults: Default to secure configurations</li> <li>Error Messages: Avoid exposing sensitive information in error messages</li> </ol>"},{"location":"development/standards/#go-specific-security","title":"Go-Specific Security","text":"<p>Input Validation:</p> <pre><code>// Validate XML input before processing\nfunc validateXMLInput(data []byte) error {\n    if len(data) == 0 {\n        return errors.New(\"empty XML input\")\n    }\n\n    // Check for basic XML structure\n    if !bytes.Contains(data, []byte(\"&lt;?xml\")) &amp;&amp; !bytes.Contains(data, []byte(\"&lt;opnsense\")) {\n        return errors.New(\"invalid XML format: missing XML declaration or opnsense root\")\n    }\n\n    return nil\n}\n</code></pre> <p>Error Handling:</p> <pre><code>// Safe error messages without sensitive information\nfunc processConfig(filename string) error {\n    data, err := os.ReadFile(filename)\n    if err != nil {\n        // Don't expose full file paths in error messages\n        return fmt.Errorf(\"failed to read configuration file: %w\", err)\n    }\n\n    // Process data...\n    return nil\n}\n</code></pre>"},{"location":"development/standards/#operational-security","title":"Operational Security","text":"<ul> <li>Airgap Compatibility: Full functionality in isolated environments</li> <li>No Telemetry: No external data transmission</li> <li>Portable Data Exchange: Secure data bundle import/export</li> <li>Error Message Safety: No sensitive information exposure</li> </ul>"},{"location":"development/standards/#dependency-security","title":"Dependency Security","text":"<ul> <li>Minimal Dependencies: Reduced attack surface, except for cryptography dependencies - never write your own crypto code</li> <li>Dependency Scanning: Automated vulnerability detection via <code>gosec</code></li> <li>Supply Chain Security: Go module checksums and verification</li> <li>SBOM Generation: Dependency transparency for security compliance</li> </ul> <p>This document serves as the development standards guide for the opnDossier CLI tool. All contributors should follow these standards to ensure code quality, maintainability, and security.</p>"},{"location":"examples/","title":"Usage Examples","text":"<p>This section provides comprehensive examples for common workflows and use cases with opnDossier. Each example is designed to be practical and immediately usable.</p>"},{"location":"examples/#quick-start-examples","title":"Quick Start Examples","text":""},{"location":"examples/#basic-configuration-conversion","title":"Basic Configuration Conversion","text":"<pre><code># Convert OPNsense config to markdown\nopnDossier convert config.xml\n\n# Convert to JSON format\nopnDossier convert config.xml -f json\n\n# Convert to YAML format\nopnDossier convert config.xml -f yaml\n</code></pre>"},{"location":"examples/#display-configuration-in-terminal","title":"Display Configuration in Terminal","text":"<pre><code># Display with syntax highlighting\nopnDossier display config.xml\n\n# Display with dark theme\nopnDossier display --theme dark config.xml\n\n# Display without validation\nopnDossier display --no-validate config.xml\n</code></pre>"},{"location":"examples/#validate-configuration","title":"Validate Configuration","text":"<pre><code># Validate single file\nopnDossier validate config.xml\n\n# Validate multiple files\nopnDossier validate config1.xml config2.xml config3.xml\n\n# Validate with verbose output\nopnDossier --verbose validate config.xml\n</code></pre>"},{"location":"examples/#common-workflows","title":"Common Workflows","text":""},{"location":"examples/#1-basic-documentation","title":"1. Basic Documentation","text":"<ul> <li>Simple configuration conversion</li> <li>Output format options</li> <li>File management</li> </ul>"},{"location":"examples/#2-audit-and-compliance","title":"2. Audit and Compliance","text":"<ul> <li>Security audit reports</li> <li>Compliance checking</li> <li>Blue team vs Red team reports</li> </ul>"},{"location":"examples/#3-automation-and-scripting","title":"3. Automation and Scripting","text":"<ul> <li>CI/CD integration</li> <li>Batch processing</li> <li>Automated documentation</li> </ul>"},{"location":"examples/#4-troubleshooting-and-debugging","title":"4. Troubleshooting and Debugging","text":"<ul> <li>Error handling</li> <li>Debug techniques</li> <li>Common issues</li> </ul>"},{"location":"examples/#5-advanced-configuration","title":"5. Advanced Configuration","text":"<ul> <li>Custom templates</li> <li>Theme customization</li> <li>Section filtering</li> </ul>"},{"location":"examples/#example-categories","title":"Example Categories","text":""},{"location":"examples/#by-use-case","title":"By Use Case","text":"<ul> <li>Network Documentation: Generate readable documentation from OPNsense configs</li> <li>Security Auditing: Create security-focused audit reports</li> <li>Compliance Checking: Verify configurations against standards</li> <li>Configuration Analysis: Analyze and understand complex setups</li> <li>Backup Documentation: Document configuration backups</li> </ul>"},{"location":"examples/#by-output-format","title":"By Output Format","text":"<ul> <li>Markdown: Human-readable documentation</li> <li>JSON: Programmatic access and processing</li> <li>YAML: Configuration management integration</li> </ul>"},{"location":"examples/#by-workflow-type","title":"By Workflow Type","text":"<ul> <li>Interactive: Manual command execution</li> <li>Automated: Script-based processing</li> <li>CI/CD: Pipeline integration</li> <li>Batch: Multiple file processing</li> </ul>"},{"location":"examples/#getting-started","title":"Getting Started","text":"<ol> <li>Install opnDossier: Follow the installation guide</li> <li>Get a sample config: Use one of the sample files in <code>testdata/</code></li> <li>Try basic conversion: <code>opnDossier convert testdata/sample.config.1.xml</code></li> <li>Explore examples: Browse the examples below for your specific use case</li> </ol>"},{"location":"examples/#sample-files","title":"Sample Files","text":"<p>The project includes sample configuration files for testing:</p> <pre><code># List available sample files\nls testdata/*.xml\n\n# Use a sample file for testing\nopnDossier convert testdata/sample.config.1.xml\nopnDossier display testdata/sample.config.2.xml\nopnDossier validate testdata/sample.config.3.xml\n</code></pre>"},{"location":"examples/#next-steps","title":"Next Steps","text":"<ul> <li>New users: Start with Basic Documentation</li> <li>Security professionals: See Audit and Compliance</li> <li>DevOps engineers: Check Automation and Scripting</li> <li>Advanced users: Explore Advanced Configuration</li> </ul> <p>For detailed command reference, see the Usage Guide. For installation instructions, see the Installation Guide.</p>"},{"location":"examples/advanced-configuration/","title":"Advanced Configuration Examples","text":"<p>\u26a0\ufe0f Note: Some examples in this guide reference audit functionality that is not yet implemented in opnDossier v1.0.</p> <p>Examples using <code>--mode</code>, <code>--blackhat-mode</code>, and <code>--plugins</code> flags are for future releases. These flags are currently disabled and not available in the current version.</p> <p>This guide covers advanced configuration options and customization techniques for opnDossier.</p>"},{"location":"examples/advanced-configuration/#custom-templates","title":"Custom Templates","text":""},{"location":"examples/advanced-configuration/#creating-custom-templates","title":"Creating Custom Templates","text":"<p>Create a custom template directory:</p> <pre><code># Create template directory\nmkdir -p ~/.opnDossier/templates\n\n# Create a custom template\ncat &gt; ~/.opnDossier/templates/custom.md.tmpl &lt;&lt; 'EOF'\n# {{.System.Hostname}} Configuration Report\n\n## Executive Summary\n- **Hostname**: {{.System.Hostname}}\n- **Domain**: {{.System.Domain}}\n- **Generated**: {{.GeneratedAt}}\n\n## Network Interfaces\n{{range $name, $iface := .Interfaces}}\n### {{$name}} Interface\n- **IP Address**: {{$iface.IPAddress}}\n- **Subnet**: /{{$iface.Subnet}}\n- **Description**: {{$iface.Description}}\n- **Enabled**: {{if $iface.Enabled}}Yes{{else}}No{{end}}\n{{end}}\n\n## Firewall Rules Summary\n- **Total Rules**: {{len .Filter.Rules}}\n- **WAN Rules**: {{.Filter.WANRuleCount}}\n- **LAN Rules**: {{.Filter.LANRuleCount}}\n\n## Security Assessment\n{{if .SecurityIssues}}\n### Critical Issues\n{{range .SecurityIssues}}\n- **{{.Title}}**: {{.Description}}\n{{end}}\n{{else}}\nNo critical security issues found.\n{{end}}\nEOF\n</code></pre>"},{"location":"examples/advanced-configuration/#using-custom-templates","title":"Using Custom Templates","text":"<pre><code># Use custom template\nopnDossier convert config.xml --template-dir ~/.opnDossier/templates -o custom-report.md\n\n# Use specific template\nopnDossier convert config.xml --template custom -o custom-report.md\n\n# Use template with custom data\nopnDossier convert config.xml --template-dir ./templates --template-dir ~/.opnDossier/templates\n</code></pre>"},{"location":"examples/advanced-configuration/#advanced-template-features","title":"Advanced Template Features","text":""},{"location":"examples/advanced-configuration/#conditional-rendering","title":"Conditional Rendering","text":"<pre><code>{{if .System.Hostname}}\n# {{.System.Hostname}} Configuration\n{{else}}\n# Unnamed Firewall Configuration\n{{end}}\n\n{{if gt (len .Filter.Rules) 10}}\n## Large Rule Set Detected\nThis configuration has {{len .Filter.Rules}} firewall rules, which may impact performance.\n{{end}}\n</code></pre>"},{"location":"examples/advanced-configuration/#loops-and-iteration","title":"Loops and Iteration","text":"<pre><code>## Interface Analysis\n{{range $name, $iface := .Interfaces}}\n### {{$name}} Interface\n{{if eq $iface.IPAddress \"dhcp\"}}\n- **Configuration**: DHCP\n{{else}}\n- **Configuration**: Static ({{$iface.IPAddress}}/{{$iface.Subnet}})\n{{end}}\n{{end}}\n</code></pre>"},{"location":"examples/advanced-configuration/#template-functions","title":"Template Functions","text":"<pre><code>## Statistics\n- **Total Interfaces**: {{len .Interfaces}}\n- **Total Rules**: {{len .Filter.Rules}}\n- **Total Users**: {{len .System.Users}}\n- **Total Groups**: {{len .System.Groups}}\n\n## Network Summary\n{{range $name, $iface := .Interfaces}}\n- {{$name}}: {{$iface.IPAddress}}/{{$iface.Subnet}}\n{{end}}\n</code></pre>"},{"location":"examples/advanced-configuration/#template-inheritance","title":"Template Inheritance","text":"<p>Create a base template:</p> <pre><code># Base Template (base.md.tmpl)\n{{define \"base\"}}\n# {{.System.Hostname}} - {{.Title}}\n\n{{template \"header\" .}}\n\n{{template \"content\" .}}\n\n{{template \"footer\" .}}\n{{end}}\n\n{{define \"header\"}}\nGenerated on {{.GeneratedAt}}\n{{end}}\n\n{{define \"footer\"}}\n---\nReport generated by opnDossier\n{{end}}\n</code></pre> <p>Create a specialized template:</p> <pre><code># Security Template (security.md.tmpl)\n{{template \"base\" .}}\n\n{{define \"content\"}}\n## Security Analysis\n{{range .SecurityIssues}}\n### {{.Title}}\n- **Severity**: {{.Severity}}\n- **Description**: {{.Description}}\n- **Recommendation**: {{.Recommendation}}\n{{end}}\n{{end}}\n</code></pre>"},{"location":"examples/advanced-configuration/#theme-customization","title":"Theme Customization","text":""},{"location":"examples/advanced-configuration/#built-in-themes","title":"Built-in Themes","text":"<pre><code># Use light theme\nopnDossier display config.xml --theme light\n\n# Use dark theme\nopnDossier display config.xml --theme dark\n\n# Auto-detect theme\nopnDossier display config.xml --theme auto\n\n# No theme (plain text)\nopnDossier display config.xml --theme none\n</code></pre>"},{"location":"examples/advanced-configuration/#custom-theme-configuration","title":"Custom Theme Configuration","text":"<p>Create a custom theme configuration:</p> <pre><code># ~/.opnDossier/themes/custom.yaml\ncolors:\n  primary: '#2563eb'\n  secondary: '#64748b'\n  success: '#059669'\n  warning: '#d97706'\n  error: '#dc2626'\n  background: '#ffffff'\n  foreground: '#1f2937'\n\nstyles:\n  header:\n    bold: true\n    color: primary\n  subheader:\n    color: secondary\n  success:\n    color: success\n  warning:\n    color: warning\n  error:\n    color: error\n</code></pre>"},{"location":"examples/advanced-configuration/#using-custom-themes","title":"Using Custom Themes","text":"<pre><code># Use custom theme\nopnDossier display config.xml --theme custom\n\n# Create theme-specific output\nopnDossier display config.xml --theme dark --wrap 120\n</code></pre>"},{"location":"examples/advanced-configuration/#section-filtering","title":"Section Filtering","text":""},{"location":"examples/advanced-configuration/#basic-section-filtering","title":"Basic Section Filtering","text":"<pre><code># Display only system information\nopnDossier display config.xml --section system\n\n# Display network and firewall sections\nopnDossier display config.xml --section network,firewall\n\n# Display multiple sections\nopnDossier display config.xml --section system,interfaces,firewall\n</code></pre>"},{"location":"examples/advanced-configuration/#advanced-section-filtering","title":"Advanced Section Filtering","text":"<pre><code># Filter by specific interface\nopnDossier display config.xml --section interfaces.wan,interfaces.lan\n\n# Filter by rule type\nopnDossier display config.xml --section firewall.rules.pass,firewall.rules.block\n\n# Filter by service\nopnDossier display config.xml --section services.dhcp,services.dns\n</code></pre>"},{"location":"examples/advanced-configuration/#section-filtering-with-templates","title":"Section Filtering with Templates","text":"<pre><code># Use custom template with specific sections\nopnDossier convert config.xml \\\n    --template security \\\n    --section system,firewall,security \\\n    -o security-report.md\n</code></pre>"},{"location":"examples/advanced-configuration/#output-formatting","title":"Output Formatting","text":""},{"location":"examples/advanced-configuration/#text-wrapping","title":"Text Wrapping","text":"<pre><code># Set text wrap width\nopnDossier display config.xml --wrap 80\n\n# No text wrapping\nopnDossier display config.xml --wrap 0\n\n# Wide format for large screens\nopnDossier display config.xml --wrap 160\n</code></pre>"},{"location":"examples/advanced-configuration/#custom-output-formats","title":"Custom Output Formats","text":""},{"location":"examples/advanced-configuration/#json-with-custom-structure","title":"JSON with Custom Structure","text":"<pre><code># Convert to JSON with specific structure\nopnDossier convert config.xml -f json | jq '{\n  hostname: .system.hostname,\n  domain: .system.domain,\n  interfaces: .interfaces,\n  rule_count: (.filter.rules | length)\n}'\n</code></pre>"},{"location":"examples/advanced-configuration/#yaml-with-filtering","title":"YAML with Filtering","text":"<pre><code># Convert to YAML with specific sections\nopnDossier convert config.xml -f yaml | yq '.system, .interfaces'\n</code></pre>"},{"location":"examples/advanced-configuration/#advanced-configuration-files","title":"Advanced Configuration Files","text":""},{"location":"examples/advanced-configuration/#comprehensive-configuration","title":"Comprehensive Configuration","text":"<p>Create <code>~/.opnDossier.yaml</code>:</p> <pre><code># Global configuration\nlog_level: info\nlog_format: text\nverbose: false\ntheme: auto\n\n# Output settings\noutput_file: ./network-docs.md\nwrap_width: 120\n\n# Template settings\ntemplate_dir: ~/.opnDossier/templates\ndefault_template: comprehensive\n\n# Security settings\nsecurity_mode: blue\ncomprehensive_reports: true\nplugins: [stig, sans]\n\n# Display settings\nsections: [system, interfaces, firewall, nat]\nexclude_sections: [certificates, vpn]\n\n# Performance settings\nmax_memory: 512MB\ntimeout: 300s\n</code></pre>"},{"location":"examples/advanced-configuration/#environment-specific-configuration","title":"Environment-Specific Configuration","text":"<p>Create <code>~/.opnDossier/production.yaml</code>:</p> <pre><code># Production environment settings\nlog_level: warn\nlog_format: json\noutput_file: /var/www/docs/network-config.md\n\n# Security-focused settings\nsecurity_mode: blue\ncomprehensive_reports: true\nplugins: [stig, sans, firewall]\n\n# Performance settings\nmax_memory: 1GB\ntimeout: 600s\n</code></pre> <p>Create <code>~/.opnDossier/development.yaml</code>:</p> <pre><code># Development environment settings\nlog_level: debug\nlog_format: text\nverbose: true\noutput_file: ./dev-docs.md\n\n# Debug settings\nsecurity_mode: standard\ncomprehensive_reports: false\nplugins: []\n\n# Performance settings\nmax_memory: 256MB\ntimeout: 60s\n</code></pre>"},{"location":"examples/advanced-configuration/#using-environment-specific-configs","title":"Using Environment-Specific Configs","text":"<pre><code># Use production configuration\nopnDossier --config ~/.opnDossier/production.yaml convert config.xml\n\n# Use development configuration\nopnDossier --config ~/.opnDossier/development.yaml convert config.xml\n\n# Override specific settings\nopnDossier --config ~/.opnDossier/production.yaml --log_level=debug convert config.xml\n</code></pre>"},{"location":"examples/advanced-configuration/#plugin-configuration","title":"Plugin Configuration","text":""},{"location":"examples/advanced-configuration/#custom-plugin-configuration","title":"Custom Plugin Configuration","text":"<p>Create plugin configuration:</p> <pre><code># ~/.opnDossier/plugins.yaml\nplugins:\n  stig:\n    enabled: true\n    strict_mode: true\n    custom_controls:\n      - id: STIG-CUSTOM-001\n        title: Custom SSH Configuration\n        description: Custom SSH security requirements\n        severity: high\n        check: ssh_config_check\n\n  sans:\n    enabled: true\n    controls:\n      - CIS-1.1\n      - CIS-1.2\n      - CIS-2.1\n\n  firewall:\n    enabled: true\n    custom_rules:\n      - name: Custom Rule Check\n        description: Check for custom security rules\n        severity: medium\n</code></pre>"},{"location":"examples/advanced-configuration/#using-custom-plugin-configuration","title":"Using Custom Plugin Configuration","text":"<pre><code># Use custom plugin configuration\nopnDossier convert config.xml \\\n    --plugins stig,sans \\\n    --plugin-config ~/.opnDossier/plugins.yaml \\\n    -o compliance-report.md\n</code></pre>"},{"location":"examples/advanced-configuration/#advanced-workflows","title":"Advanced Workflows","text":""},{"location":"examples/advanced-configuration/#multi-format-generation","title":"Multi-Format Generation","text":"<pre><code>#!/bin/bash\n# multi-format-generator.sh\n\nCONFIG_FILE=\"$1\"\nOUTPUT_DIR=\"$2\"\n\n# Create output directory\nmkdir -p \"$OUTPUT_DIR\"\n\n# Generate multiple formats\nopnDossier convert \"$CONFIG_FILE\" -o \"$OUTPUT_DIR/network-config.md\"\nopnDossier convert \"$CONFIG_FILE\" -f json -o \"$OUTPUT_DIR/network-config.json\"\nopnDossier convert \"$CONFIG_FILE\" -f yaml -o \"$OUTPUT_DIR/network-config.yaml\"\n\n# Generate security reports\nopnDossier convert \"$CONFIG_FILE\" \\\n    --mode blue --comprehensive \\\n    --plugins stig,sans \\\n    -o \"$OUTPUT_DIR/security-audit.md\"\n\nopnDossier convert \"$CONFIG_FILE\" \\\n    --mode red --blackhat-mode \\\n    -o \"$OUTPUT_DIR/attack-surface.md\"\n\necho \"Multi-format generation completed in $OUTPUT_DIR\"\n</code></pre>"},{"location":"examples/advanced-configuration/#template-based-workflows","title":"Template-Based Workflows","text":"<pre><code>#!/bin/bash\n# template-workflow.sh\n\nCONFIG_FILE=\"$1\"\nTEMPLATE_DIR=\"$2\"\n\n# Generate executive summary\nopnDossier convert \"$CONFIG_FILE\" \\\n    --template executive \\\n    --template-dir \"$TEMPLATE_DIR\" \\\n    -o executive-summary.md\n\n# Generate technical report\nopnDossier convert \"$CONFIG_FILE\" \\\n    --template technical \\\n    --template-dir \"$TEMPLATE_DIR\" \\\n    -o technical-report.md\n\n# Generate compliance report\nopnDossier convert \"$CONFIG_FILE\" \\\n    --template compliance \\\n    --template-dir \"$TEMPLATE_DIR\" \\\n    --plugins stig,sans \\\n    -o compliance-report.md\n</code></pre>"},{"location":"examples/advanced-configuration/#conditional-processing","title":"Conditional Processing","text":"<pre><code>#!/bin/bash\n# conditional-processing.sh\n\nCONFIG_FILE=\"$1\"\n\n# Check file size\nFILE_SIZE=$(stat -c%s \"$CONFIG_FILE\")\n\nif [ \"$FILE_SIZE\" -gt 1048576 ]; then\n    # Large file - use optimized settings\n    opnDossier convert \"$CONFIG_FILE\" \\\n        --max-memory 1GB \\\n        --timeout 600s \\\n        -o large-config-report.md\nelse\n    # Small file - use standard settings\n    opnDossier convert \"$CONFIG_FILE\" \\\n        --comprehensive \\\n        --plugins stig,sans \\\n        -o standard-report.md\nfi\n</code></pre>"},{"location":"examples/advanced-configuration/#performance-optimization","title":"Performance Optimization","text":""},{"location":"examples/advanced-configuration/#memory-management","title":"Memory Management","text":"<pre><code># Set memory limits\nopnDossier convert config.xml --max-memory 512MB\n\n# Monitor memory usage\n/usr/bin/time -v opnDossier convert config.xml\n\n# Use streaming for large files\nopnDossier convert large-config.xml --streaming\n</code></pre>"},{"location":"examples/advanced-configuration/#parallel-processing","title":"Parallel Processing","text":"<pre><code># Process multiple files in parallel\nfind configs/ -name \"*.xml\" | xargs -P 4 -I {} \\\n    opnDossier convert {} -o docs/{}.md\n\n# Batch processing with parallel execution\nfor config in configs/*.xml; do\n    opnDossier convert \"$config\" -o \"docs/$(basename \"$config\" .xml).md\" &amp;\ndone\nwait\n</code></pre>"},{"location":"examples/advanced-configuration/#caching-and-optimization","title":"Caching and Optimization","text":"<pre><code># Use template caching\nopnDossier convert config.xml \\\n    --template-cache ~/.opnDossier/cache \\\n    --template standard\n\n# Optimize for repeated processing\nopnDossier convert config.xml \\\n    --optimize \\\n    --cache-dir ~/.opnDossier/cache\n</code></pre>"},{"location":"examples/advanced-configuration/#best-practices","title":"Best Practices","text":""},{"location":"examples/advanced-configuration/#1-template-organization","title":"1. Template Organization","text":"<pre><code># Organize templates by purpose\n~/.opnDossier/templates/\n\u251c\u2500\u2500 executive/\n\u2502   \u251c\u2500\u2500 summary.md.tmpl\n\u2502   \u2514\u2500\u2500 dashboard.md.tmpl\n\u251c\u2500\u2500 technical/\n\u2502   \u251c\u2500\u2500 detailed.md.tmpl\n\u2502   \u2514\u2500\u2500 network.md.tmpl\n\u2514\u2500\u2500 compliance/\n    \u251c\u2500\u2500 stig.md.tmpl\n    \u2514\u2500\u2500 sans.md.tmpl\n</code></pre>"},{"location":"examples/advanced-configuration/#2-configuration-management","title":"2. Configuration Management","text":"<pre><code># Use version control for configurations\ngit init ~/.opnDossier\ncd ~/.opnDossier\ngit add .\ngit commit -m \"Initial opnDossier configuration\"\n\n# Use environment-specific configs\nexport OPNDOSSIER_CONFIG=~/.opnDossier/production.yaml\n</code></pre>"},{"location":"examples/advanced-configuration/#3-template-development","title":"3. Template Development","text":"<pre><code># Test templates with sample data\nopnDossier convert test-config.xml --template test-template\n\n# Validate template syntax\nopnDossier convert config.xml --template-dir ./templates --validate-templates\n\n# Use template inheritance for consistency\n# Base template -&gt; Specialized templates\n</code></pre>"},{"location":"examples/advanced-configuration/#4-performance-monitoring","title":"4. Performance Monitoring","text":"<pre><code># Monitor template rendering performance\nopnDossier convert config.xml --template-dir ./templates --profile-templates\n\n# Track memory usage\nopnDossier convert config.xml --memory-profile\n\n# Optimize based on usage patterns\nopnDossier convert config.xml --optimize --cache-results\n</code></pre> <p>Next Steps:</p> <ul> <li>For basic documentation, see Basic Documentation</li> <li>For audit and compliance, see Audit and Compliance</li> <li>For automation, see Automation and Scripting</li> </ul>"},{"location":"examples/audit-compliance/","title":"Audit and Compliance Examples","text":"<p>\u26a0\ufe0f Note: Audit and compliance functionality is not yet implemented in opnDossier v1.0.</p> <p>This documentation describes planned features for future releases. The audit mode flags (<code>--mode</code>, <code>--blackhat-mode</code>, <code>--plugins</code>) are currently disabled and not available in the current version.</p> <p>For current functionality, see the Basic Usage and Advanced Configuration guides.</p> <p>This guide covers security auditing and compliance checking workflows using opnDossier (planned for future releases).</p>"},{"location":"examples/audit-compliance/#security-audit-reports","title":"Security Audit Reports","text":""},{"location":"examples/audit-compliance/#blue-team-audit-reports","title":"Blue Team Audit Reports","text":"<p>Generate defensive security audit reports with findings and recommendations:</p> <pre><code># Basic blue team audit\nopnDossier convert config.xml --mode blue\n\n# Comprehensive blue team audit\nopnDossier convert config.xml --mode blue --comprehensive -o blue-team-audit.md\n\n# Blue team audit with specific plugins\nopnDossier convert config.xml --mode blue --plugins stig,sans -o compliance-audit.md\n\n# Blue team audit with custom template\nopnDossier convert config.xml --mode blue --template-dir ./custom-templates -o custom-audit.md\n</code></pre> <p>Example Blue Team Output:</p> <pre><code># Blue Team Security Audit Report\n\n## Executive Summary\n- **Overall Security Score**: 7.2/10\n- **Critical Findings**: 2\n- **High Priority Issues**: 5\n- **Medium Priority Issues**: 8\n\n## Critical Security Findings\n\n### 1. HTTP Web Management Enabled\n- **Severity**: Critical\n- **Description**: Web management interface is accessible via HTTP\n- **Risk**: Credentials transmitted in cleartext\n- **Recommendation**: Enable HTTPS immediately\n\n### 2. Default SNMP Community\n- **Severity**: Critical\n- **Description**: SNMP using default community string 'public'\n- **Risk**: Unauthorized network access\n- **Recommendation**: Change SNMP community string\n\n## Network Security Analysis\n...\n</code></pre>"},{"location":"examples/audit-compliance/#red-team-recon-reports","title":"Red Team Recon Reports","text":"<p>Generate attacker-focused reconnaissance reports highlighting attack surfaces:</p> <pre><code># Basic red team recon\nopnDossier convert config.xml --mode red\n\n# Red team recon with blackhat commentary\nopnDossier convert config.xml --mode red --blackhat-mode -o red-team-recon.md\n\n# Comprehensive red team analysis\nopnDossier convert config.xml --mode red --comprehensive --blackhat-mode -o attack-surface.md\n</code></pre> <p>Example Red Team Output:</p> <pre><code># Red Team Reconnaissance Report\n\n## Attack Surface Analysis\n\n### Primary Attack Vectors\n\n#### 1. Web Management Interface\n- **Target**: 192.168.1.1:80 (HTTP)\n- **Vulnerability**: Cleartext authentication\n- **Exploitation**: Credential harvesting via man-in-the-middle\n- **Impact**: Full administrative access\n\n#### 2. SNMP Service\n- **Target**: 192.168.1.1:161 (SNMP)\n- **Vulnerability**: Default community string 'public'\n- **Exploitation**: Network enumeration and configuration extraction\n- **Impact**: Network topology discovery\n\n### Network Exposure Analysis\n- **WAN Interfaces**: 1 exposed\n- **LAN Interfaces**: 1 internal\n- **DMZ Interfaces**: 0 configured\n- **VPN Endpoints**: 0 configured\n\n### Firewall Rule Analysis\n- **Permissive Rules**: 3 identified\n- **Any/Any Rules**: 1 identified\n- **Port Exposure**: 80, 161, 22\n</code></pre>"},{"location":"examples/audit-compliance/#compliance-checking","title":"Compliance Checking","text":""},{"location":"examples/audit-compliance/#stig-compliance","title":"STIG Compliance","text":"<p>Check configurations against STIG (Security Technical Implementation Guide) standards:</p> <pre><code># STIG compliance check\nopnDossier convert config.xml --mode blue --plugins stig -o stig-compliance.md\n\n# STIG compliance with comprehensive analysis\nopnDossier convert config.xml --mode blue --plugins stig --comprehensive -o stig-audit.md\n\n# STIG compliance with custom template\nopnDossier convert config.xml --mode blue --plugins stig --template stig-report -o stig-report.md\n</code></pre> <p>Example STIG Output:</p> <pre><code># STIG Compliance Report\n\n## Compliance Summary\n- **Total Controls**: 45\n- **Compliant**: 32\n- **Non-Compliant**: 13\n- **Compliance Rate**: 71.1%\n\n## Critical STIG Violations\n\n### STIG-001: SSH Warning Banner\n- **Status**: Non-Compliant\n- **Requirement**: SSH must display warning banner\n- **Finding**: No SSH warning banner configured\n- **Remediation**: Configure SSH warning banner\n\n### STIG-002: HTTPS Web Management\n- **Status**: Non-Compliant\n- **Requirement**: Web management must use HTTPS\n- **Finding**: HTTP enabled for web management\n- **Remediation**: Disable HTTP, enable HTTPS only\n</code></pre>"},{"location":"examples/audit-compliance/#sans-compliance","title":"SANS Compliance","text":"<p>Check configurations against SANS security controls:</p> <pre><code># SANS compliance check\nopnDossier convert config.xml --mode blue --plugins sans -o sans-compliance.md\n\n# SANS compliance with comprehensive analysis\nopnDossier convert config.xml --mode blue --plugins sans --comprehensive -o sans-audit.md\n\n# Multiple compliance frameworks\nopnDossier convert config.xml --mode blue --plugins stig,sans -o multi-compliance.md\n</code></pre> <p>Example SANS Output:</p> <pre><code># SANS Critical Security Controls Report\n\n## Control Coverage Analysis\n\n### Control 1: Inventory and Control of Hardware Assets\n- **Status**: Partially Compliant\n- **Coverage**: 75%\n- **Findings**: Network interfaces properly documented\n- **Gaps**: Missing hardware asset tracking\n\n### Control 4: Controlled Access Based on Need to Know\n- **Status**: Non-Compliant\n- **Coverage**: 40%\n- **Findings**: Basic access controls in place\n- **Gaps**: Missing role-based access controls\n</code></pre>"},{"location":"examples/audit-compliance/#advanced-audit-workflows","title":"Advanced Audit Workflows","text":""},{"location":"examples/audit-compliance/#comprehensive-security-assessment","title":"Comprehensive Security Assessment","text":"<pre><code>#!/bin/bash\n# comprehensive-audit.sh\n\n# Set up environment\nexport OPNDOSSIER_LOG_FORMAT=json\nexport OPNDOSSIER_LOG_LEVEL=info\n\n# Create audit directory\nAUDIT_DIR=\"audits/$(date +%Y-%m-%d)\"\nmkdir -p \"$AUDIT_DIR\"\n\n# Generate blue team audit\necho \"Generating blue team audit...\"\nopnDossier convert config.xml --mode blue --comprehensive \\\n    --plugins stig,sans \\\n    -o \"${AUDIT_DIR}/blue-team-audit.md\"\n\n# Generate red team recon\necho \"Generating red team recon...\"\nopnDossier convert config.xml --mode red --comprehensive \\\n    --blackhat-mode \\\n    -o \"${AUDIT_DIR}/red-team-recon.md\"\n\n# Generate compliance report\necho \"Generating compliance report...\"\nopnDossier convert config.xml --mode blue \\\n    --plugins stig,sans \\\n    --template compliance \\\n    -o \"${AUDIT_DIR}/compliance-report.md\"\n\necho \"Comprehensive audit completed in ${AUDIT_DIR}\"\n</code></pre>"},{"location":"examples/audit-compliance/#automated-compliance-pipeline","title":"Automated Compliance Pipeline","text":"<pre><code>#!/bin/bash\n# compliance-pipeline.sh\n\nset -e\n\n# Configuration\nCONFIG_FILE=\"config.xml\"\nCOMPLIANCE_DIR=\"compliance-reports\"\nTIMESTAMP=$(date +%Y-%m-%d_%H-%M-%S)\n\n# Create compliance directory\nmkdir -p \"$COMPLIANCE_DIR\"\n\n# Validate configuration first\necho \"Validating configuration...\"\nif ! opnDossier validate \"$CONFIG_FILE\"; then\n    echo \"Configuration validation failed\"\n    exit 1\nfi\n\n# Generate STIG compliance report\necho \"Generating STIG compliance report...\"\nopnDossier convert \"$CONFIG_FILE\" \\\n    --mode blue \\\n    --plugins stig \\\n    --comprehensive \\\n    -o \"${COMPLIANCE_DIR}/stig-${TIMESTAMP}.md\"\n\n# Generate SANS compliance report\necho \"Generating SANS compliance report...\"\nopnDossier convert \"$CONFIG_FILE\" \\\n    --mode blue \\\n    --plugins sans \\\n    --comprehensive \\\n    -o \"${COMPLIANCE_DIR}/sans-${TIMESTAMP}.md\"\n\n# Generate combined compliance report\necho \"Generating combined compliance report...\"\nopnDossier convert \"$CONFIG_FILE\" \\\n    --mode blue \\\n    --plugins stig,sans \\\n    --comprehensive \\\n    -o \"${COMPLIANCE_DIR}/combined-${TIMESTAMP}.md\"\n\n# Generate executive summary\necho \"Generating executive summary...\"\nopnDossier convert \"$CONFIG_FILE\" \\\n    --mode blue \\\n    --plugins stig,sans \\\n    --template executive \\\n    -o \"${COMPLIANCE_DIR}/executive-summary-${TIMESTAMP}.md\"\n\necho \"Compliance pipeline completed successfully\"\n</code></pre>"},{"location":"examples/audit-compliance/#security-score-tracking","title":"Security Score Tracking","text":"<pre><code>#!/bin/bash\n# security-score-tracker.sh\n\n# Extract security scores from audit reports\nextract_security_score() {\n    local report_file=\"$1\"\n    if [ ! -f \"$report_file\" ]; then\n        echo \"Error: Report file $report_file not found\" &gt;&amp;2\n        return 1\n    fi\n\n    # Try multiple patterns to find security score\n    local score=$(grep -i -o \"Security Score.*[0-9.]*\" \"$report_file\" | grep -o \"[0-9.]*\" | head -1)\n    if [ -z \"$score\" ]; then\n        score=$(grep -i -o \"Overall Security Score.*[0-9.]*\" \"$report_file\" | grep -o \"[0-9.]*\" | head -1)\n    fi\n\n    echo \"$score\"\n}\n\n# Extract STIG compliance scores from audit reports\nextract_stig_score() {\n    local report_file=\"$1\"\n    if [ ! -f \"$report_file\" ]; then\n        echo \"Error: Report file $report_file not found\" &gt;&amp;2\n        return 1\n    fi\n\n    # Try multiple patterns to find STIG compliance\n    local score=$(grep -i -o \"STIG Compliance.*[0-9.]*%\" \"$report_file\" | grep -o \"[0-9.]*\" | head -1)\n    if [ -z \"$score\" ]; then\n        score=$(grep -i -o \"STIG.*[0-9.]*%\" \"$report_file\" | grep -o \"[0-9.]*\" | head -1)\n    fi\n\n    echo \"$score\"\n}\n\n# Extract SANS compliance scores from audit reports\nextract_sans_score() {\n    local report_file=\"$1\"\n    if [ ! -f \"$report_file\" ]; then\n        echo \"Error: Report file $report_file not found\" &gt;&amp;2\n        return 1\n    fi\n\n    # Try multiple patterns to find SANS compliance\n    local score=$(grep -i -o \"SANS Compliance.*[0-9.]*%\" \"$report_file\" | grep -o \"[0-9.]*\" | head -1)\n    if [ -z \"$score\" ]; then\n        score=$(grep -i -o \"SANS.*[0-9.]*%\" \"$report_file\" | grep -o \"[0-9.]*\" | head -1)\n    fi\n\n    echo \"$score\"\n}\n\n# Generate audit report\nopnDossier convert config.xml --mode blue --comprehensive -o current-audit.md\n\n# Extract and log security score\nSCORE=$(extract_security_score current-audit.md)\nDATE=$(date +%Y-%m-%d)\n\nif [ -n \"$SCORE\" ]; then\n    echo \"$DATE,$SCORE\" &gt;&gt; security-scores.csv\n    echo \"Security score for $DATE: $SCORE/10\"\nelse\n    echo \"Warning: Could not extract security score from report\" &gt;&amp;2\nfi\n</code></pre>"},{"location":"examples/audit-compliance/#custom-audit-templates","title":"Custom Audit Templates","text":""},{"location":"examples/audit-compliance/#executive-summary-template","title":"Executive Summary Template","text":"<p>Create <code>~/.opnDossier/templates/executive.md.tmpl</code>:</p> <pre><code># Executive Security Summary\n\n## Key Metrics\n- **Overall Security Score**: {{.SecurityScore}}/10\n- **Critical Issues**: {{.CriticalCount}}\n- **High Priority Issues**: {{.HighCount}}\n- **Compliance Rate**: {{.ComplianceRate}}%\n\n## Top 3 Critical Issues\n{{range .TopIssues}}\n### {{.Title}}\n- **Severity**: {{.Severity}}\n- **Impact**: {{.Impact}}\n- **Recommendation**: {{.Recommendation}}\n{{end}}\n\n## Compliance Status\n- **STIG Compliance**: {{.STIGCompliance}}%\n- **SANS Compliance**: {{.SANSCompliance}}%\n\n## Next Steps\n1. Address critical security issues immediately\n2. Implement recommended controls\n3. Schedule follow-up assessment\n</code></pre>"},{"location":"examples/audit-compliance/#technical-deep-dive-template","title":"Technical Deep Dive Template","text":"<p>Create <code>~/.opnDossier/templates/technical.md.tmpl</code>:</p> <pre><code># Technical Security Analysis\n\n## Network Architecture\n{{range .Interfaces}}\n### {{.Name}} Interface\n- **IP Address**: {{.IPAddress}}\n- **Subnet**: {{.Subnet}}\n- **Security Level**: {{.SecurityLevel}}\n- **Exposed Services**: {{.ExposedServices}}\n{{end}}\n\n## Firewall Rule Analysis\n{{range .FirewallRules}}\n### Rule {{.Number}}: {{.Description}}\n- **Action**: {{.Action}}\n- **Interface**: {{.Interface}}\n- **Source**: {{.Source}}\n- **Destination**: {{.Destination}}\n- **Security Risk**: {{.SecurityRisk}}\n{{end}}\n\n## Vulnerability Assessment\n{{range .Vulnerabilities}}\n### {{.Title}}\n- **CVE**: {{.CVE}}\n- **CVSS Score**: {{.CVSSScore}}\n- **Description**: {{.Description}}\n- **Remediation**: {{.Remediation}}\n{{end}}\n</code></pre>"},{"location":"examples/audit-compliance/#integration-examples","title":"Integration Examples","text":""},{"location":"examples/audit-compliance/#cicd-security-gate","title":"CI/CD Security Gate","text":"<pre><code># .github/workflows/security-gate.yml\nname: Security Compliance Check\non: [push, pull_request]\n\njobs:\n  security-audit:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v3\n\n      - name: Setup Go\n        uses: actions/setup-go@v3\n        with:\n          go-version: '1.21'\n\n      - name: Install opnDossier\n        run: go install github.com/EvilBit-Labs/opnDossier@latest\n\n      - name: Run Security Audit\n        run: |\n          opnDossier convert config.xml --mode blue --plugins stig,sans -o security-audit.md\n\n      - name: Check Security Score\n        run: |\n          SCORE=$(grep -o \"Security Score.*[0-9.]*\" security-audit.md | grep -o \"[0-9.]*\" | head -1)\n          if (( $(echo \"$SCORE &lt; 7.0\" | bc -l) )); then\n            echo \"Security score $SCORE is below threshold of 7.0\"\n            exit 1\n          fi\n\n      - name: Upload Audit Report\n        uses: actions/upload-artifact@v3\n        with:\n          name: security-audit\n          path: security-audit.md\n</code></pre>"},{"location":"examples/audit-compliance/#monthly-compliance-reporting","title":"Monthly Compliance Reporting","text":"<pre><code>#!/bin/bash\n# monthly-compliance-report.sh\n\n# Set up environment\nexport OPNDOSSIER_LOG_FORMAT=json\nexport OPNDOSSIER_LOG_LEVEL=info\n\n# Create monthly report directory\nMONTH=$(date +%Y-%m)\nREPORT_DIR=\"reports/${MONTH}\"\nmkdir -p \"$REPORT_DIR\"\n\n# Generate comprehensive compliance report\nopnDossier convert config.xml \\\n    --mode blue \\\n    --plugins stig,sans \\\n    --comprehensive \\\n    --template monthly-report \\\n    -o \"${REPORT_DIR}/compliance-report.md\"\n\n# Generate executive summary\nopnDossier convert config.xml \\\n    --mode blue \\\n    --plugins stig,sans \\\n    --template executive \\\n    -o \"${REPORT_DIR}/executive-summary.md\"\n\n# Generate trend analysis\nif [ -f \"reports/previous-month/compliance-report.md\" ]; then\n    echo \"Generating trend analysis...\"\n    # Compare with previous month\n    diff \"reports/previous-month/compliance-report.md\" \"${REPORT_DIR}/compliance-report.md\" &gt; \"${REPORT_DIR}/changes.md\"\nfi\n\necho \"Monthly compliance report generated in ${REPORT_DIR}\"\n</code></pre>"},{"location":"examples/audit-compliance/#best-practices","title":"Best Practices","text":""},{"location":"examples/audit-compliance/#1-regular-audit-scheduling","title":"1. Regular Audit Scheduling","text":"<pre><code># Add to crontab for weekly audits\n0 2 * * 1 /path/to/weekly-audit.sh\n\n# Add to crontab for monthly compliance reports\n0 3 1 * * /path/to/monthly-compliance-report.sh\n</code></pre>"},{"location":"examples/audit-compliance/#2-audit-result-tracking","title":"2. Audit Result Tracking","text":"<pre><code># Track security scores over time\necho \"$(date +%Y-%m-%d),$(extract_security_score audit.md)\" &gt;&gt; security-trends.csv\n\n# Generate trend analysis\ngnuplot -e \"set datafile separator ','; plot 'security-trends.csv' using 1:2 with lines\"\n</code></pre>"},{"location":"examples/audit-compliance/#3-remediation-tracking","title":"3. Remediation Tracking","text":"<pre><code># Extract remediation items\ngrep -A 5 \"Recommendation\" audit.md &gt; remediation-list.md\n\n# Track remediation progress\necho \"Remediation items extracted to remediation-list.md\"\n</code></pre>"},{"location":"examples/audit-compliance/#4-compliance-thresholds","title":"4. Compliance Thresholds","text":"<pre><code># Set minimum compliance thresholds\nMIN_STIG_SCORE=80\nMIN_SANS_SCORE=75\n\n# Check thresholds\nSTIG_SCORE=$(extract_stig_score audit.md)\nSANS_SCORE=$(extract_sans_score audit.md)\n\nif [ \"$STIG_SCORE\" -lt \"$MIN_STIG_SCORE\" ] || [ \"$SANS_SCORE\" -lt \"$MIN_SANS_SCORE\" ]; then\n    echo \"Compliance thresholds not met\"\n    exit 1\nfi\n</code></pre>"},{"location":"examples/audit-compliance/#5-complete-score-tracking-example","title":"5. Complete Score Tracking Example","text":"<pre><code>#!/bin/bash\n# complete-score-tracking.sh\n\n# Configuration\nREPORT_FILE=\"audit-report.md\"\nSCORES_FILE=\"compliance-scores.csv\"\nTIMESTAMP=$(date +%Y-%m-%d)\n\n# Generate comprehensive audit report\necho \"Generating audit report...\"\nopnDossier convert config.xml \\\n    --mode blue \\\n    --plugins stig,sans \\\n    --comprehensive \\\n    -o \"$REPORT_FILE\"\n\n# Extract all scores\nSECURITY_SCORE=$(extract_security_score \"$REPORT_FILE\")\nSTIG_SCORE=$(extract_stig_score \"$REPORT_FILE\")\nSANS_SCORE=$(extract_sans_score \"$REPORT_FILE\")\n\n# Log scores to CSV file\nif [ -n \"$SECURITY_SCORE\" ] &amp;&amp; [ -n \"$STIG_SCORE\" ] &amp;&amp; [ -n \"$SANS_SCORE\" ]; then\n    echo \"$TIMESTAMP,$SECURITY_SCORE,$STIG_SCORE,$SANS_SCORE\" &gt;&gt; \"$SCORES_FILE\"\n    echo \"Scores logged: Security=$SECURITY_SCORE, STIG=$STIG_SCORE%, SANS=$SANS_SCORE%\"\nelse\n    echo \"Warning: Could not extract all scores from report\" &gt;&amp;2\n    exit 1\nfi\n\n# Check compliance thresholds\nMIN_SECURITY=7.0\nMIN_STIG=80\nMIN_SANS=75\n\nFAILURES=0\n\nif (( $(echo \"$SECURITY_SCORE &lt; $MIN_SECURITY\" | bc -l) )); then\n    echo \"Security score $SECURITY_SCORE is below threshold $MIN_SECURITY\"\n    FAILURES=$((FAILURES + 1))\nfi\n\nif [ \"$STIG_SCORE\" -lt \"$MIN_STIG\" ]; then\n    echo \"STIG score $STIG_SCORE% is below threshold $MIN_STIG%\"\n    FAILURES=$((FAILURES + 1))\nfi\n\nif [ \"$SANS_SCORE\" -lt \"$MIN_SANS\" ]; then\n    echo \"SANS score $SANS_SCORE% is below threshold $MIN_SANS%\"\n    FAILURES=$((FAILURES + 1))\nfi\n\nif [ $FAILURES -gt 0 ]; then\n    echo \"Compliance check failed with $FAILURES violations\"\n    exit 1\nelse\n    echo \"All compliance thresholds met\"\nfi\n</code></pre> <p>Next Steps:</p> <ul> <li>For automation workflows, see Automation and Scripting</li> <li>For troubleshooting, see Troubleshooting</li> <li>For advanced configuration, see Advanced Configuration</li> </ul>"},{"location":"examples/automation-scripting/","title":"Automation and Scripting Examples","text":"<p>\u26a0\ufe0f Note: Some examples in this guide reference audit functionality that is not yet implemented in opnDossier v1.0.</p> <p>Examples using <code>--mode</code>, <code>--blackhat-mode</code>, and <code>--plugins</code> flags are for future releases. These flags are currently disabled and not available in the current version.</p> <p>This guide covers automation workflows and scripting examples for integrating opnDossier into CI/CD pipelines and automated processes.</p>"},{"location":"examples/automation-scripting/#cicd-integration","title":"CI/CD Integration","text":""},{"location":"examples/automation-scripting/#github-actions-workflow","title":"GitHub Actions Workflow","text":"<pre><code># .github/workflows/documentation.yml\nname: Generate Documentation\non:\n  push:\n    branches: [main]\n  pull_request:\n    branches: [main]\n\njobs:\n  generate-docs:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n\n      - name: Setup Go\n        uses: actions/setup-go@v5\n        with:\n          go-version: '1.24'\n\n      - name: Install opnDossier\n        run: go install github.com/EvilBit-Labs/opnDossier@latest\n\n      - name: Generate Documentation\n        env:\n          OPNDOSSIER_LOG_FORMAT: json\n          OPNDOSSIER_LOG_LEVEL: info\n        run: |\n          opnDossier convert config.xml -o docs/network-config.md\n\n      - name: Generate Security Audit\n        run: |\n          opnDossier convert config.xml --mode blue --comprehensive -o docs/security-audit.md\n\n      - name: Commit Documentation\n        if: github.event_name == 'push'\n        run: |\n          git config --local user.email \"action@github.com\"\n          git config --local user.name \"GitHub Action\"\n          git add docs/network-config.md docs/security-audit.md\n          git commit -m \"docs: update network configuration and security audit\" || exit 0\n          git push\n</code></pre>"},{"location":"examples/automation-scripting/#gitlab-ci-pipeline","title":"GitLab CI Pipeline","text":"<pre><code># .gitlab-ci.yml\nstages:\n  - documentation\n  - security\n\nvariables:\n  OPNDOSSIER_LOG_FORMAT: json\n  OPNDOSSIER_LOG_LEVEL: info\n\ndocumentation:\n  stage: documentation\n  image: golang:1.24\n  before_script:\n    - go install github.com/EvilBit-Labs/opnDossier@latest\n  script:\n    - opnDossier validate config.xml\n    - opnDossier convert config.xml -o docs/network-config.md\n    - opnDossier convert config.xml -f json -o docs/network-config.json\n  artifacts:\n    paths:\n      - docs/network-config.md\n      - docs/network-config.json\n    expire_in: 30 days\n\nsecurity-audit:\n  stage: security\n  image: golang:1.24\n  before_script:\n    - go install github.com/EvilBit-Labs/opnDossier@latest\n  script:\n    - opnDossier convert config.xml --mode blue --comprehensive -o \n      docs/security-audit.md\n    - opnDossier convert config.xml --mode red --blackhat-mode -o \n      docs/attack-surface.md\n  artifacts:\n    paths:\n      - docs/security-audit.md\n      - docs/attack-surface.md\n    expire_in: 30 days\n</code></pre>"},{"location":"examples/automation-scripting/#jenkins-pipeline","title":"Jenkins Pipeline","text":"<pre><code>// Jenkinsfile\npipeline {\n    agent any\n\n    environment {\n        OPNDOSSIER_LOG_FORMAT = 'json'\n        OPNDOSSIER_LOG_LEVEL = 'info'\n    }\n\n    stages {\n        stage('Setup') {\n            steps {\n                sh 'go install github.com/EvilBit-Labs/opnDossier@latest'\n            }\n        }\n\n        stage('Validate') {\n            steps {\n                sh 'opnDossier validate config.xml'\n            }\n        }\n\n        stage('Generate Documentation') {\n            steps {\n                sh 'opnDossier convert config.xml -o docs/network-config.md'\n                sh 'opnDossier convert config.xml -f json -o docs/network-config.json'\n            }\n        }\n\n        stage('Security Audit') {\n            steps {\n                sh 'opnDossier convert config.xml --mode blue --comprehensive -o docs/security-audit.md'\n            }\n        }\n\n        stage('Archive') {\n            steps {\n                archiveArtifacts artifacts: 'docs/*.md,docs/*.json', fingerprint: true\n            }\n        }\n    }\n\n    post {\n        always {\n            cleanWs()\n        }\n    }\n}\n</code></pre>"},{"location":"examples/automation-scripting/#batch-processing-scripts","title":"Batch Processing Scripts","text":""},{"location":"examples/automation-scripting/#process-multiple-configurations","title":"Process Multiple Configurations","text":"<pre><code>#!/bin/bash\n# batch-process.sh\n\nset -e\n\n# Configuration\nINPUT_DIR=\"configs\"\nOUTPUT_DIR=\"docs\"\nLOG_FILE=\"batch-process.log\"\n\n# Create output directory\nmkdir -p \"$OUTPUT_DIR\"\n\n# Initialize log file\necho \"Batch processing started at $(date)\" &gt; \"$LOG_FILE\"\n\n# Process all XML files\nfor config_file in \"$INPUT_DIR\"/*.xml; do\n    if [ -f \"$config_file\" ]; then\n        filename=$(basename \"$config_file\" .xml)\n        echo \"Processing $filename...\" | tee -a \"$LOG_FILE\"\n\n        # Validate configuration\n        if opnDossier validate \"$config_file\" &gt;&gt; \"$LOG_FILE\" 2&gt;&amp;1; then\n            # Generate documentation\n            opnDossier convert \"$config_file\" -o \"$OUTPUT_DIR/${filename}.md\" &gt;&gt; \"$LOG_FILE\" 2&gt;&amp;1\n            echo \"\u2713 $filename processed successfully\" | tee -a \"$LOG_FILE\"\n        else\n            echo \"\u2717 $filename validation failed\" | tee -a \"$LOG_FILE\"\n        fi\n    fi\ndone\n\necho \"Batch processing completed at $(date)\" | tee -a \"$LOG_FILE\"\n</code></pre>"},{"location":"examples/automation-scripting/#parallel-processing","title":"Parallel Processing","text":"<pre><code>#!/bin/bash\n# parallel-process.sh\n\n# Configuration\nINPUT_DIR=\"configs\"\nOUTPUT_DIR=\"docs\"\nMAX_JOBS=4\n\n# Function to process a single file\nprocess_file() {\n    local config_file=\"$1\"\n    local filename=$(basename \"$config_file\" .xml)\n\n    echo \"Processing $filename...\"\n\n    if opnDossier validate \"$config_file\" &gt; /dev/null 2&gt;&amp;1; then\n        opnDossier convert \"$config_file\" -o \"$OUTPUT_DIR/${filename}.md\" &gt; /dev/null 2&gt;&amp;1\n        echo \"\u2713 $filename completed\"\n    else\n        echo \"\u2717 $filename failed validation\"\n        return 1\n    fi\n}\n\n# Export function for parallel execution\nexport -f process_file\n\n# Create output directory\nmkdir -p \"$OUTPUT_DIR\"\n\n# Process files in parallel\nfind \"$INPUT_DIR\" -name \"*.xml\" | xargs -P \"$MAX_JOBS\" -I {} bash -c 'process_file \"$@\"' _ {}\n</code></pre>"},{"location":"examples/automation-scripting/#scheduled-processing","title":"Scheduled Processing","text":"<pre><code>#!/bin/bash\n# scheduled-process.sh\n\n# Configuration\nCONFIG_DIR=\"/etc/opnsense\"\nBACKUP_DIR=\"/backups/configs\"\nDOCS_DIR=\"/var/www/docs\"\nRETENTION_DAYS=30\n\n# Create directories\nmkdir -p \"$BACKUP_DIR\" \"$DOCS_DIR\"\n\n# Get current timestamp\nTIMESTAMP=$(date +%Y-%m-%d_%H-%M-%S)\n\n# Backup current configuration\ncp \"$CONFIG_DIR/config.xml\" \"$BACKUP_DIR/config-${TIMESTAMP}.xml\"\n\n# Generate documentation\nopnDossier convert \"$CONFIG_DIR/config.xml\" -o \"$DOCS_DIR/current-config.md\"\n\n# Generate security audit\nopnDossier convert \"$CONFIG_DIR/config.xml\" \\\n    --mode blue --comprehensive \\\n    -o \"$DOCS_DIR/security-audit.md\"\n\n# Clean up old backups\nfind \"$BACKUP_DIR\" -name \"config-*.xml\" -mtime +$RETENTION_DAYS -delete\n\necho \"Scheduled processing completed at $(date)\"\n</code></pre>"},{"location":"examples/automation-scripting/#automated-documentation","title":"Automated Documentation","text":""},{"location":"examples/automation-scripting/#daily-documentation-update","title":"Daily Documentation Update","text":"<pre><code>#!/bin/bash\n# daily-docs.sh\n\n# Configuration\nCONFIG_FILE=\"/etc/opnsense/config.xml\"\nDOCS_DIR=\"/var/www/network-docs\"\nWEBHOOK_URL=\"https://hooks.slack.com/services/YOUR/WEBHOOK/URL\"\n\n# Set up environment\nexport OPNDOSSIER_LOG_FORMAT=json\nexport OPNDOSSIER_LOG_LEVEL=info\n\n# Create documentation directory\nmkdir -p \"$DOCS_DIR\"\n\n# Get current date\nDATE=$(date +%Y-%m-%d)\n\n# Validate configuration\nif ! opnDossier validate \"$CONFIG_FILE\"; then\n    echo \"Configuration validation failed\"\n    curl -X POST -H 'Content-type: application/json' \\\n        --data \"{\\\"text\\\":\\\"\u274c Daily documentation update failed: Configuration validation error\\\"}\" \\\n        \"$WEBHOOK_URL\"\n    exit 1\nfi\n\n# Generate documentation\nif opnDossier convert \"$CONFIG_FILE\" -o \"$DOCS_DIR/network-config-${DATE}.md\"; then\n    echo \"Documentation generated successfully\"\n\n    # Send success notification\n    curl -X POST -H 'Content-type: application/json' \\\n        --data \"{\\\"text\\\":\\\"\u2705 Daily documentation updated: network-config-${DATE}.md\\\"}\" \\\n        \"$WEBHOOK_URL\"\nelse\n    echo \"Documentation generation failed\"\n\n    # Send failure notification\n    curl -X POST -H 'Content-type: application/json' \\\n        --data \"{\\\"text\\\":\\\"\u274c Daily documentation update failed: Generation error\\\"}\" \\\n        \"$WEBHOOK_URL\"\n    exit 1\nfi\n</code></pre>"},{"location":"examples/automation-scripting/#configuration-change-detection","title":"Configuration Change Detection","text":"<pre><code>#!/bin/bash\n# config-change-detector.sh\n\n# Configuration\nCONFIG_FILE=\"/etc/opnsense/config.xml\"\nPREVIOUS_HASH_FILE=\"/tmp/config.hash\"\nWEBHOOK_URL=\"https://hooks.slack.com/services/YOUR/WEBHOOK/URL\"\n\n# Calculate current hash\nCURRENT_HASH=$(sha256sum \"$CONFIG_FILE\" | cut -d' ' -f1)\n\n# Check if hash file exists\nif [ -f \"$PREVIOUS_HASH_FILE\" ]; then\n    PREVIOUS_HASH=$(cat \"$PREVIOUS_HASH_FILE\")\n\n    # Compare hashes\n    if [ \"$CURRENT_HASH\" != \"$PREVIOUS_HASH\" ]; then\n        echo \"Configuration change detected\"\n\n        # Generate updated documentation\n        opnDossier convert \"$CONFIG_FILE\" -o \"/var/www/network-docs/network-config-$(date +%Y-%m-%d_%H-%M-%S).md\"\n\n        # Generate diff report\n        opnDossier convert \"$CONFIG_FILE\" -f json -o \"/tmp/current-config.json\"\n\n        # Send notification\n        curl -X POST -H 'Content-type: application/json' \\\n            --data \"{\\\"text\\\":\\\"\ud83d\udd04 Configuration change detected. New documentation generated.\\\"}\" \\\n            \"$WEBHOOK_URL\"\n    fi\nfi\n\n# Update hash file\necho \"$CURRENT_HASH\" &gt; \"$PREVIOUS_HASH_FILE\"\n</code></pre>"},{"location":"examples/automation-scripting/#monitoring-and-alerting","title":"Monitoring and Alerting","text":""},{"location":"examples/automation-scripting/#health-check-script","title":"Health Check Script","text":"<pre><code>#!/bin/bash\n# health-check.sh\n\n# Configuration\nCONFIG_FILE=\"/etc/opnsense/config.xml\"\nALERT_EMAIL=\"admin@example.com\"\nLOG_FILE=\"/var/log/opndossier-health.log\"\n\n# Function to send alert\nsend_alert() {\n    local message=\"$1\"\n    echo \"$(date): $message\" &gt;&gt; \"$LOG_FILE\"\n    echo \"$message\" | mail -s \"opnDossier Health Alert\" \"$ALERT_EMAIL\"\n}\n\n# Check if configuration file exists\nif [ ! -f \"$CONFIG_FILE\" ]; then\n    send_alert \"Configuration file not found: $CONFIG_FILE\"\n    exit 1\nfi\n\n# Validate configuration\nif ! opnDossier validate \"$CONFIG_FILE\" &gt; /dev/null 2&gt;&amp;1; then\n    send_alert \"Configuration validation failed\"\n    exit 1\nfi\n\n# Test documentation generation\nif ! opnDossier convert \"$CONFIG_FILE\" -o /tmp/test.md &gt; /dev/null 2&gt;&amp;1; then\n    send_alert \"Documentation generation failed\"\n    exit 1\nfi\n\n# Clean up test file\nrm -f /tmp/test.md\n\necho \"$(date): Health check passed\" &gt;&gt; \"$LOG_FILE\"\n</code></pre>"},{"location":"examples/automation-scripting/#performance-monitoring","title":"Performance Monitoring","text":"<pre><code>#!/bin/bash\n# performance-monitor.sh\n\n# Configuration\nCONFIG_FILE=\"/etc/opnsense/config.xml\"\nMETRICS_FILE=\"/var/log/opndossier-metrics.log\"\n\n# Function to measure execution time\nmeasure_time() {\n    local start_time=$(date +%s.%N)\n    \"$@\"\n    local end_time=$(date +%s.%N)\n    echo \"$(echo \"$end_time - $start_time\" | bc)\"\n}\n\n# Measure validation time\nVALIDATION_TIME=$(measure_time opnDossier validate \"$CONFIG_FILE\")\n\n# Measure conversion time\nCONVERSION_TIME=$(measure_time opnDossier convert \"$CONFIG_FILE\" -o /tmp/test.md)\n\n# Get file size\nFILE_SIZE=$(stat -c%s \"$CONFIG_FILE\")\n\n# Log metrics\necho \"$(date),$FILE_SIZE,$VALIDATION_TIME,$CONVERSION_TIME\" &gt;&gt; \"$METRICS_FILE\"\n\n# Clean up\nrm -f /tmp/test.md\n\necho \"Metrics logged: File size: ${FILE_SIZE} bytes, Validation: ${VALIDATION_TIME}s, Conversion: ${CONVERSION_TIME}s\"\n</code></pre>"},{"location":"examples/automation-scripting/#integration-examples","title":"Integration Examples","text":""},{"location":"examples/automation-scripting/#ansible-playbook","title":"Ansible Playbook","text":"<pre><code>  - name: Generate opnDossier Documentation\n    hosts: firewalls\n    become: yes\n    tasks:\n      - name: Install Go\n        package:\n          name: golang\n          state: present\n\n      - name: Install opnDossier\n        shell: go install github.com/EvilBit-Labs/opnDossier@latest\n        environment:\n          PATH: '{{ ansible_env.PATH }}:/root/go/bin'\n\n      - name: Create documentation directory\n        file:\n          path: /var/www/network-docs\n          state: directory\n          mode: '0755'\n\n      - name: Generate documentation\n        shell: opnDossier convert /etc/opnsense/config.xml -o \n          /var/www/network-docs/network-config.md\n        environment:\n          PATH: '{{ ansible_env.PATH }}:/root/go/bin'\n\n      - name: Generate security audit\n        shell: opnDossier convert /etc/opnsense/config.xml --mode blue \n          --comprehensive -o /var/www/network-docs/security-audit.md\n        environment:\n          PATH: '{{ ansible_env.PATH }}:/root/go/bin'\n\n      - name: Set file permissions\n        file:\n          path: /var/www/network-docs\n          state: directory\n          mode: '0755'\n          recurse: yes\n</code></pre>"},{"location":"examples/automation-scripting/#docker-integration","title":"Docker Integration","text":"<pre><code># Dockerfile\nFROM golang:1.24-alpine\n\n# Install opnDossier\nRUN go install github.com/EvilBit-Labs/opnDossier@latest\n\n# Create working directory\nWORKDIR /app\n\n# Copy configuration files\nCOPY configs/ ./configs/\n\n# Create output directory\nRUN mkdir -p ./docs\n\n# Generate documentation\nRUN opnDossier convert ./configs/config.xml -o ./docs/network-config.md\n\n# Expose documentation\nEXPOSE 8080\n\n# Serve documentation\nCMD [\"python3\", \"-m\", \"http.server\", \"8080\"]\n</code></pre>"},{"location":"examples/automation-scripting/#kubernetes-job","title":"Kubernetes Job","text":"<pre><code># opndossier-job.yaml\napiVersion: batch/v1\nkind: Job\nmetadata:\n  name: opndossier-docs\nspec:\n  template:\n    spec:\n      containers:\n        - name: opndossier\n          image: golang:1.24\n          command:\n            - /bin/bash\n            - -c\n            - |\n              go install github.com/EvilBit-Labs/opnDossier@latest\n              opnDossier convert /configs/config.xml -o /docs/network-config.md\n              opnDossier convert /configs/config.xml --mode blue --comprehensive -o /docs/security-audit.md\n          volumeMounts:\n            - name: configs\n              mountPath: /configs\n            - name: docs\n              mountPath: /docs\n      volumes:\n        - name: configs\n          configMap:\n            name: firewall-config\n        - name: docs\n          persistentVolumeClaim:\n            claimName: docs-pvc\n      restartPolicy: Never\n  backoffLimit: 3\n</code></pre>"},{"location":"examples/automation-scripting/#best-practices","title":"Best Practices","text":""},{"location":"examples/automation-scripting/#1-error-handling","title":"1. Error Handling","text":"<pre><code>#!/bin/bash\n# robust-automation.sh\n\nset -e  # Exit on any error\n\n# Function to handle errors\nerror_handler() {\n    local exit_code=$?\n    echo \"Error occurred in line $1, exit code: $exit_code\"\n    # Send alert or log error\n    exit $exit_code\n}\n\n# Set error handler\ntrap 'error_handler $LINENO' ERR\n\n# Your automation logic here\nopnDossier validate config.xml\nopnDossier convert config.xml -o docs/network-config.md\n</code></pre>"},{"location":"examples/automation-scripting/#2-logging-and-monitoring","title":"2. Logging and Monitoring","text":"<pre><code>#!/bin/bash\n# monitored-automation.sh\n\n# Configuration\nLOG_FILE=\"/var/log/opndossier-automation.log\"\nMETRICS_FILE=\"/var/log/opndossier-metrics.log\"\n\n# Function to log with timestamp\nlog() {\n    echo \"$(date '+%Y-%m-%d %H:%M:%S') - $1\" | tee -a \"$LOG_FILE\"\n}\n\n# Function to record metrics\nrecord_metric() {\n    local metric_name=\"$1\"\n    local value=\"$2\"\n    echo \"$(date '+%Y-%m-%d %H:%M:%S'),$metric_name,$value\" &gt;&gt; \"$METRICS_FILE\"\n}\n\n# Start processing\nlog \"Starting automation process\"\n\n# Record start time\nSTART_TIME=$(date +%s)\n\n# Process configuration\nif opnDossier validate config.xml; then\n    log \"Configuration validation successful\"\n    record_metric \"validation_success\" 1\nelse\n    log \"Configuration validation failed\"\n    record_metric \"validation_success\" 0\n    exit 1\nfi\n\n# Generate documentation\nif opnDossier convert config.xml -o docs/network-config.md; then\n    log \"Documentation generation successful\"\n    record_metric \"conversion_success\" 1\nelse\n    log \"Documentation generation failed\"\n    record_metric \"conversion_success\" 0\n    exit 1\nfi\n\n# Record processing time\nEND_TIME=$(date +%s)\nPROCESSING_TIME=$((END_TIME - START_TIME))\nrecord_metric \"processing_time_seconds\" \"$PROCESSING_TIME\"\n\nlog \"Automation process completed successfully\"\n</code></pre>"},{"location":"examples/automation-scripting/#3-resource-management","title":"3. Resource Management","text":"<pre><code>#!/bin/bash\n# resource-managed-automation.sh\n\n# Set resource limits\nulimit -v 1048576  # 1GB virtual memory limit\nulimit -t 300      # 5 minute CPU time limit\n\n# Monitor resource usage\nmonitor_resources() {\n    local pid=$1\n    while kill -0 \"$pid\" 2&gt;/dev/null; do\n        local memory=$(ps -o rss= -p \"$pid\" 2&gt;/dev/null || echo \"0\")\n        local cpu=$(ps -o %cpu= -p \"$pid\" 2&gt;/dev/null || echo \"0\")\n        echo \"$(date),$memory,$cpu\" &gt;&gt; resource-usage.log\n        sleep 5\n    done\n}\n\n# Start resource monitoring\nopnDossier convert config.xml -o docs/network-config.md &amp;\nOPNDOSSIER_PID=$!\n\n# Monitor resources\nmonitor_resources \"$OPNDOSSIER_PID\" &amp;\nMONITOR_PID=$!\n\n# Wait for opnDossier to complete\nwait \"$OPNDOSSIER_PID\"\nOPNDOSSIER_EXIT_CODE=$?\n\n# Stop monitoring\nkill \"$MONITOR_PID\" 2&gt;/dev/null || true\n\nexit \"$OPNDOSSIER_EXIT_CODE\"\n</code></pre> <p>Next Steps:</p> <ul> <li>For troubleshooting, see Troubleshooting</li> <li>For advanced configuration, see Advanced Configuration</li> <li>For basic documentation, see Basic Documentation</li> </ul>"},{"location":"examples/basic-documentation/","title":"Basic Documentation Examples","text":"<p>This guide covers the most common use cases for generating documentation from OPNsense configuration files.</p>"},{"location":"examples/basic-documentation/#simple-configuration-conversion","title":"Simple Configuration Conversion","text":""},{"location":"examples/basic-documentation/#convert-to-markdown-default","title":"Convert to Markdown (Default)","text":"<pre><code># Basic conversion - outputs to console\nopnDossier convert config.xml\n\n# Save to file\nopnDossier convert config.xml -o network-docs.md\n\n# Convert with verbose output\nopnDossier --verbose convert config.xml -o network-docs.md\n</code></pre> <p>Example Output:</p> <pre><code># OPNsense Configuration Documentation\n\n## System Information\n- **Hostname**: firewall.example.com\n- **Domain**: example.com\n- **Theme**: opnsense\n\n## Interfaces\n| Name | IP Address | Subnet | Description |\n|------|------------|--------|-------------|\n| WAN | 192.168.1.1 | /24 | Internet connection |\n| LAN | 10.0.0.1 | /24 | Internal network |\n\n## Firewall Rules\n...\n</code></pre>"},{"location":"examples/basic-documentation/#convert-to-json-format","title":"Convert to JSON Format","text":"<pre><code># Convert to JSON for programmatic access\nopnDossier convert config.xml -f json -o config.json\n\n# Pretty-printed JSON\nopnDossier convert config.xml -f json | jq '.'\n\n# Extract specific sections\nopnDossier convert config.xml -f json | jq '.system'\nopnDossier convert config.xml -f json | jq '.interfaces'\n</code></pre> <p>Example Output:</p> <pre><code>{\n  \"system\": {\n    \"hostname\": \"firewall.example.com\",\n    \"domain\": \"example.com\",\n    \"theme\": \"opnsense\"\n  },\n  \"interfaces\": {\n    \"wan\": {\n      \"ipaddr\": \"192.168.1.1\",\n      \"subnet\": \"24\",\n      \"descr\": \"Internet connection\"\n    },\n    \"lan\": {\n      \"ipaddr\": \"10.0.0.1\",\n      \"subnet\": \"24\",\n      \"descr\": \"Internal network\"\n    }\n  }\n}\n</code></pre>"},{"location":"examples/basic-documentation/#convert-to-yaml-format","title":"Convert to YAML Format","text":"<pre><code># Convert to YAML for configuration management\nopnDossier convert config.xml -f yaml -o config.yaml\n\n# Use in Ansible playbooks\nopnDossier convert config.xml -f yaml &gt; vars/firewall_config.yml\n</code></pre> <p>Example Output:</p> <pre><code>system:\n  hostname: firewall.example.com\n  domain: example.com\n  theme: opnsense\n\ninterfaces:\n  wan:\n    ipaddr: 192.168.1.1\n    subnet: 24\n    descr: Internet connection\n  lan:\n    ipaddr: 10.0.0.1\n    subnet: 24\n    descr: Internal network\n</code></pre>"},{"location":"examples/basic-documentation/#file-management-examples","title":"File Management Examples","text":""},{"location":"examples/basic-documentation/#multiple-file-processing","title":"Multiple File Processing","text":"<pre><code># Convert multiple files at once\nopnDossier convert config1.xml config2.xml config3.xml\n\n# Each file gets appropriate extension\n# config1.xml -&gt; config1.md\n# config2.xml -&gt; config2.json\n# config3.xml -&gt; config3.yaml\n\n# Convert multiple files to same format\nopnDossier convert -f json config1.xml config2.xml config3.xml\n</code></pre>"},{"location":"examples/basic-documentation/#batch-processing-with-shell","title":"Batch Processing with Shell","text":"<pre><code># Process all XML files in current directory\nfor file in *.xml; do\n    opnDossier convert \"$file\" -o \"${file%.xml}.md\"\ndone\n\n# Process files in subdirectories\nfind . -name \"*.xml\" -exec opnDossier convert {} -o {}.md \\;\n\n# Process with parallel execution\nfind . -name \"*.xml\" | xargs -P 4 -I {} opnDossier convert {} -o {}.md\n</code></pre>"},{"location":"examples/basic-documentation/#output-file-organization","title":"Output File Organization","text":"<pre><code># Create organized directory structure\nmkdir -p docs/{current,archive,backups}\n\n# Generate current documentation\nopnDossier convert config.xml -o docs/current/network-config.md\n\n# Archive with timestamp\nopnDossier convert config.xml -o docs/archive/$(date +%Y-%m-%d)-config.md\n\n# Create backup documentation\nopnDossier convert backup-config.xml -o docs/backups/backup-config.md\n</code></pre>"},{"location":"examples/basic-documentation/#configuration-management","title":"Configuration Management","text":""},{"location":"examples/basic-documentation/#using-configuration-files","title":"Using Configuration Files","text":"<p>Create <code>~/.opnDossier.yaml</code> for persistent settings:</p> <pre><code># Default settings\nlog_level: info\nlog_format: text\noutput_file: ./network-docs.md\nverbose: false\ntheme: auto\n</code></pre>"},{"location":"examples/basic-documentation/#environment-variables","title":"Environment Variables","text":"<pre><code># Set default output location\nexport OPNDOSSIER_OUTPUT_FILE=\"./documentation.md\"\n\n# Set logging preferences\nexport OPNDOSSIER_LOG_LEVEL=debug\nexport OPNDOSSIER_LOG_FORMAT=json\n\n# Run with environment configuration\nopnDossier convert config.xml\n</code></pre>"},{"location":"examples/basic-documentation/#cli-flag-overrides","title":"CLI Flag Overrides","text":"<pre><code># Override config file settings\nopnDossier --log_level=debug --output=custom.md convert config.xml\n\n# Temporary verbose mode\nopnDossier --verbose convert config.xml\n\n# Use custom config file\nopnDossier --config ./project-config.yaml convert config.xml\n</code></pre>"},{"location":"examples/basic-documentation/#display-examples","title":"Display Examples","text":""},{"location":"examples/basic-documentation/#terminal-display","title":"Terminal Display","text":"<pre><code># Display with syntax highlighting\nopnDossier display config.xml\n\n# Display with specific theme\nopnDossier display --theme dark config.xml\nopnDossier display --theme light config.xml\n\n# Display without validation\nopnDossier display --no-validate config.xml\n</code></pre>"},{"location":"examples/basic-documentation/#section-filtering","title":"Section Filtering","text":"<pre><code># Display only system information\nopnDossier display --section system config.xml\n\n# Display network and firewall sections\nopnDossier display --section network,firewall config.xml\n\n# Display with custom template\nopnDossier display --template detailed config.xml\n</code></pre>"},{"location":"examples/basic-documentation/#validation-examples","title":"Validation Examples","text":""},{"location":"examples/basic-documentation/#basic-validation","title":"Basic Validation","text":"<pre><code># Validate single file\nopnDossier validate config.xml\n\n# Validate with verbose output\nopnDossier --verbose validate config.xml\n\n# Validate multiple files\nopnDossier validate config1.xml config2.xml config3.xml\n</code></pre>"},{"location":"examples/basic-documentation/#validation-in-workflows","title":"Validation in Workflows","text":"<pre><code># Validate before converting (recommended)\nopnDossier validate config.xml &amp;&amp; opnDossier convert config.xml\n\n# Validate and convert in one step\nopnDossier validate config.xml &amp;&amp; opnDossier convert config.xml -o validated-config.md\n\n# Check validation status\nif opnDossier validate config.xml; then\n    echo \"Configuration is valid\"\n    opnDossier convert config.xml -o config.md\nelse\n    echo \"Configuration has errors\"\n    exit 1\nfi\n</code></pre>"},{"location":"examples/basic-documentation/#common-workflow-examples","title":"Common Workflow Examples","text":""},{"location":"examples/basic-documentation/#daily-documentation-update","title":"Daily Documentation Update","text":"<pre><code>#!/bin/bash\n# daily-docs.sh\n\n# Set up environment\nexport OPNDOSSIER_LOG_FORMAT=json\nexport OPNDOSSIER_LOG_LEVEL=info\n\n# Create timestamp\nTIMESTAMP=$(date +%Y-%m-%d_%H-%M-%S)\n\n# Validate and convert\nif opnDossier validate config.xml; then\n    opnDossier convert config.xml -o \"docs/network-config-${TIMESTAMP}.md\"\n    echo \"Documentation updated successfully\"\nelse\n    echo \"Configuration validation failed\"\n    exit 1\nfi\n</code></pre>"},{"location":"examples/basic-documentation/#configuration-comparison","title":"Configuration Comparison","text":"<pre><code>#!/bin/bash\n# compare-configs.sh\n\n# Convert both configurations to JSON\nopnDossier convert current-config.xml -f json -o current.json\nopnDossier convert previous-config.xml -f json -o previous.json\n\n# Compare using jq (if available)\nif command -v jq &amp;&gt; /dev/null; then\n    jq -S . current.json &gt; current-sorted.json\n    jq -S . previous.json &gt; previous-sorted.json\n    diff current-sorted.json previous-sorted.json\nelse\n    echo \"Install jq for better comparison: brew install jq\"\n    diff current.json previous.json\nfi\n</code></pre>"},{"location":"examples/basic-documentation/#backup-documentation","title":"Backup Documentation","text":"<pre><code>#!/bin/bash\n# backup-docs.sh\n\nBACKUP_DIR=\"backups/$(date +%Y/%m)\"\nmkdir -p \"$BACKUP_DIR\"\n\n# Create backup documentation\nopnDossier convert config.xml -o \"${BACKUP_DIR}/config-$(date +%Y-%m-%d).md\"\n\n# Create JSON backup for programmatic access\nopnDossier convert config.xml -f json -o \"${BACKUP_DIR}/config-$(date +%Y-%m-%d).json\"\n\necho \"Backup documentation created in ${BACKUP_DIR}\"\n</code></pre>"},{"location":"examples/basic-documentation/#best-practices","title":"Best Practices","text":""},{"location":"examples/basic-documentation/#1-always-validate-first","title":"1. Always Validate First","text":"<pre><code># Good practice\nopnDossier validate config.xml &amp;&amp; opnDossier convert config.xml\n\n# Bad practice\nopnDossier convert config.xml  # May fail silently\n</code></pre>"},{"location":"examples/basic-documentation/#2-use-descriptive-output-names","title":"2. Use Descriptive Output Names","text":"<pre><code># Good\nopnDossier convert config.xml -o \"network-config-$(date +%Y-%m-%d).md\"\n\n# Bad\nopnDossier convert config.xml -o output.md\n</code></pre>"},{"location":"examples/basic-documentation/#3-organize-output-files","title":"3. Organize Output Files","text":"<pre><code># Create organized structure\nmkdir -p docs/{current,archive,backups,exports}\n\n# Use appropriate directories\nopnDossier convert config.xml -o docs/current/network.md\nopnDossier convert backup.xml -o docs/backups/backup.md\nopnDossier convert config.xml -f json -o docs/exports/config.json\n</code></pre>"},{"location":"examples/basic-documentation/#4-use-environment-variables-for-automation","title":"4. Use Environment Variables for Automation","text":"<pre><code># Set up environment\nexport OPNDOSSIER_LOG_FORMAT=json\nexport OPNDOSSIER_LOG_LEVEL=info\nexport OPNDOSSIER_OUTPUT_FILE=\"./docs/network-config.md\"\n\n# Run commands\nopnDossier validate config.xml\nopnDossier convert config.xml\n</code></pre>"},{"location":"examples/basic-documentation/#5-handle-errors-gracefully","title":"5. Handle Errors Gracefully","text":"<pre><code>#!/bin/bash\n# robust-conversion.sh\n\nset -e  # Exit on any error\n\n# Validate configuration\nif ! opnDossier validate config.xml; then\n    echo \"Configuration validation failed\"\n    exit 1\nfi\n\n# Convert with error handling\nif opnDossier convert config.xml -o network-docs.md; then\n    echo \"Documentation generated successfully\"\nelse\n    echo \"Documentation generation failed\"\n    exit 1\nfi\n</code></pre> <p>Next Steps:</p> <ul> <li>For security auditing, see Audit and Compliance</li> <li>For automation, see Automation and Scripting</li> <li>For troubleshooting, see Troubleshooting</li> </ul>"},{"location":"examples/troubleshooting/","title":"Troubleshooting and Debugging Examples","text":"<p>\u26a0\ufe0f Note: Some examples in this guide reference audit functionality that is not yet implemented in opnDossier v1.0.</p> <p>Examples using <code>--mode</code>, <code>--blackhat-mode</code>, and <code>--plugins</code> flags are for future releases. These flags are currently disabled and not available in the current version.</p> <p>This guide covers common issues, error handling, and debugging techniques for opnDossier.</p>"},{"location":"examples/troubleshooting/#common-error-scenarios","title":"Common Error Scenarios","text":""},{"location":"examples/troubleshooting/#xml-parsing-errors","title":"XML Parsing Errors","text":""},{"location":"examples/troubleshooting/#invalid-xml-structure","title":"Invalid XML Structure","text":"<pre><code># Error: Invalid XML syntax\nopnDossier convert invalid-config.xml\n# Output: failed to parse XML from invalid-config.xml: XML syntax error on line 42\n\n# Debug XML issues\nopnDossier --verbose convert invalid-config.xml\n\n# Validate XML syntax first\nxmllint --noout invalid-config.xml\n</code></pre>"},{"location":"examples/troubleshooting/#malformed-opnsense-configuration","title":"Malformed OPNsense Configuration","text":"<pre><code># Error: Missing required elements\nopnDossier convert malformed-config.xml\n# Output: validation error at opnsense.system.hostname: hostname is required\n\n# Debug with verbose output\nopnDossier --verbose convert malformed-config.xml\n\n# Check specific validation errors\nopnDossier validate malformed-config.xml\n</code></pre>"},{"location":"examples/troubleshooting/#file-permission-issues","title":"File Permission Issues","text":"<pre><code># Error: Permission denied\nopnDossier convert /root/config.xml\n# Output: failed to open file /root/config.xml: permission denied\n\n# Solutions:\n# 1. Copy file to accessible location\nsudo cp /root/config.xml ./config.xml\nopnDossier convert config.xml\n\n# 2. Change file permissions (if appropriate)\nsudo chmod 644 /root/config.xml\n\n# 3. Run with appropriate permissions\nsudo opnDossier convert /root/config.xml\n</code></pre>"},{"location":"examples/troubleshooting/#configuration-validation-errors","title":"Configuration Validation Errors","text":"<pre><code># Error: Conflicting flags\nopnDossier --verbose --quiet convert config.xml\n# Output: verbose and quiet options are mutually exclusive\n\n# Error: Invalid output format\nopnDossier convert config.xml -f txt\n# Output: unsupported format: txt\n</code></pre>"},{"location":"examples/troubleshooting/#debug-techniques","title":"Debug Techniques","text":""},{"location":"examples/troubleshooting/#verbose-debugging","title":"Verbose Debugging","text":"<pre><code># Enable verbose output for detailed debugging\nopnDossier --verbose convert config.xml\n\n# Combine verbose with other flags\nopnDossier --verbose convert config.xml --format json\n</code></pre>"},{"location":"examples/troubleshooting/#step-by-step-debugging","title":"Step-by-Step Debugging","text":"<pre><code># 1. Validate configuration first\nopnDossier validate config.xml\n\n# 2. Test basic conversion\nopnDossier convert config.xml\n\n# 3. Test with specific format\nopnDossier convert config.xml -f json\n\n# 4. Test with specific sections\nopnDossier convert config.xml --section system\n\n# 5. Test with custom template\nopnDossier convert config.xml --custom-template ./custom-template.tmpl\n</code></pre>"},{"location":"examples/troubleshooting/#common-issues-and-solutions","title":"Common Issues and Solutions","text":""},{"location":"examples/troubleshooting/#issue-1-large-file-processing","title":"Issue 1: Large File Processing","text":"<p>Symptoms:</p> <ul> <li>Slow processing</li> <li>High memory usage</li> <li>Timeout errors</li> </ul> <p>Solutions:</p> <pre><code># Use built-in optimization\nopnDossier convert large-config.xml\n\n# Monitor memory usage\n/usr/bin/time -v opnDossier convert large-config.xml\n\n# Process in sections\nopnDossier convert large-config.xml --section system,interfaces\nopnDossier convert large-config.xml --section firewall,nat\n</code></pre>"},{"location":"examples/troubleshooting/#issue-2-template-rendering-problems","title":"Issue 2: Template Rendering Problems","text":"<p>Symptoms:</p> <ul> <li>Template not found errors</li> <li>Incorrect output formatting</li> <li>Missing sections</li> </ul> <p>Solutions:</p> <pre><code># Use built-in templates (default)\nopnDossier convert config.xml\n\n# Use custom template\nopnDossier convert config.xml --custom-template ./custom-template.tmpl\n\n# Debug template rendering\nopnDossier --verbose convert config.xml --custom-template ./custom-template.tmpl\n</code></pre>"},{"location":"examples/troubleshooting/#issue-3-output-file-issues","title":"Issue 3: Output File Issues","text":"<p>Symptoms:</p> <ul> <li>File not created</li> <li>Permission errors</li> <li>Overwrite prompts</li> </ul> <p>Solutions:</p> <pre><code># Check output directory permissions\nls -la /path/to/output/directory\n\n# Force overwrite\nopnDossier convert config.xml -o output.md --force\n\n# Use different output location\nopnDossier convert config.xml -o /tmp/output.md\n\n# Check disk space\ndf -h /path/to/output/directory\n</code></pre>"},{"location":"examples/troubleshooting/#advanced-debugging","title":"Advanced Debugging","text":""},{"location":"examples/troubleshooting/#memory-profiling","title":"Memory Profiling","text":"<pre><code># Run with memory profiling\ngo tool pprof -http=:8080 $(which opnDossier) mem.prof\n\n# Generate memory profile\nopnDossier convert config.xml -o output.md\n# (Memory profile is automatically generated for large files)\n</code></pre>"},{"location":"examples/troubleshooting/#performance-analysis","title":"Performance Analysis","text":"<pre><code># Measure execution time\ntime opnDossier convert config.xml\n\n# Profile CPU usage\ngo tool pprof -http=:8080 $(which opnDossier) cpu.prof\n\n# Analyze specific operations\nopnDossier --verbose convert config.xml 2&gt;&amp;1 | grep \"duration\"\n</code></pre>"},{"location":"examples/troubleshooting/#network-debugging-if-applicable","title":"Network Debugging (if applicable)","text":"<pre><code># Check for network calls (should be none in offline mode)\nstrace -e trace=network opnDossier convert config.xml\n\n# Monitor file system access\nstrace -e trace=file opnDossier convert config.xml\n\n# Check for external dependencies\nldd $(which opnDossier)\n</code></pre>"},{"location":"examples/troubleshooting/#error-recovery","title":"Error Recovery","text":""},{"location":"examples/troubleshooting/#recovering-from-validation-errors","title":"Recovering from Validation Errors","text":"<pre><code># 1. Identify specific validation errors\nopnDossier validate config.xml\n\n# 2. Fix common issues\n# Missing hostname\nsed -i 's/&lt;hostname&gt;&lt;\\/hostname&gt;/&lt;hostname&gt;firewall&lt;\\/hostname&gt;/' config.xml\n\n# Invalid IP address\nsed -i 's/&lt;ipaddr&gt;256.256.256.256&lt;\\/ipaddr&gt;/&lt;ipaddr&gt;192.168.1.1&lt;\\/ipaddr&gt;/' config.xml\n\n# 3. Re-validate\nopnDossier validate config.xml\n\n# 4. Convert if valid\nopnDossier convert config.xml\n</code></pre>"},{"location":"examples/troubleshooting/#recovering-from-template-errors","title":"Recovering from Template Errors","text":"<pre><code># 1. Check template syntax\nopnDossier convert config.xml --custom-template ./templates/custom.tmpl --verbose\n\n# 2. Use built-in template (default)\nopnDossier convert config.xml\n\n# 3. Create minimal template\ncat &gt; minimal-template.tmpl &lt;&lt; EOF\n# Configuration Report\n{{.System.Hostname}}\nEOF\n\n# 4. Test with minimal template\nopnDossier convert config.xml --custom-template ./minimal-template.tmpl\n</code></pre>"},{"location":"examples/troubleshooting/#diagnostic-scripts","title":"Diagnostic Scripts","text":""},{"location":"examples/troubleshooting/#configuration-health-check","title":"Configuration Health Check","text":"<pre><code>#!/bin/bash\n# config-health-check.sh\n\nCONFIG_FILE=\"$1\"\nLOG_FILE=\"health-check.log\"\n\necho \"Configuration Health Check for $CONFIG_FILE\" &gt; \"$LOG_FILE\"\necho \"Started at $(date)\" &gt;&gt; \"$LOG_FILE\"\n\n# Check file existence\nif [ ! -f \"$CONFIG_FILE\" ]; then\n    echo \"ERROR: File not found: $CONFIG_FILE\" &gt;&gt; \"$LOG_FILE\"\n    exit 1\nfi\n\n# Check file size\nFILE_SIZE=$(stat -c%s \"$CONFIG_FILE\")\necho \"File size: $FILE_SIZE bytes\" &gt;&gt; \"$LOG_FILE\"\n\n# Check file permissions\nFILE_PERMS=$(stat -c%a \"$CONFIG_FILE\")\necho \"File permissions: $FILE_PERMS\" &gt;&gt; \"$LOG_FILE\"\n\n# Validate XML syntax\nif xmllint --noout \"$CONFIG_FILE\" 2&gt;/dev/null; then\n    echo \"XML syntax: VALID\" &gt;&gt; \"$LOG_FILE\"\nelse\n    echo \"XML syntax: INVALID\" &gt;&gt; \"$LOG_FILE\"\n    exit 1\nfi\n\n# Run opnDossier validation\nif opnDossier validate \"$CONFIG_FILE\" &gt;&gt; \"$LOG_FILE\" 2&gt;&amp;1; then\n    echo \"opnDossier validation: PASSED\" &gt;&gt; \"$LOG_FILE\"\nelse\n    echo \"opnDossier validation: FAILED\" &gt;&gt; \"$LOG_FILE\"\n    exit 1\nfi\n\n# Test conversion\nif opnDossier convert \"$CONFIG_FILE\" -o /tmp/test.md &gt;&gt; \"$LOG_FILE\" 2&gt;&amp;1; then\n    echo \"Conversion test: PASSED\" &gt;&gt; \"$LOG_FILE\"\n    rm -f /tmp/test.md\nelse\n    echo \"Conversion test: FAILED\" &gt;&gt; \"$LOG_FILE\"\n    exit 1\nfi\n\necho \"Health check completed successfully at $(date)\" &gt;&gt; \"$LOG_FILE\"\n</code></pre>"},{"location":"examples/troubleshooting/#performance-diagnostic","title":"Performance Diagnostic","text":"<pre><code>#!/bin/bash\n# performance-diagnostic.sh\n\nCONFIG_FILE=\"$1\"\nRESULTS_FILE=\"performance-results.log\"\n\necho \"Performance Diagnostic for $CONFIG_FILE\" &gt; \"$RESULTS_FILE\"\necho \"Started at $(date)\" &gt;&gt; \"$RESULTS_FILE\"\n\n# Measure validation time\necho \"Measuring validation time...\" &gt;&gt; \"$RESULTS_FILE\"\nVALIDATION_TIME=$(/usr/bin/time -f \"%e\" opnDossier validate \"$CONFIG_FILE\" 2&gt;&amp;1)\necho \"Validation time: ${VALIDATION_TIME}s\" &gt;&gt; \"$RESULTS_FILE\"\n\n# Measure conversion time\necho \"Measuring conversion time...\" &gt;&gt; \"$RESULTS_FILE\"\nCONVERSION_TIME=$(/usr/bin/time -f \"%e\" opnDossier convert \"$CONFIG_FILE\" -o /tmp/test.md 2&gt;&amp;1)\necho \"Conversion time: ${CONVERSION_TIME}s\" &gt;&gt; \"$RESULTS_FILE\"\n\n# Measure memory usage\necho \"Measuring memory usage...\" &gt;&gt; \"$RESULTS_FILE\"\nMEMORY_USAGE=$(/usr/bin/time -f \"%M\" opnDossier convert \"$CONFIG_FILE\" -o /tmp/test.md 2&gt;&amp;1)\necho \"Memory usage: ${MEMORY_USAGE}KB\" &gt;&gt; \"$RESULTS_FILE\"\n\n# Clean up\nrm -f /tmp/test.md\n\necho \"Performance diagnostic completed at $(date)\" &gt;&gt; \"$RESULTS_FILE\"\n</code></pre>"},{"location":"examples/troubleshooting/#error-pattern-analysis","title":"Error Pattern Analysis","text":"<pre><code>#!/bin/bash\n# error-pattern-analysis.sh\n\nLOG_FILE=\"$1\"\nANALYSIS_FILE=\"error-analysis.log\"\n\necho \"Error Pattern Analysis for $LOG_FILE\" &gt; \"$ANALYSIS_FILE\"\n\n# Extract error messages\necho \"=== ERROR MESSAGES ===\" &gt;&gt; \"$ANALYSIS_FILE\"\ngrep -i \"error\\|failed\\|invalid\" \"$LOG_FILE\" &gt;&gt; \"$ANALYSIS_FILE\"\n\n# Count error types\necho \"=== ERROR COUNTS ===\" &gt;&gt; \"$ANALYSIS_FILE\"\ngrep -i \"error\\|failed\\|invalid\" \"$LOG_FILE\" | sort | uniq -c | sort -nr &gt;&gt; \"$ANALYSIS_FILE\"\n\n# Extract timing information\necho \"=== TIMING INFORMATION ===\" &gt;&gt; \"$ANALYSIS_FILE\"\ngrep -i \"duration\\|time\\|elapsed\" \"$LOG_FILE\" &gt;&gt; \"$ANALYSIS_FILE\"\n\n# Extract validation errors\necho \"=== VALIDATION ERRORS ===\" &gt;&gt; \"$ANALYSIS_FILE\"\ngrep -i \"validation\" \"$LOG_FILE\" &gt;&gt; \"$ANALYSIS_FILE\"\n\necho \"Error pattern analysis completed\" &gt;&gt; \"$ANALYSIS_FILE\"\n</code></pre>"},{"location":"examples/troubleshooting/#best-practices-for-troubleshooting","title":"Best Practices for Troubleshooting","text":""},{"location":"examples/troubleshooting/#1-systematic-approach","title":"1. Systematic Approach","text":"<pre><code># Always start with validation\nopnDossier validate config.xml\n\n# Test basic functionality\nopnDossier convert config.xml\n\n# Add complexity gradually\nopnDossier convert config.xml -f json\nopnDossier convert config.xml --comprehensive\nopnDossier convert config.xml --section system,interfaces\n</code></pre>"},{"location":"examples/troubleshooting/#2-error-handling-in-scripts","title":"2. Error Handling in Scripts","text":"<pre><code>#!/bin/bash\n# robust-script.sh\n\nset -e  # Exit on any error\n\n# Function to handle errors\nhandle_error() {\n    local exit_code=$?\n    echo \"Error occurred in line $1, exit code: $exit_code\"\n\n    # Log error details\n    echo \"$(date): Error in $0 at line $1, exit code: $exit_code\" &gt;&gt; error.log\n\n    # Send notification if needed\n    # curl -X POST -H 'Content-type: application/json' \\\n    #     --data \"{\\\"text\\\":\\\"Error in opnDossier script\\\"}\" \\\n    #     \"$WEBHOOK_URL\"\n\n    exit $exit_code\n}\n\n# Set error handler\ntrap 'handle_error $LINENO' ERR\n\n# Your script logic here\nopnDossier validate config.xml\nopnDossier convert config.xml -o output.md\n</code></pre>"},{"location":"examples/troubleshooting/#3-environment-isolation","title":"3. Environment Isolation","text":"<pre><code># Test in clean environment\nenv -i PATH=/usr/bin:/bin opnDossier convert config.xml\n\n# Test with minimal configuration\nopnDossier --config /dev/null convert config.xml\n\n# Test with specific environment variables\nOPNDOSSIER_OUTPUT_FILE=./docs/network.md opnDossier convert config.xml\n</code></pre>"},{"location":"examples/troubleshooting/#future-features-not-available-in-v10","title":"Future Features (Not Available in v1.0)","text":"<p>\u26a0\ufe0f The following examples reference functionality that is planned for future releases but is not currently available in opnDossier v1.0.</p>"},{"location":"examples/troubleshooting/#audit-mode-examples-future-release","title":"Audit Mode Examples (Future Release)","text":"<pre><code># TODO: These flags are not available in v1.0\n# Generate blue team audit report\n# opnDossier convert config.xml --mode blue --comprehensive\n\n# Generate red team recon report with blackhat mode\n# opnDossier convert config.xml --mode red --blackhat-mode\n\n# Run compliance checks with specific plugins\n# opnDossier convert config.xml --mode blue --plugins stig,sans\n</code></pre>"},{"location":"examples/troubleshooting/#plugin-system-examples-future-release","title":"Plugin System Examples (Future Release)","text":"<pre><code># TODO: These flags are not available in v1.0\n# Check available plugins\n# opnDossier convert config.xml --plugins stig,sans\n\n# Test individual plugins\n# opnDossier convert config.xml --plugins stig\n# opnDossier convert config.xml --plugins sans\n\n# Debug plugin loading\n# opnDossier --verbose convert config.xml --plugins stig,sans\n</code></pre>"},{"location":"examples/troubleshooting/#advanced-logging-examples-future-release","title":"Advanced Logging Examples (Future Release)","text":"<pre><code># TODO: These flags are not available in v1.0\n# Enable debug logging\n# opnDossier --log_level=debug convert config.xml\n\n# Capture detailed logs in JSON format\n# opnDossier --log_format=json --log_level=debug convert config.xml &gt; debug.log 2&gt;&amp;1\n\n# Analyze logs with jq\n# jq '.level' debug.log | sort | uniq -c\n# jq 'select(.level == \"error\") | .msg' debug.log\n</code></pre>"},{"location":"examples/troubleshooting/#template-directory-examples-future-release","title":"Template Directory Examples (Future Release)","text":"<pre><code># TODO: This flag is not available in v1.0\n# Use template directory (use --custom-template instead)\n# opnDossier convert config.xml --template-dir ./custom-templates\n\n# Debug template directory\n# opnDossier --verbose convert config.xml --template-dir ./custom-templates\n</code></pre> <p>Next Steps:</p> <ul> <li>For advanced configuration, see Advanced Configuration</li> <li>For basic documentation, see Basic Documentation</li> <li>For audit and compliance, see Audit and Compliance</li> </ul>"},{"location":"release-notes/v2.0-template/","title":"Release Notes - v2.0.0","text":""},{"location":"release-notes/v2.0-template/#highlights","title":"\ud83d\ude80 Highlights","text":"<p>opnDossier v2.0 introduces a major architectural shift to programmatic report generation, delivering significant performance improvements and type safety.</p> <ul> <li>Faster Generation[1]: Significant performance improvements over template-based approach.</li> <li>Reduced Memory Usage[1]: Lower resource consumption during report generation.</li> <li>Type Safety: Compile-time validation for robust report generation.</li> </ul> <p>[1] Performance improvements can be measured using the comparative benchmark suite in <code>internal/converter/markdown_bench_test.go</code>. Benchmarks compare the template-based (<code>text/template</code>) and programmatic (Go string builders) approaches across small, medium, and large configuration files. Run benchmarks with: <code>go test -bench=. ./internal/converter -benchmem</code></p>"},{"location":"release-notes/v2.0-template/#breaking-changes-deprecations","title":"\u26a0\ufe0f Breaking Changes &amp; Deprecations","text":""},{"location":"release-notes/v2.0-template/#template-mode-deprecation","title":"Template Mode Deprecation","text":"<ul> <li>Template-based generation is now DEPRECATED.</li> <li>The <code>--use-template</code> flag triggers a deprecation warning.</li> <li>Support will be removed in v3.0 (Q3 2025).</li> <li>See the Migration Guide and Deprecation Policy for details.</li> </ul>"},{"location":"release-notes/v2.0-template/#other-changes","title":"Other Changes","text":"<ul> <li>[List any other breaking changes here]</li> </ul>"},{"location":"release-notes/v2.0-template/#new-features","title":"\u2728 New Features","text":"<ul> <li>Programmatic Generation: Default generation mode using Go builders.</li> <li>Migration Tools: CLI-based validation workflow using <code>--use-template</code> flag for output comparison.</li> <li>Enhanced CLI: Better flag handling and deprecation warnings.</li> <li>[List other new features]</li> </ul>"},{"location":"release-notes/v2.0-template/#bug-fixes","title":"\ud83d\udc1b Bug Fixes","text":"<ul> <li>[List bug fixes]</li> </ul>"},{"location":"release-notes/v2.0-template/#performance-improvements","title":"\u26a1 Performance Improvements","text":"<ul> <li>Replaced <code>text/template</code> engine with optimized Go string builders.</li> <li>Improved large file processing with streaming validation.</li> </ul>"},{"location":"release-notes/v2.0-template/#dependency-updates","title":"\ud83d\udce6 Dependency Updates","text":"<ul> <li>Updated <code>cobra</code> to v1.8.0</li> <li>Updated <code>charmbracelet/log</code></li> <li>[List other dependency updates]</li> </ul>"},{"location":"release-notes/v2.0-template/#documentation","title":"\ud83d\udcda Documentation","text":"<ul> <li>Added Migration Guide</li> <li>Added Deprecation Policy</li> <li>Updated Usage Guide</li> </ul>"},{"location":"release-notes/v2.0-template/#contributors","title":"\ud83e\udd1d Contributors","text":"<p>Thanks to all contributors who helped with this release!</p>"},{"location":"security/compliance/","title":"Pipeline v2 Compliance","text":"<p>This project follows the EvilBit Labs Pipeline v2 Specification for OSS project quality gates and tooling.</p>"},{"location":"security/compliance/#compliance-overview","title":"Compliance Overview","text":"<p>opnDossier implements all required components of the Pipeline v2 specification to ensure high-quality, secure, and maintainable code.</p>"},{"location":"security/compliance/#security-scanning","title":"Security Scanning","text":""},{"location":"security/compliance/#github-codeql","title":"GitHub CodeQL","text":"<ul> <li>Purpose: Static application security testing (SAST)</li> <li>Trigger: On push to main, pull requests, and scheduled scans</li> <li>Coverage: Security vulnerabilities, code quality issues, potential bugs</li> <li>Results: Available in GitHub Security tab</li> </ul>"},{"location":"security/compliance/#grype-vulnerability-scanning","title":"Grype Vulnerability Scanning","text":"<ul> <li>Purpose: Container and dependency vulnerability scanning</li> <li>Trigger: CI builds and daily scheduled scans</li> <li>Coverage:</li> <li>Filesystem scanning for vulnerabilities</li> <li>Go module dependency scanning (<code>go.mod</code>)</li> <li>Severity Thresholds:</li> <li>Main branch: &gt;= medium severity</li> <li>Feature branches: &gt;= high severity</li> <li>Results: SARIF uploads to GitHub Security tab</li> </ul>"},{"location":"security/compliance/#snyk-integration","title":"Snyk Integration","text":"<ul> <li>Purpose: Dependency vulnerability scanning and monitoring</li> <li>Trigger: Continuous monitoring and PR checks</li> <li>Coverage: Known vulnerabilities in dependencies</li> <li>Results: Automated PR comments and security dashboard</li> </ul>"},{"location":"security/compliance/#license-compliance","title":"License Compliance","text":""},{"location":"security/compliance/#fossa-license-scanning","title":"FOSSA License Scanning","text":"<ul> <li>Purpose: License compliance and policy enforcement</li> <li>Coverage: All dependencies and transitive dependencies</li> <li>Policy: Apache License 2.0 compatible dependencies only</li> <li>Results: </li> </ul>"},{"location":"security/compliance/#supply-chain-security","title":"Supply Chain Security","text":""},{"location":"security/compliance/#slsa-level-3-provenance","title":"SLSA Level 3 Provenance","text":"<ul> <li>Purpose: Build provenance and supply chain transparency</li> <li>Implementation: GoReleaser with provenance generation</li> <li>Verification: Cryptographic attestation of build process</li> <li>Availability: Provenance files attached to releases</li> </ul>"},{"location":"security/compliance/#cosign-artifact-signing","title":"Cosign Artifact Signing","text":"<ul> <li>Purpose: Cryptographic signing of release artifacts</li> <li>Implementation: Cosign integration in release pipeline</li> <li>Verification: Public key verification of artifacts</li> <li>Availability: Signatures attached to releases</li> </ul>"},{"location":"security/compliance/#sbom-generation","title":"SBOM Generation","text":"<ul> <li>Purpose: Software Bill of Materials for transparency</li> <li>Formats:</li> <li>SPDX JSON (<code>sbom.spdx.json</code>)</li> <li>CycloneDX JSON (<code>sbom.cyclonedx.json</code>)</li> <li>Generation: Automated in CI/CD pipeline</li> <li>Availability: Downloadable from workflow run artifacts</li> </ul>"},{"location":"security/compliance/#code-quality","title":"Code Quality","text":""},{"location":"security/compliance/#golangci-lint","title":"golangci-lint","text":"<ul> <li>Purpose: Comprehensive Go linting</li> <li>Configuration: <code>.golangci.yml</code> in repository root</li> <li>Trigger: Pre-commit hooks, CI builds, PR checks</li> <li>Coverage:</li> <li>Code style</li> <li>Common mistakes</li> <li>Performance issues</li> <li>Security vulnerabilities</li> </ul>"},{"location":"security/compliance/#comprehensive-testing","title":"Comprehensive Testing","text":"<ul> <li>Unit Tests: Required for all new functionality</li> <li>Integration Tests: Component interaction testing</li> <li>Coverage Requirements: Minimum 80% code coverage</li> <li>CI Enforcement: Coverage reports uploaded to Codecov</li> </ul>"},{"location":"security/compliance/#repository-hygiene","title":"Repository Hygiene","text":""},{"location":"security/compliance/#ossf-scorecard","title":"OSSF Scorecard","text":"<ul> <li>Purpose: Security health metrics for open source projects</li> <li>Metrics Tracked:</li> <li>Branch protection</li> <li>Code review practices</li> <li>CI/CD test coverage</li> <li>Dependency update practices</li> <li>Vulnerability disclosure</li> <li>Results: Public scorecard available</li> </ul>"},{"location":"security/compliance/#automated-dependency-updates","title":"Automated Dependency Updates","text":"<ul> <li>Implementation: Dependabot and Renovate</li> <li>Frequency: Weekly scans for updates</li> <li>Scope: Go modules, GitHub Actions, development tools</li> <li>Process: Automated PRs with changelog and compatibility checks</li> </ul>"},{"location":"security/compliance/#cicd-standards","title":"CI/CD Standards","text":""},{"location":"security/compliance/#github-actions","title":"GitHub Actions","text":"<ul> <li>Workflows:</li> <li><code>ci-check.yml</code>: Comprehensive CI checks</li> <li><code>codeql.yml</code>: Security analysis</li> <li><code>vulnerability-scan.yml</code>: Daily vulnerability scanning</li> <li><code>release.yml</code>: Automated release process</li> <li>Local/CI Parity: All CI checks runnable locally via <code>just ci-check</code></li> <li>Branch Protection: Required status checks on main branch</li> </ul>"},{"location":"security/compliance/#just-commands-for-local-development","title":"Just Commands for Local Development","text":"<ul> <li><code>just test</code>: Run test suite</li> <li><code>just lint</code>: Run linters</li> <li><code>just check</code>: Run all pre-commit checks</li> <li><code>just ci-check</code>: Run comprehensive CI checks locally</li> <li><code>just scan</code>: Run vulnerability scanning</li> <li><code>just sbom</code>: Generate SBOM artifacts</li> </ul>"},{"location":"security/compliance/#vulnerability-management","title":"Vulnerability Management","text":""},{"location":"security/compliance/#scanning-frequency","title":"Scanning Frequency","text":"<ul> <li>CI Builds: On every push and pull request</li> <li>Scheduled Scans: Daily at 00:00 UTC</li> <li>Manual Scans: Via <code>just scan</code> command</li> </ul>"},{"location":"security/compliance/#severity-handling","title":"Severity Handling","text":"Severity Main Branch Feature Branch Action Required Critical Block Block Immediate fix High Block Block Fix before merge Medium Block Warn Fix required on main Low Warn Info Fix in backlog"},{"location":"security/compliance/#reporting","title":"Reporting","text":"<ul> <li>SARIF Uploads: GitHub Security tab (Code Scanning)</li> <li>Workflow Artifacts:</li> <li>Human-readable table reports</li> <li>Machine-readable JSON reports</li> <li>SBOM files</li> <li>Notifications: GitHub Security Advisories</li> </ul>"},{"location":"security/compliance/#exceptions","title":"Exceptions","text":"<p>Currently no exceptions to the Pipeline v2 specification are required for this project.</p>"},{"location":"security/compliance/#compliance-verification","title":"Compliance Verification","text":"<p>To verify compliance with Pipeline v2 specification:</p> <pre><code># Run all quality checks\njust ci-check\n\n# Run security scans\njust scan\n\n# Generate SBOM\njust sbom\n\n# Verify test coverage\njust test\n</code></pre>"},{"location":"security/compliance/#related-documentation","title":"Related Documentation","text":"<ul> <li>Vulnerability Scanning</li> <li>Security Policy</li> <li>Contributing Guidelines</li> <li>Pipeline v2 Specification</li> </ul>"},{"location":"security/validation/","title":"Validation &amp; Error Handling","text":"<p>opnDossier includes comprehensive validation capabilities to ensure configuration integrity and provide detailed error reporting.</p>"},{"location":"security/validation/#validation-features","title":"Validation Features","text":""},{"location":"security/validation/#configuration-structure-validation","title":"Configuration Structure Validation","text":"<p>Validates that all required fields are present and properly structured:</p> <ul> <li>System Configuration: Hostname, domain, timezone</li> <li>Network Interfaces: IP addresses, subnet masks, gateway assignments</li> <li>Firewall Rules: Source, destination, port specifications</li> <li>Services: DNS, DHCP, VPN configuration</li> </ul>"},{"location":"security/validation/#data-type-validation","title":"Data Type Validation","text":"<p>Ensures that data values conform to expected types and formats:</p> <ul> <li>IP Addresses: Valid IPv4 and IPv6 addresses</li> <li>Subnet Masks: Valid CIDR notation and subnet values (0-32 for IPv4, 0-128 for IPv6)</li> <li>Port Numbers: Valid port ranges (1-65535)</li> <li>Network Configurations: Gateway reachability, VLAN IDs, MAC addresses</li> </ul>"},{"location":"security/validation/#cross-field-validation","title":"Cross-Field Validation","text":"<p>Checks relationships and dependencies between configuration elements:</p> <ul> <li>Gateway References: Ensures gateways referenced in rules exist in configuration</li> <li>Interface References: Validates interface names used in rules and services</li> <li>Alias Resolution: Verifies aliases are defined before use</li> <li>Service Dependencies: Checks that services reference valid interfaces and networks</li> </ul>"},{"location":"security/validation/#streaming-processing","title":"Streaming Processing","text":"<p>Handles large configuration files efficiently:</p> <ul> <li>Memory Efficiency: Processes large XML files without loading entire document into memory</li> <li>Element Streaming: Handles configurations with thousands of rules or large sysctl sections</li> <li>Garbage Collection: Automatic memory cleanup after processing large sections</li> <li>Error Recovery: Continues processing when possible, collecting all validation errors</li> </ul>"},{"location":"security/validation/#error-output-examples","title":"Error Output Examples","text":""},{"location":"security/validation/#parse-error-example","title":"Parse Error Example","text":"<p>When XML syntax errors are encountered:</p> <pre><code>parse error at line 45, column 12: XML syntax error: expected element name after &lt;\n</code></pre>"},{"location":"security/validation/#validation-error-example","title":"Validation Error Example","text":"<p>Single validation error with context:</p> <pre><code>validation error at opnsense.system.hostname: hostname is required\nvalidation error at opnsense.interfaces.wan.ipaddr: IP address '300.300.300.300' must be a valid IP address\n</code></pre>"},{"location":"security/validation/#aggregated-validation-report","title":"Aggregated Validation Report","text":"<p>Multiple validation errors collected during processing:</p> <pre><code>validation failed with 3 errors: hostname is required (and 2 more)\n  - opnsense.system.hostname: hostname is required\n  - opnsense.system.domain: domain is required\n  - opnsense.interfaces.lan.subnet: subnet mask '35' must be a valid subnet mask (0-32)\n</code></pre>"},{"location":"security/validation/#streaming-processing-limits","title":"Streaming Processing Limits","text":""},{"location":"security/validation/#memory-management","title":"Memory Management","text":"<p>opnDossier implements streaming processing to handle large configuration files efficiently:</p> <ul> <li>Chunk Size: Processes XML elements in configurable chunks</li> <li>Buffer Management: Pre-allocated buffers for common operations</li> <li>Memory Limits: Configurable maximum memory usage</li> <li>Cleanup: Automatic resource cleanup after each section</li> </ul>"},{"location":"security/validation/#performance-characteristics","title":"Performance Characteristics","text":"Configuration Size Memory Usage Processing Time Small (&lt; 1MB) &lt; 10MB &lt; 1 second Medium (1-10MB) &lt; 50MB 1-5 seconds Large (10-50MB) &lt; 200MB 5-30 seconds Very Large (&gt; 50MB) &lt; 500MB 30-120 seconds"},{"location":"security/validation/#large-file-handling","title":"Large File Handling","text":"<p>For very large configuration files:</p> <ol> <li>Incremental Processing: Elements processed as they're read</li> <li>Partial Results: Can continue processing after non-fatal errors</li> <li>Progress Reporting: Status updates for long-running operations</li> <li>Resource Monitoring: Automatic detection of resource constraints</li> </ol>"},{"location":"security/validation/#validation-error-types","title":"Validation Error Types","text":""},{"location":"security/validation/#required-field-errors","title":"Required Field Errors","text":"<pre><code>validation error at opnsense.system.hostname: hostname is required\nvalidation error at opnsense.system.domain: domain is required\n</code></pre> <p>Resolution: Ensure all required fields are present in the configuration.</p>"},{"location":"security/validation/#data-type-errors","title":"Data Type Errors","text":"<pre><code>validation error at opnsense.interfaces.wan.ipaddr: IP address '300.300.300.300' is invalid\nvalidation error at opnsense.interfaces.lan.subnet: subnet mask '35' must be between 0-32\nvalidation error at opnsense.firewall.rules[5].dstport: port '99999' must be between 1-65535\n</code></pre> <p>Resolution: Correct the invalid values to match expected types and ranges.</p>"},{"location":"security/validation/#reference-errors","title":"Reference Errors","text":"<pre><code>validation error at opnsense.firewall.rules[12]: gateway 'WAN_GW' referenced but not defined\nvalidation error at opnsense.firewall.rules[15]: interface 'dmz0' referenced but not configured\nvalidation error at opnsense.firewall.rules[18]: alias 'WebServers' referenced but not defined\n</code></pre> <p>Resolution: Ensure all referenced elements exist in the configuration.</p>"},{"location":"security/validation/#structural-errors","title":"Structural Errors","text":"<pre><code>validation error at opnsense.interfaces: duplicate interface name 'lan'\nvalidation error at opnsense.firewall.rules: conflicting rules at positions 10 and 15\nvalidation error at opnsense.nat.outbound: missing required interface specification\n</code></pre> <p>Resolution: Fix structural issues in the configuration file.</p>"},{"location":"security/validation/#error-handling-modes","title":"Error Handling Modes","text":""},{"location":"security/validation/#strict-mode-default","title":"Strict Mode (Default)","text":"<ul> <li>Fails on first validation error</li> <li>Returns detailed error message with context</li> <li>Prevents processing of invalid configurations</li> </ul>"},{"location":"security/validation/#lenient-mode","title":"Lenient Mode","text":"<ul> <li>Collects all validation errors</li> <li>Continues processing when possible</li> <li>Returns aggregated error report</li> </ul>"},{"location":"security/validation/#permissive-mode","title":"Permissive Mode","text":"<ul> <li>Logs validation warnings</li> <li>Attempts to process configuration</li> <li>Best-effort output generation</li> </ul>"},{"location":"security/validation/#validation-api","title":"Validation API","text":""},{"location":"security/validation/#command-line-validation","title":"Command-Line Validation","text":"<pre><code># Validate configuration file\nopnDossier validate config.xml\n\n# Validate with verbose output\nopnDossier validate --verbose config.xml\n\n# Validate and show warnings\nopnDossier validate --show-warnings config.xml\n</code></pre>"},{"location":"security/validation/#programmatic-validation","title":"Programmatic Validation","text":"<pre><code>// Validate during conversion\nopnDossier convert --validate config.xml -o output.md\n\n# Convert with lenient validation\nopnDossier convert --validation-mode=lenient config.xml\n\n# Skip validation (not recommended)\nopnDossier convert --no-validate config.xml\n</code></pre>"},{"location":"security/validation/#best-practices","title":"Best Practices","text":""},{"location":"security/validation/#regular-validation","title":"Regular Validation","text":"<ol> <li>Pre-deployment: Always validate configurations before deployment</li> <li>Automated Testing: Include validation in CI/CD pipelines</li> <li>Version Control: Validate configurations before committing</li> <li>Documentation: Document any validation warnings or exceptions</li> </ol>"},{"location":"security/validation/#error-resolution-workflow","title":"Error Resolution Workflow","text":"<ol> <li>Identify: Run validation to collect all errors</li> <li>Prioritize: Address critical errors first</li> <li>Fix: Correct errors in source configuration</li> <li>Verify: Re-run validation to confirm fixes</li> <li>Document: Record any permanent exceptions or warnings</li> </ol>"},{"location":"security/validation/#performance-optimization","title":"Performance Optimization","text":"<p>For large configurations:</p> <ol> <li>Streaming Mode: Enable streaming for files &gt; 10MB</li> <li>Partial Validation: Validate specific sections when possible</li> <li>Resource Limits: Configure memory limits appropriately</li> <li>Progress Monitoring: Enable progress reporting for long operations</li> </ol>"},{"location":"security/validation/#troubleshooting","title":"Troubleshooting","text":""},{"location":"security/validation/#out-of-memory-errors","title":"Out of Memory Errors","text":"<pre><code>ERROR: out of memory processing configuration file\n</code></pre> <p>Solutions:</p> <ul> <li>Enable streaming mode: <code>--streaming</code></li> <li>Increase memory limit: <code>--max-memory=1G</code></li> <li>Process in sections: Validate specific configuration domains</li> </ul>"},{"location":"security/validation/#timeout-errors","title":"Timeout Errors","text":"<pre><code>ERROR: validation timeout after 120 seconds\n</code></pre> <p>Solutions:</p> <ul> <li>Increase timeout: <code>--timeout=300</code></li> <li>Enable streaming mode</li> <li>Check for infinite recursion in configuration</li> </ul>"},{"location":"security/validation/#xml-parser-errors","title":"XML Parser Errors","text":"<pre><code>ERROR: XML syntax error at line 45, column 12\n</code></pre> <p>Solutions:</p> <ul> <li>Validate XML syntax with external tool</li> <li>Check for special characters requiring escaping</li> <li>Ensure proper XML encoding (UTF-8)</li> </ul>"},{"location":"security/validation/#related-documentation","title":"Related Documentation","text":"<ul> <li>Security Features</li> <li>Configuration Guide</li> <li>API Reference</li> <li>Examples</li> </ul>"},{"location":"security/vulnerability-scanning/","title":"Vulnerability Scanning &amp; SBOMs","text":"<p>opnDossier is designed for offline and airgapped environments, but the project itself is developed with supply-chain security and vulnerability transparency in mind.</p> <p>This document explains:</p> <ul> <li>what security scanning runs in CI,</li> <li>what artifacts are produced (reports + SBOMs), and</li> <li>how to interpret and act on findings.</li> </ul>"},{"location":"security/vulnerability-scanning/#what-runs-in-ci","title":"What runs in CI","text":"<p>Two GitHub Actions workflows provide vulnerability scanning:</p> <ul> <li>CI workflow: runs on pull requests and pushes.</li> <li>Scheduled workflow: runs daily at midnight UTC and can be triggered manually.</li> </ul> <p>Both workflows run Grype scans in two modes:</p> <ol> <li>Filesystem scan: scans the repository workspace (<code>.</code>).</li> <li>Go module dependency scan: explicitly scans the Go module manifest (<code>go.mod</code>) to surface dependency vulnerabilities directly.</li> </ol>"},{"location":"security/vulnerability-scanning/#severity-thresholds","title":"Severity thresholds","text":"<p>The CI workflow applies a branch-aware policy for the filesystem scan:</p> <ul> <li>On <code>main</code>: fail the job when findings are \\(\\\\ge\\) medium severity.</li> <li>On non-main branches: fail the job when findings are \\(\\\\ge\\) high severity.</li> </ul> <p>The Go module dependency scan uses a strict cutoff of critical.</p> <p>The scheduled workflow is configured to not fail the build (to reduce alert fatigue), but it still uploads results and artifacts.</p>"},{"location":"security/vulnerability-scanning/#outputs-and-where-to-find-them","title":"Outputs and where to find them","text":""},{"location":"security/vulnerability-scanning/#github-security-tab-sarif","title":"GitHub Security tab (SARIF)","text":"<p>Both workflows upload SARIF results so findings appear under GitHub \u2192 Security \u2192 Code scanning alerts.</p>"},{"location":"security/vulnerability-scanning/#workflow-artifacts","title":"Workflow artifacts","text":"<p>Each run publishes downloadable artifacts:</p> <ul> <li>SBOM artifacts (<code>sbom-reports</code>)</li> <li><code>sbom.spdx.json</code> (SPDX JSON)</li> <li><code>sbom.cyclonedx.json</code> (CycloneDX JSON)</li> <li>Vulnerability report artifacts (<code>vulnerability-reports</code>)</li> <li><code>vulnerability-report.txt</code> (human-readable table)</li> <li><code>vulnerability-report.json</code> (machine-readable JSON)</li> </ul> <p>Artifacts are retained for 30 days.</p>"},{"location":"security/vulnerability-scanning/#how-to-run-scans-locally","title":"How to run scans locally","text":"<p>The project provides <code>just</code> targets for local security workflows:</p> <ul> <li><code>just scan</code> - run vulnerability scanning locally</li> <li><code>just sbom</code> - generate SBOM artifacts locally</li> </ul>"},{"location":"security/vulnerability-scanning/#interpreting-and-addressing-findings","title":"Interpreting and addressing findings","text":"<p>When a vulnerability is reported:</p> <ol> <li>Confirm reachability: determine whether the vulnerable dependency is actually used at runtime.</li> <li>Prefer upgrades: bump the dependency/module to a fixed version when possible.</li> <li>Track exceptions explicitly: if a finding is accepted (e.g., non-reachable, false positive), document the reasoning and constraints.</li> <li>Avoid breaking offline-first: do not add runtime network dependencies as a \u201cfix\u201d.</li> </ol>"},{"location":"security/vulnerability-scanning/#troubleshooting","title":"Troubleshooting","text":"<ul> <li>SARIF upload succeeds but you see no alerts: GitHub may take a short time to index results; also ensure the repository has code scanning enabled.</li> <li>Artifacts missing on failing scans: artifact steps are configured to run with <code>if: always()</code>, so missing artifacts typically indicate that the Grype CLI wasn\u2019t available or the workflow was interrupted.</li> </ul>"},{"location":"user-guide/configuration-reference/","title":"Configuration Reference","text":"<p>Complete reference for all opnDossier configuration options. Configuration can be set via command-line flags, environment variables, or configuration file with clear precedence order.</p>"},{"location":"user-guide/configuration-reference/#configuration-precedence","title":"Configuration Precedence","text":"<p>Configuration sources are applied in this order (highest to lowest priority):</p> <ol> <li>Command-line flags - Direct CLI arguments</li> <li>Environment variables - <code>OPNDOSSIER_*</code> prefixed variables</li> <li>Configuration file - <code>~/.opnDossier.yaml</code></li> <li>Default values - Built-in defaults</li> </ol>"},{"location":"user-guide/configuration-reference/#complete-configuration-options","title":"Complete Configuration Options","text":""},{"location":"user-guide/configuration-reference/#logging-output","title":"Logging &amp; Output","text":"Setting CLI Flag Environment Variable Config File Type Default Description Verbose logging <code>--verbose</code> <code>OPNDOSSIER_VERBOSE</code> <code>verbose</code> boolean <code>false</code> Enable debug/verbose output with detailed information Quiet mode <code>--quiet</code> <code>OPNDOSSIER_QUIET</code> <code>quiet</code> boolean <code>false</code> Suppress all non-error output Log level <code>--log_level</code> <code>OPNDOSSIER_LOG_LEVEL</code> <code>log_level</code> string <code>info</code> Logging level: debug, info, warn, error Log format <code>--log_format</code> <code>OPNDOSSIER_LOG_FORMAT</code> <code>log_format</code> string <code>text</code> Log output format: text, json"},{"location":"user-guide/configuration-reference/#input-output-files","title":"Input &amp; Output Files","text":"Setting CLI Flag Environment Variable Config File Type Default Description Input file (positional) <code>OPNDOSSIER_INPUT_FILE</code> <code>input_file</code> string - Path to OPNsense config.xml file Output file <code>-o, --output</code> <code>OPNDOSSIER_OUTPUT_FILE</code> <code>output_file</code> string stdout Output file path for generated docs"},{"location":"user-guide/configuration-reference/#format-display","title":"Format &amp; Display","text":"Setting CLI Flag Environment Variable Config File Type Default Description Output format <code>-f, --format</code> <code>OPNDOSSIER_FORMAT</code> <code>format</code> string <code>markdown</code> Output format: markdown, json, yaml Wrap width <code>--wrap</code> <code>OPNDOSSIER_WRAP</code> <code>wrap</code> int <code>120</code> Text wrap width for display command (0=auto) Theme <code>--theme</code> <code>OPNDOSSIER_THEME</code> <code>theme</code> string <code>auto</code> Display theme: auto, dark, light, notty"},{"location":"user-guide/configuration-reference/#processing-options","title":"Processing Options","text":"Setting CLI Flag Environment Variable Config File Type Default Description Validate <code>--validate</code> <code>OPNDOSSIER_VALIDATE</code> <code>validate</code> boolean <code>false</code> Enable configuration validation Validation mode <code>--validation-mode</code> <code>OPNDOSSIER_VALIDATION_MODE</code> <code>validation_mode</code> string <code>strict</code> Validation mode: strict, lenient, permissive Include tunables <code>--include-tunables</code> <code>OPNDOSSIER_INCLUDE_TUNABLES</code> <code>include_tunables</code> boolean <code>false</code> Include system tunables in output Streaming mode <code>--streaming</code> <code>OPNDOSSIER_STREAMING</code> <code>streaming</code> boolean <code>false</code> Enable streaming for large files"},{"location":"user-guide/configuration-reference/#template-options-deprecated","title":"Template Options (Deprecated)","text":"Setting CLI Flag Environment Variable Config File Type Default Description Use template <code>--use-template</code> <code>OPNDOSSIER_USE_TEMPLATE</code> <code>use_template</code> boolean <code>false</code> Use template-based generation (deprecated) Template directory <code>--template-dir</code> <code>OPNDOSSIER_TEMPLATE_DIR</code> <code>template_dir</code> string - Custom template directory path Template override <code>--template-override</code> <code>OPNDOSSIER_TEMPLATE_OVERRIDE</code> <code>template_override</code> boolean <code>false</code> Force template mode"},{"location":"user-guide/configuration-reference/#advanced-options","title":"Advanced Options","text":"Setting CLI Flag Environment Variable Config File Type Default Description Max memory <code>--max-memory</code> <code>OPNDOSSIER_MAX_MEMORY</code> <code>max_memory</code> string <code>500M</code> Maximum memory usage (e.g., 100M, 1G) Timeout <code>--timeout</code> <code>OPNDOSSIER_TIMEOUT</code> <code>timeout</code> int <code>120</code> Processing timeout in seconds Show warnings <code>--show-warnings</code> <code>OPNDOSSIER_SHOW_WARNINGS</code> <code>show_warnings</code> boolean <code>true</code> Display validation warnings Color output <code>--color</code> <code>OPNDOSSIER_COLOR</code> <code>color</code> string <code>auto</code> Color output: auto, always, never"},{"location":"user-guide/configuration-reference/#configuration-file-format","title":"Configuration File Format","text":""},{"location":"user-guide/configuration-reference/#yaml-configuration-file","title":"YAML Configuration File","text":"<p>Create <code>~/.opnDossier.yaml</code> with your preferred settings:</p> <pre><code># Logging Configuration\nlog_level: info # debug, info, warn, error\nlog_format: text # text, json\nverbose: false # Enable verbose output\nquiet: false # Suppress non-error output\n\n# File Paths\ninput_file: /path/to/default/config.xml\noutput_file: ./output.md\n\n# Format &amp; Display\nformat: markdown # markdown, json, yaml\nwrap: 120 # Text wrap width (0 for auto)\ntheme: auto # auto, dark, light, notty\n\n# Processing Options\nvalidate: true # Enable validation\nvalidation_mode: strict # strict, lenient, permissive\ninclude_tunables: false # Include system tunables\nstreaming: false # Enable streaming mode\n\n# Advanced Options\nmax_memory: 500M # Maximum memory usage\ntimeout: 120 # Timeout in seconds\nshow_warnings: true # Show validation warnings\ncolor: auto # auto, always, never\n</code></pre>"},{"location":"user-guide/configuration-reference/#json-configuration-file-alternative","title":"JSON Configuration File (Alternative)","text":"<p>opnDossier also supports JSON format:</p> <pre><code>{\n  \"log_level\": \"info\",\n  \"log_format\": \"text\",\n  \"verbose\": false,\n  \"quiet\": false,\n  \"input_file\": \"/path/to/default/config.xml\",\n  \"output_file\": \"./output.md\",\n  \"format\": \"markdown\",\n  \"wrap\": 120,\n  \"theme\": \"auto\",\n  \"validate\": true,\n  \"validation_mode\": \"strict\",\n  \"include_tunables\": false,\n  \"streaming\": false,\n  \"max_memory\": \"500M\",\n  \"timeout\": 120,\n  \"show_warnings\": true,\n  \"color\": \"auto\"\n}\n</code></pre>"},{"location":"user-guide/configuration-reference/#environment-variables","title":"Environment Variables","text":"<p>All configuration options can be set via environment variables with the <code>OPNDOSSIER_</code> prefix:</p> <pre><code># Logging\nexport OPNDOSSIER_VERBOSE=true\nexport OPNDOSSIER_QUIET=false\nexport OPNDOSSIER_LOG_LEVEL=debug\nexport OPNDOSSIER_LOG_FORMAT=json\n\n# File Paths\nexport OPNDOSSIER_INPUT_FILE=\"/path/to/config.xml\"\nexport OPNDOSSIER_OUTPUT_FILE=\"./documentation.md\"\n\n# Format &amp; Display\nexport OPNDOSSIER_FORMAT=markdown\nexport OPNDOSSIER_WRAP=100\nexport OPNDOSSIER_THEME=dark\n\n# Processing Options\nexport OPNDOSSIER_VALIDATE=true\nexport OPNDOSSIER_VALIDATION_MODE=lenient\nexport OPNDOSSIER_INCLUDE_TUNABLES=true\nexport OPNDOSSIER_STREAMING=true\n\n# Advanced Options\nexport OPNDOSSIER_MAX_MEMORY=1G\nexport OPNDOSSIER_TIMEOUT=300\nexport OPNDOSSIER_SHOW_WARNINGS=true\nexport OPNDOSSIER_COLOR=always\n</code></pre>"},{"location":"user-guide/configuration-reference/#command-line-flag-examples","title":"Command-Line Flag Examples","text":""},{"location":"user-guide/configuration-reference/#basic-usage","title":"Basic Usage","text":"<pre><code># Simple conversion with defaults\nopnDossier convert config.xml\n\n# Specify output file\nopnDossier convert config.xml -o output.md\n\n# Change output format\nopnDossier convert -f json config.xml -o output.json\n</code></pre>"},{"location":"user-guide/configuration-reference/#logging-options","title":"Logging Options","text":"<pre><code># Verbose logging\nopnDossier --verbose convert config.xml\n\n# Quiet mode (errors only)\nopnDossier --quiet convert config.xml\n\n# Custom log level\nopnDossier --log_level=debug convert config.xml\n\n# JSON logging for structured output\nopnDossier --log_format=json convert config.xml\n</code></pre>"},{"location":"user-guide/configuration-reference/#display-options","title":"Display Options","text":"<pre><code># Display in terminal\nopnDossier display config.xml\n\n# Custom wrap width\nopnDossier display --wrap 100 config.xml\n\n# Auto-detect terminal width\nopnDossier display --wrap 0 config.xml\n\n# Force specific theme\nopnDossier display --theme dark config.xml\n</code></pre>"},{"location":"user-guide/configuration-reference/#validation-options","title":"Validation Options","text":"<pre><code># Validate without processing\nopnDossier validate config.xml\n\n# Validate and convert\nopnDossier convert --validate config.xml -o output.md\n\n# Lenient validation mode\nopnDossier convert --validation-mode=lenient config.xml\n\n# Show all warnings\nopnDossier convert --show-warnings config.xml\n</code></pre>"},{"location":"user-guide/configuration-reference/#advanced-options_1","title":"Advanced Options","text":"<pre><code># Increase memory limit for large files\nopnDossier --max-memory=1G convert large-config.xml\n\n# Increase timeout\nopnDossier --timeout=300 convert config.xml\n\n# Enable streaming for very large files\nopnDossier --streaming convert huge-config.xml\n\n# Include system tunables\nopnDossier convert --include-tunables config.xml -o full-report.md\n</code></pre>"},{"location":"user-guide/configuration-reference/#configuration-validation","title":"Configuration Validation","text":"<p>opnDossier validates configuration values on startup. Invalid values will result in clear error messages:</p> <pre><code># Invalid log level\n$ opnDossier --log_level=invalid convert config.xml\nError: invalid log level 'invalid', must be one of: debug, info, warn, error\n\n# Invalid format\n$ opnDossier convert -f invalid config.xml\nError: invalid format 'invalid', must be one of: markdown, json, yaml\n\n# Invalid wrap width\n$ opnDossier display --wrap -10 config.xml\nError: wrap width must be non-negative\n\n# Invalid memory limit\n$ opnDossier --max-memory=invalid convert config.xml\nError: invalid memory limit format, use format like '100M', '1G'\n</code></pre>"},{"location":"user-guide/configuration-reference/#configuration-best-practices","title":"Configuration Best Practices","text":""},{"location":"user-guide/configuration-reference/#local-development","title":"Local Development","text":"<p>Use configuration file for consistent local settings:</p> <pre><code># ~/.opnDossier.yaml\nverbose: true\nlog_level: debug\nwrap: 100\ntheme: dark\n</code></pre>"},{"location":"user-guide/configuration-reference/#cicd-environments","title":"CI/CD Environments","text":"<p>Use environment variables for flexibility:</p> <pre><code>export OPNDOSSIER_LOG_FORMAT=json\nexport OPNDOSSIER_VALIDATE=true\nexport OPNDOSSIER_QUIET=true\n</code></pre>"},{"location":"user-guide/configuration-reference/#production-scripts","title":"Production Scripts","text":"<p>Use explicit CLI flags for clarity:</p> <pre><code>#!/bin/bash\nopnDossier convert \\\n  --validate \\\n  --log_format=json \\\n  --timeout=300 \\\n  config.xml -o report.md\n</code></pre>"},{"location":"user-guide/configuration-reference/#airgapped-environments","title":"Airgapped Environments","text":"<p>Minimal configuration for offline operation:</p> <pre><code># ~/.opnDossier.yaml\ninput_file: /mnt/configs/opnsense-config.xml\noutput_file: /mnt/reports/firewall-docs.md\nvalidate: true\nstreaming: false\n</code></pre>"},{"location":"user-guide/configuration-reference/#troubleshooting-configuration","title":"Troubleshooting Configuration","text":""},{"location":"user-guide/configuration-reference/#configuration-not-loading","title":"Configuration Not Loading","text":"<p>Check file location and permissions:</p> <pre><code># Verify config file exists\nls -la ~/.opnDossier.yaml\n\n# Check file permissions\nchmod 644 ~/.opnDossier.yaml\n\n# Validate YAML syntax\nyamllint ~/.opnDossier.yaml\n</code></pre>"},{"location":"user-guide/configuration-reference/#environment-variables-not-working","title":"Environment Variables Not Working","text":"<p>Verify environment variable names and values:</p> <pre><code># List all opnDossier environment variables\nenv | grep OPNDOSSIER\n\n# Test specific variable\necho $OPNDOSSIER_LOG_LEVEL\n\n# Verify boolean values (use true/false, not 1/0)\nexport OPNDOSSIER_VERBOSE=true  # Correct\nexport OPNDOSSIER_VERBOSE=1     # Incorrect\n</code></pre>"},{"location":"user-guide/configuration-reference/#cli-flags-not-overriding","title":"CLI Flags Not Overriding","text":"<p>Remember precedence order - CLI flags should override everything:</p> <pre><code># This should use debug level (CLI flag)\nOPNDOSSIER_LOG_LEVEL=info opnDossier --log_level=debug convert config.xml\n\n# Verify flag is being parsed\nopnDossier convert --help\n</code></pre>"},{"location":"user-guide/configuration-reference/#related-documentation","title":"Related Documentation","text":"<ul> <li>User Guide</li> <li>Configuration Guide</li> <li>Examples</li> <li>Contributing Guide</li> </ul>"},{"location":"user-guide/configuration/","title":"Configuration Guide","text":"<p>opnDossier provides flexible configuration management using Viper for layered configuration handling. This guide covers all configuration options and methods.</p>"},{"location":"user-guide/configuration/#configuration-precedence","title":"Configuration Precedence","text":"<p>Configuration follows a clear precedence order:</p> <ol> <li>Command-line flags (highest priority)</li> <li>Environment variables (<code>OPNDOSSIER_*</code>)</li> <li>Configuration file (<code>~/.opnDossier.yaml</code>)</li> <li>Default values (lowest priority)</li> </ol> <p>This precedence ensures that CLI flags always override environment variables and config files, making it easy to temporarily override settings for specific runs.</p>"},{"location":"user-guide/configuration/#configuration-file","title":"Configuration File","text":""},{"location":"user-guide/configuration/#location","title":"Location","text":"<p>The default configuration file location is <code>~/.opnDossier.yaml</code>. You can specify a custom location using the <code>--config</code> flag:</p> <pre><code>opndossier --config /path/to/custom/config.yaml convert config.xml\n</code></pre>"},{"location":"user-guide/configuration/#format","title":"Format","text":"<p>The configuration file uses YAML format:</p> <pre><code># ~/.opnDossier.yaml - opnDossier Configuration\n\n# Input/Output settings\ninput_file: /path/to/default/config.xml\noutput_file: ./output.md\n\n# Logging configuration\nlog_level: info       # debug, info, warn, error\nlog_format: text      # text, json\nverbose: false        # Enable debug logging\nquiet: false          # Suppress all output except errors\n</code></pre>"},{"location":"user-guide/configuration/#configuration-options","title":"Configuration Options","text":"Option Type Default Description <code>input_file</code> string \"\" Default input file path <code>output_file</code> string \"\" Default output file path <code>verbose</code> boolean false Enable verbose/debug logging <code>quiet</code> boolean false Suppress all output except errors <code>log_level</code> string \"info\" Log level: debug, info, warn, error <code>log_format</code> string \"text\" Log format: text, json"},{"location":"user-guide/configuration/#environment-variables","title":"Environment Variables","text":"<p>All configuration options can be set using environment variables with the <code>OPNDOSSIER_</code> prefix:</p>"},{"location":"user-guide/configuration/#available-environment-variables","title":"Available Environment Variables","text":"<pre><code># Logging configuration\nexport OPNDOSSIER_VERBOSE=true          # Enable verbose/debug logging\nexport OPNDOSSIER_QUIET=false           # Suppress non-error output\nexport OPNDOSSIER_LOG_LEVEL=debug       # Set log level (debug, info, warn, error)\nexport OPNDOSSIER_LOG_FORMAT=json       # Use JSON log format\n\n# File paths\nexport OPNDOSSIER_INPUT_FILE=\"/path/to/config.xml\"\nexport OPNDOSSIER_OUTPUT_FILE=\"./documentation.md\"\n</code></pre>"},{"location":"user-guide/configuration/#examples","title":"Examples","text":"<pre><code># Set environment variables for a single run\nOPNDOSSIER_VERBOSE=true OPNDOSSIER_LOG_FORMAT=json opndossier convert config.xml\n\n# Export for multiple uses in the same session\nexport OPNDOSSIER_LOG_LEVEL=debug\nexport OPNDOSSIER_OUTPUT_FILE=\"./network-docs.md\"\nopndossier convert config.xml\n</code></pre>"},{"location":"user-guide/configuration/#environment-variable-naming","title":"Environment Variable Naming","text":"<p>Environment variables follow this pattern:</p> <ul> <li>Prefix: <code>OPNDOSSIER_</code></li> <li>Key transformation: Convert config key to uppercase and replace <code>-</code> with <code>_</code></li> <li>Examples:</li> <li><code>log_level</code> \u2192 <code>OPNDOSSIER_LOG_LEVEL</code></li> <li><code>input_file</code> \u2192 <code>OPNDOSSIER_INPUT_FILE</code></li> </ul>"},{"location":"user-guide/configuration/#command-line-flags","title":"Command-Line Flags","text":"<p>CLI flags have the highest precedence and override all other configuration sources:</p>"},{"location":"user-guide/configuration/#global-flags","title":"Global Flags","text":"<pre><code># Configuration file\n--config string       # Custom config file path (default: ~/.opnDossier.yaml)\n\n# Logging options\n--verbose, -v         # Enable verbose output (debug logging)\n--quiet, -q           # Suppress all output except errors\n--log_level string    # Set log level (debug, info, warn, error)\n--log_format string   # Set log format (text, json)\n</code></pre>"},{"location":"user-guide/configuration/#convert-command-flags","title":"Convert Command Flags","text":"<p>The <code>convert</code> command has additional flags specific to file conversion:</p> <pre><code>--output, -o string   # Output file path for conversion results\n</code></pre>"},{"location":"user-guide/configuration/#usage-examples","title":"Usage Examples","text":"<pre><code># Override log level for debugging\nopndossier --log_level=debug convert config.xml\n\n# Use JSON logging with quiet mode\nopndossier --quiet --log_format=json convert config.xml\n\n# Verbose mode with custom output\nopndossier --verbose convert config.xml --output detailed-output.md\n\n# Use custom config file\nopndossier --config ./project-config.yaml convert config.xml\n</code></pre>"},{"location":"user-guide/configuration/#logging-configuration","title":"Logging Configuration","text":""},{"location":"user-guide/configuration/#log-levels","title":"Log Levels","text":"Level Description Use Case <code>debug</code> Detailed diagnostic information Development, troubleshooting <code>info</code> General operational messages (default) Normal operation <code>warn</code> Warning messages for potential issues Monitoring <code>error</code> Error messages for failures Error tracking"},{"location":"user-guide/configuration/#log-formats","title":"Log Formats","text":""},{"location":"user-guide/configuration/#text-format-default","title":"Text Format (Default)","text":"<p>Human-readable format suitable for terminal output:</p> <pre><code>2024-01-15 10:30:45 INFO Starting conversion process input_file=config.xml\n2024-01-15 10:30:45 DEBUG Parsing XML file\n2024-01-15 10:30:46 INFO Conversion completed successfully\n</code></pre>"},{"location":"user-guide/configuration/#json-format","title":"JSON Format","text":"<p>Structured format suitable for log aggregation systems:</p> <pre><code>[\n  {\n    \"time\": \"2024-01-15T10:30:45Z\",\n    \"level\": \"INFO\",\n    \"msg\": \"Starting conversion process\",\n    \"input_file\": \"config.xml\"\n  },\n  {\n    \"time\": \"2024-01-15T10:30:45Z\",\n    \"level\": \"DEBUG\",\n    \"msg\": \"Parsing XML file\"\n  },\n  {\n    \"time\": \"2024-01-15T10:30:46Z\",\n    \"level\": \"INFO\",\n    \"msg\": \"Conversion completed successfully\"\n  }\n]\n</code></pre>"},{"location":"user-guide/configuration/#logging-examples","title":"Logging Examples","text":"<pre><code># Debug logging with text format\nopndossier --log_level=debug convert config.xml\n\n# JSON logging for log aggregation\nopndossier --log_format=json convert config.xml\n\n# Quiet mode - only errors\nopndossier --quiet convert config.xml\n\n# Verbose mode (shorthand for debug level)\nopndossier --verbose convert config.xml\n</code></pre>"},{"location":"user-guide/configuration/#configuration-validation","title":"Configuration Validation","text":"<p>opnDossier validates configuration settings and provides clear error messages for invalid configurations:</p>"},{"location":"user-guide/configuration/#validation-rules","title":"Validation Rules","text":"<ul> <li><code>verbose</code> and <code>quiet</code> are mutually exclusive</li> <li><code>log_level</code> must be one of: debug, info, warn, error</li> <li><code>log_format</code> must be one of: text, json</li> <li><code>input_file</code> must exist if specified</li> <li><code>output_file</code> directory must exist if specified</li> </ul>"},{"location":"user-guide/configuration/#validation-examples","title":"Validation Examples","text":"<pre><code># This will fail - mutually exclusive options\nopndossier --verbose --quiet convert config.xml\n# Error: verbose and quiet options are mutually exclusive\n\n# This will fail - invalid log level\nopndossier --log_level=trace convert config.xml\n# Error: invalid log level 'trace', must be one of: debug, info, warn, error\n</code></pre>"},{"location":"user-guide/configuration/#configuration-best-practices","title":"Configuration Best Practices","text":""},{"location":"user-guide/configuration/#1-use-configuration-files-for-persistent-settings","title":"1. Use Configuration Files for Persistent Settings","text":"<p>Store frequently used settings in <code>~/.opnDossier.yaml</code>:</p> <pre><code># Common settings for your environment\nlog_level: info\nlog_format: text\noutput_file: ./network-documentation.md\n</code></pre>"},{"location":"user-guide/configuration/#2-use-environment-variables-for-deployment","title":"2. Use Environment Variables for Deployment","text":"<p>For automated scripts and CI/CD pipelines:</p> <pre><code>#!/bin/bash\nexport OPNDOSSIER_LOG_FORMAT=json\nexport OPNDOSSIER_LOG_LEVEL=info\nexport OPNDOSSIER_OUTPUT_FILE=\"./build/network-docs.md\"\n\nopndossier convert config.xml\n</code></pre>"},{"location":"user-guide/configuration/#3-use-cli-flags-for-one-off-overrides","title":"3. Use CLI Flags for One-off Overrides","text":"<p>For temporary debugging or testing:</p> <pre><code># Debug a specific run\nopndossier --verbose convert problematic-config.xml\n\n# Generate output to a different location\nopndossier convert config.xml --output ./debug/output.md\n</code></pre>"},{"location":"user-guide/configuration/#4-airgapped-environment-configuration","title":"4. Airgapped Environment Configuration","text":"<p>For secure, offline environments:</p> <pre><code># ~/.opnDossier.yaml for airgapped systems\nlog_level: warn          # Minimal logging\nlog_format: text         # Human-readable\nverbose: false\nquiet: false\n</code></pre>"},{"location":"user-guide/configuration/#troubleshooting-configuration","title":"Troubleshooting Configuration","text":""},{"location":"user-guide/configuration/#common-issues","title":"Common Issues","text":"<ol> <li> <p>Configuration file not found</p> </li> <li> <p>Verify file exists at <code>~/.opnDossier.yaml</code></p> </li> <li> <p>Use <code>--config</code> flag to specify custom location</p> </li> <li> <p>Environment variables not working</p> </li> <li> <p>Ensure correct <code>OPNDOSSIER_</code> prefix</p> </li> <li> <p>Check variable names match expected format</p> </li> <li> <p>CLI flags not overriding config</p> </li> <li> <p>Verify flag syntax is correct</p> </li> <li>Check for typos in flag names</li> </ol>"},{"location":"user-guide/configuration/#debug-configuration-loading","title":"Debug Configuration Loading","text":"<p>Use verbose mode to see configuration loading details:</p> <pre><code>opndossier --verbose --config /path/to/config.yaml convert config.xml\n</code></pre> <p>This will show:</p> <ul> <li>Which configuration file is loaded</li> <li>Which environment variables are detected</li> <li>Final configuration values after precedence resolution</li> </ul> <p>For more configuration examples and advanced usage, see the Usage Guide.</p>"},{"location":"user-guide/installation/","title":"Installation Guide","text":"<p>This guide covers various methods to install opnDossier on your system.</p>"},{"location":"user-guide/installation/#prerequisites","title":"Prerequisites","text":"<ul> <li>Go 1.21+ (for building from source)</li> <li>Linux, macOS, or Windows (cross-platform support)</li> </ul>"},{"location":"user-guide/installation/#installation-methods","title":"Installation Methods","text":""},{"location":"user-guide/installation/#1-go-install-recommended","title":"1. Go Install (Recommended)","text":"<p>The simplest way to install opnDossier if you have Go installed:</p> <pre><code>go install github.com/EvilBit-Labs/opnDossier@latest\n</code></pre> <p>This will install the latest release to your <code>$GOPATH/bin</code> directory.</p>"},{"location":"user-guide/installation/#2-build-from-source","title":"2. Build from Source","text":""},{"location":"user-guide/installation/#clone-and-build","title":"Clone and Build","text":"<pre><code># Clone the repository\ngit clone https://github.com/EvilBit-Labs/opnDossier.git\ncd opnDossier\n\n# Install dependencies and build\njust install\njust build\n\n# Or build manually\ngo build -o opnDossier main.go\n</code></pre>"},{"location":"user-guide/installation/#using-just-task-runner","title":"Using Just (Task Runner)","text":"<p>The project uses Just for task management:</p> <pre><code># Install Just if you don't have it\ncargo install just\n\n# Available tasks\njust --list\n\n# Install dependencies\njust install\n\n# Build the application\njust build\n\n# Run tests\njust test\n\n# Run all quality checks\njust check\n</code></pre>"},{"location":"user-guide/installation/#3-download-pre-built-binaries","title":"3. Download Pre-built Binaries","text":"<p>Pre-built binaries are available for multiple platforms:</p> <pre><code># Download the latest release for your platform\ncurl -L https://github.com/EvilBit-Labs/opnDossier/releases/latest/download/opnDossier-linux-amd64 -o opnDossier\n\n# Download the SHA-256 checksum file for verification\ncurl -L https://github.com/EvilBit-Labs/opnDossier/releases/latest/download/checksums.txt -o checksums.txt\n\n# Verify the binary integrity\nsha256sum -c checksums.txt 2&gt;/dev/null | grep opnDossier-linux-amd64 || \\\nshasum -a 256 -c checksums.txt 2&gt;/dev/null | grep opnDossier-linux-amd64 || \\\necho \"Warning: Could not verify checksum. Proceed with caution.\"\n\n# Make executable and install (only if verification passed)\nchmod +x opnDossier\nsudo mv opnDossier /usr/local/bin/\n\n# Clean up checksum file\nrm checksums.txt\n</code></pre> <p>Security Note: Always verify binary integrity before installation. The checksum verification ensures the binary hasn't been tampered with during download.</p> <p>Available platforms:</p> <ul> <li>Linux (amd64, arm64)</li> <li>macOS (amd64, arm64)</li> <li>Windows (amd64)</li> </ul>"},{"location":"user-guide/installation/#verification","title":"Verification","text":"<p>Verify your installation:</p> <pre><code># Check version\nopnDossier --version\n\n# Test basic functionality\nopnDossier --help\n\n# Verify Fang enhancements are working\nopnDossier completion bash  # Should show bash completion script\n</code></pre>"},{"location":"user-guide/installation/#configuration-setup","title":"Configuration Setup","text":""},{"location":"user-guide/installation/#1-create-configuration-directory","title":"1. Create Configuration Directory","text":"<pre><code># Configuration file location (following XDG Base Directory Specification)\nmkdir -p ~/.config/opnDossier\ntouch ~/.config/opnDossier/config.yaml\n</code></pre>"},{"location":"user-guide/installation/#2-basic-configuration","title":"2. Basic Configuration","text":"<p>Create a basic configuration file:</p> <pre><code># ~/.config/opnDossier/config.yaml\nlog_level: info\nlog_format: text\nverbose: false\nquiet: false\n</code></pre>"},{"location":"user-guide/installation/#3-environment-variables","title":"3. Environment Variables","text":"<p>Set up environment variables for your shell:</p> <pre><code># Add to ~/.bashrc, ~/.zshrc, etc.\nexport OPNDOSSIER_LOG_LEVEL=info\nexport OPNDOSSIER_LOG_FORMAT=text\n</code></pre>"},{"location":"user-guide/installation/#shell-completion","title":"Shell Completion","text":"<p>opnDossier includes shell completion support via Fang:</p>"},{"location":"user-guide/installation/#bash","title":"Bash","text":"<pre><code># Add to ~/.bashrc\nsource &lt;(opnDossier completion bash)\n\n# Or install globally\nopnDossier completion bash &gt; /etc/bash_completion.d/opnDossier\n</code></pre>"},{"location":"user-guide/installation/#zsh","title":"Zsh","text":"<pre><code># Add to ~/.zshrc\nsource &lt;(opnDossier completion zsh)\n\n# Or for oh-my-zsh\nopnDossier completion zsh &gt; ~/.oh-my-zsh/completions/_opnDossier\n</code></pre>"},{"location":"user-guide/installation/#fish","title":"Fish","text":"<pre><code>opnDossier completion fish | source\n\n# Or save to file\nopnDossier completion fish &gt; ~/.config/fish/completions/opnDossier.fish\n</code></pre>"},{"location":"user-guide/installation/#powershell","title":"PowerShell","text":"<pre><code># Add to PowerShell profile\nopnDossier completion powershell | Out-String | Invoke-Expression\n</code></pre>"},{"location":"user-guide/installation/#troubleshooting","title":"Troubleshooting","text":""},{"location":"user-guide/installation/#common-issues","title":"Common Issues","text":"<ol> <li>Command not found</li> </ol> <pre><code># Check if Go bin is in PATH\necho $GOPATH/bin\nexport PATH=$PATH:$GOPATH/bin\n</code></pre> <ol> <li>Permission denied</li> </ol> <pre><code># Make binary executable\nchmod +x opnDossier\n</code></pre> <ol> <li>Config file not found</li> </ol> <pre><code># Verify config file location\nls -la ~/.config/opnDossier/config.yaml\n\n# Use custom config location\nopndossier --config /path/to/config.yaml convert config.xml\n</code></pre>"},{"location":"user-guide/installation/#debugging-installation","title":"Debugging Installation","text":"<pre><code># Check Go environment\ngo env GOPATH GOBIN\n\n# Verify build\ngo version\ngo build -v .\n\n# Test with verbose output\nopndossier --verbose --help\n</code></pre>"},{"location":"user-guide/installation/#development-installation","title":"Development Installation","text":"<p>For development and contributing:</p> <pre><code># Clone with development setup\ngit clone https://github.com/EvilBit-Labs/opnDossier.git\ncd opnDossier\n\n# Install development dependencies\njust install-dev\n\n# Run development checks\njust dev-check\n\n# Set up pre-commit hooks\njust setup-hooks\n</code></pre>"},{"location":"user-guide/installation/#container-installation","title":"Container Installation","text":""},{"location":"user-guide/installation/#docker","title":"Docker","text":"<pre><code># Build container image\ndocker build -t opndossier .\n\n# Run in container\ndocker run --rm -v $(pwd):/data opndossier convert /data/config.xml\n</code></pre>"},{"location":"user-guide/installation/#kubernetes","title":"Kubernetes","text":"<p>The following example mounts the configuration file to <code>/app/config/config.yaml</code> and uses the <code>--config</code> flag to specify its location. Alternatively, you can mount the config to <code>/etc/opndossier/config.yaml</code> or use environment variables for configuration.</p> <p>ConfigMap:</p> <pre><code>apiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: opndossier-config\ndata:\n  config.yaml: |\n    log_level: \"info\"\n    log_format: \"json\"\n</code></pre> <p>Job:</p> <pre><code>apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: opndossier-job\nspec:\n  template:\n    spec:\n      containers:\n        - name: opndossier\n          image: opndossier:latest\n          args: [convert, /data/config.xml, --config, /app/config/config.yaml]\n          volumeMounts:\n            - name: config\n              mountPath: /app/config\n              subPath: config.yaml\n            - name: data\n              mountPath: /data\n      volumes:\n        - name: config\n          configMap:\n            name: opndossier-config\n        - name: data\n          persistentVolumeClaim:\n            claimName: opndossier-data\n      restartPolicy: Never\n</code></pre>"},{"location":"user-guide/installation/#next-steps","title":"Next Steps","text":"<p>After installation:</p> <ol> <li>Read the Configuration Guide to set up your preferences</li> <li>Check the Usage Guide for common workflows</li> <li>Review Examples for practical use cases</li> </ol>"},{"location":"user-guide/installation/#updating","title":"Updating","text":""},{"location":"user-guide/installation/#go-install-method","title":"Go Install Method","text":"<pre><code># Update to latest version\ngo install github.com/EvilBit-Labs/opnDossier@latest\n</code></pre>"},{"location":"user-guide/installation/#source-build-method","title":"Source Build Method","text":"<pre><code># Update source and rebuild\ngit pull origin main\njust build\n</code></pre>"},{"location":"user-guide/installation/#binary-method","title":"Binary Method","text":"<p>Download and replace the binary with the latest release.</p> <p>For installation issues, see our troubleshooting guide or open an issue on GitHub.</p>"},{"location":"user-guide/security-scoring/","title":"Security Scoring Methodology","text":""},{"location":"user-guide/security-scoring/#overview","title":"Overview","text":"<p>The opnDossier security assessment functions provide a standardized approach to evaluating OPNsense configuration security posture. This document explains the risk label mapping and security scoring methodology implemented in the <code>MarkdownBuilder</code> security functions.</p>"},{"location":"user-guide/security-scoring/#risk-label-mapping","title":"Risk Label Mapping","text":"<p>The security assessment uses consistent emoji + text risk labels across all output formats:</p> Severity Label Description <code>critical</code> \ud83d\udd34 Critical Risk Immediate attention required <code>high</code> \ud83d\udfe0 High Risk High priority security concern <code>medium</code> \ud83d\udfe1 Medium Risk Moderate security concern <code>low</code> \ud83d\udfe2 Low Risk Low priority security issue <code>info</code> / <code>informational</code> \u2139\ufe0f Informational Informational finding Unknown/Invalid \u26aa Unknown Risk Unrecognized severity level"},{"location":"user-guide/security-scoring/#usage-in-reports","title":"Usage in Reports","text":"<p>Risk labels are used consistently across:</p> <ul> <li>Template-based markdown generation (<code>getRiskLevel</code> function)</li> <li>Programmatic markdown generation (<code>AssessRiskLevel</code> method)</li> <li>Service risk assessment (<code>AssessServiceRisk</code> method)</li> </ul>"},{"location":"user-guide/security-scoring/#service-risk-assessment","title":"Service Risk Assessment","text":"<p>The <code>AssessServiceRisk()</code> method maps common services to risk levels based on security implications:</p>"},{"location":"user-guide/security-scoring/#critical-risk-services","title":"Critical Risk Services","text":"<ul> <li>Telnet: Unencrypted remote access protocol</li> </ul>"},{"location":"user-guide/security-scoring/#high-risk-services","title":"High Risk Services","text":"<ul> <li>FTP: Unencrypted file transfer protocol</li> <li>VNC: Remote desktop with potential security vulnerabilities</li> </ul>"},{"location":"user-guide/security-scoring/#medium-risk-services","title":"Medium Risk Services","text":"<ul> <li>RDP: Remote desktop protocol with authentication risks</li> </ul>"},{"location":"user-guide/security-scoring/#low-risk-services","title":"Low Risk Services","text":"<ul> <li>SSH: Secure shell with proper authentication</li> </ul>"},{"location":"user-guide/security-scoring/#informational-services","title":"Informational Services","text":"<ul> <li>HTTPS: Secure web services</li> <li>Unknown/Custom: Services not in the risk database</li> </ul>"},{"location":"user-guide/security-scoring/#security-scoring-algorithm","title":"Security Scoring Algorithm","text":"<p>The <code>CalculateSecurityScore()</code> method provides a 0-100 security score based on configuration analysis.</p>"},{"location":"user-guide/security-scoring/#base-score-100-points","title":"Base Score: 100 points","text":""},{"location":"user-guide/security-scoring/#penalty-system","title":"Penalty System","text":"Security Issue Penalty Points Description No Firewall Rules -20 Missing basic firewall protection Management on WAN -30 Administrative services exposed to untrusted networks Insecure Sysctl Settings -5 each Per misconfigured system tunable Default User Accounts -15 each Per default system account (admin, root, user)"},{"location":"user-guide/security-scoring/#sysctl-security-checks","title":"Sysctl Security Checks","text":"<p>The following system tunables are evaluated for security compliance:</p> Tunable Expected Value Security Impact <code>net.inet.ip.forwarding</code> <code>0</code> Prevents IP forwarding unless explicitly needed <code>net.inet6.ip6.forwarding</code> <code>0</code> Prevents IPv6 forwarding unless explicitly needed <code>net.inet.tcp.blackhole</code> <code>2</code> Drops TCP packets to closed ports silently <code>net.inet.udp.blackhole</code> <code>1</code> Drops UDP packets to closed ports silently"},{"location":"user-guide/security-scoring/#management-port-detection","title":"Management Port Detection","text":"<p>The following ports are considered management ports when exposed on WAN:</p> <ul> <li>22 (SSH)</li> <li>80 (HTTP)</li> <li>443 (HTTPS)</li> <li>8080 (Alternative HTTP)</li> </ul>"},{"location":"user-guide/security-scoring/#implementation-notes","title":"Implementation Notes","text":""},{"location":"user-guide/security-scoring/#conservative-heuristics","title":"Conservative Heuristics","text":"<ul> <li>Scoring uses conservative heuristics designed for audit readability</li> <li>Penalties are intentionally conservative to avoid false positives</li> <li>Score is clamped between 0-100 to ensure consistent ranges</li> </ul>"},{"location":"user-guide/security-scoring/#single-source-of-truth","title":"Single Source of Truth","text":"<p>The current implementation provides a transparent wrapper while existing scoring logic is consolidated. Future updates will centralize scoring logic to ensure consistency across the model, processor, and converter layers.</p>"},{"location":"user-guide/security-scoring/#offline-operation","title":"Offline Operation","text":"<p>All security assessment functions operate completely offline with no external dependencies, making them suitable for airgapped environments.</p>"},{"location":"user-guide/security-scoring/#usage-examples","title":"Usage Examples","text":""},{"location":"user-guide/security-scoring/#risk-level-assessment","title":"Risk Level Assessment","text":"<pre><code>builder := NewMarkdownBuilder()\nrisk := builder.AssessRiskLevel(\"high\")\n// Returns: \"\ud83d\udfe0 High Risk\"\n</code></pre>"},{"location":"user-guide/security-scoring/#service-risk-assessment_1","title":"Service Risk Assessment","text":"<pre><code>service := model.Service{Name: \"SSH Daemon\"}\nrisk := builder.AssessServiceRisk(service)\n// Returns: \"\ud83d\udfe2 Low Risk\"\n</code></pre>"},{"location":"user-guide/security-scoring/#security-score-calculation","title":"Security Score Calculation","text":"<pre><code>score := builder.CalculateSecurityScore(opnSenseDocument)\n// Returns: 0-100 integer score\n</code></pre>"},{"location":"user-guide/security-scoring/#integration-with-reports","title":"Integration with Reports","text":""},{"location":"user-guide/security-scoring/#blue-team-reports","title":"Blue Team Reports","text":"<ul> <li>Focus on clarity, grouping, and actionability</li> <li>Include compliance matrices and remediation guidance</li> <li>Highlight security features and vulnerabilities</li> </ul>"},{"location":"user-guide/security-scoring/#red-team-reports","title":"Red Team Reports","text":"<ul> <li>Focus on target prioritization and pivot surface discovery</li> <li>Emphasize attack vectors and exposure points</li> <li>Highlight management interfaces and weak configurations</li> </ul>"},{"location":"user-guide/security-scoring/#standard-reports","title":"Standard Reports","text":"<ul> <li>Balanced view of configuration security posture</li> <li>Include both security strengths and areas for improvement</li> <li>Provide clear recommendations for security hardening</li> </ul>"},{"location":"user-guide/security-scoring/#future-enhancements","title":"Future Enhancements","text":"<ol> <li>Centralized Scoring: Consolidate scoring logic across model, processor, and converter layers</li> <li>Configurable Weights: Allow customization of penalty weights for different environments</li> <li>Extended Service Database: Expand service risk mappings for additional protocols</li> <li>Compliance Integration: Integrate with STIG, SANS, and other compliance frameworks</li> <li>Dynamic Risk Assessment: Incorporate threat intelligence and configuration context</li> </ol>"},{"location":"user-guide/usage/","title":"Usage Guide","text":"<p>This guide covers common workflows and examples for using opnDossier effectively.</p>"},{"location":"user-guide/usage/#basic-usage","title":"Basic Usage","text":""},{"location":"user-guide/usage/#convert-configuration-files","title":"Convert Configuration Files","text":"<p>The primary use case is converting OPNsense configuration files to markdown:</p> <pre><code># Convert to markdown (default format)\nopnDossier convert config.xml\n\n# Convert to markdown and save to file\nopnDossier convert config.xml -o documentation.md\n\n# Convert to markdown format explicitly\nopnDossier convert -f markdown config.xml\n\n# Convert to JSON format\nopnDossier convert -f json config.xml -o output.json\n\n# Convert to YAML format\nopnDossier convert -f yaml config.xml -o output.yaml\n\n# Convert multiple files (each gets appropriate extension)\nopnDossier convert config1.xml config2.xml config3.xml\n\n# Convert multiple files to JSON format\nopnDossier convert -f json config1.xml config2.xml config3.xml\n</code></pre>"},{"location":"user-guide/usage/#display-options","title":"Display Options","text":"<p>Control how output is displayed:</p> <pre><code># Verbose output with debug information\nopndossier --verbose convert config.xml\n\n# Quiet mode - only errors\nopndossier --quiet convert config.xml\n\n# JSON logging format\nopndossier --log_format=json convert config.xml\n\n# Enable validation with verbose output\nopndossier --validate --verbose convert config.xml\n</code></pre>"},{"location":"user-guide/usage/#configuration-management","title":"Configuration Management","text":""},{"location":"user-guide/usage/#using-configuration-files","title":"Using Configuration Files","text":"<p>Create <code>~/.opnDossier.yaml</code> for persistent settings:</p> <pre><code># Default settings for all operations\nlog_level: info\nlog_format: text\noutput_file: ./network-docs.md\nverbose: false\n</code></pre>"},{"location":"user-guide/usage/#environment-variables","title":"Environment Variables","text":"<p>Use environment variables for deployment automation:</p> <pre><code># Set logging preferences\nexport OPNDOSSIER_LOG_LEVEL=debug\nexport OPNDOSSIER_LOG_FORMAT=json\n\n# Set default output location\nexport OPNDOSSIER_OUTPUT_FILE=\"./documentation.md\"\n\n# Run with environment configuration\nopndossier convert config.xml\n</code></pre>"},{"location":"user-guide/usage/#cli-flag-overrides","title":"CLI Flag Overrides","text":"<p>CLI flags have the highest precedence:</p> <pre><code># Override config file settings\nopndossier --log_level=debug --output=custom.md convert config.xml\n\n# Temporary verbose mode\nopndossier --verbose convert config.xml\n\n# Use custom config file\nopndossier --config ./project-config.yaml convert config.xml\n</code></pre>"},{"location":"user-guide/usage/#common-workflows","title":"Common Workflows","text":""},{"location":"user-guide/usage/#1-document-network-configuration","title":"1. Document Network Configuration","text":"<pre><code># Basic documentation workflow\nopndossier convert /etc/opnsense/config.xml -o network-documentation.md\n\n# With verbose logging for troubleshooting\nopndossier --verbose convert /etc/opnsense/config.xml -o network-docs.md\n\n# Generate multiple formats\nopndossier convert config.xml -o current-config.md\nopndossier --log_format=json convert config.xml &gt; config-log.json\n</code></pre>"},{"location":"user-guide/usage/#2-batch-processing","title":"2. Batch Processing","text":"<pre><code># Process multiple configuration files\nopndossier convert *.xml\n\n# Process files in a directory\nfind /path/to/configs -name \"*.xml\" -exec opndossier convert {} \\;\n\n# Process with parallel execution (if multiple files)\nopndossier convert config1.xml config2.xml config3.xml\n</code></pre>"},{"location":"user-guide/usage/#3-automated-documentation-pipeline","title":"3. Automated Documentation Pipeline","text":"<pre><code>#!/bin/bash\n# automation-script.sh\n\n# Set up environment\nexport OPNDOSSIER_LOG_FORMAT=json\nexport OPNDOSSIER_LOG_LEVEL=info\n\n# Process configuration\nopndossier convert /etc/opnsense/config.xml -o ./docs/network-config.md\n\n# Check if successful\nif [ $? -eq 0 ]; then\n    echo \"Documentation generated successfully\"\n    # Additional processing (git commit, upload, etc.)\nelse\n    echo \"Documentation generation failed\"\n    exit 1\nfi\n</code></pre>"},{"location":"user-guide/usage/#4-debugging-and-troubleshooting","title":"4. Debugging and Troubleshooting","text":"<pre><code># Debug XML parsing issues\nopndossier --verbose --log_level=debug convert problematic-config.xml\n\n# Debug with validation enabled\nopndossier --validate --verbose --log_level=debug convert config.xml\n\n# Capture detailed logs\nopndossier --log_format=json --log_level=debug convert config.xml &gt; debug.log 2&gt;&amp;1\n\n# Test configuration loading\nopndossier --verbose --config ./test-config.yaml convert --help\n</code></pre>"},{"location":"user-guide/usage/#validation-and-error-handling","title":"Validation and Error Handling","text":""},{"location":"user-guide/usage/#understanding-validation-output","title":"Understanding Validation Output","text":"<p>opnDossier provides comprehensive validation with detailed error reporting:</p> <pre><code># Enable validation during conversion\nopndossier convert config.xml --validate\n\n# Example validation error output\n# validation error at opnsense.system.hostname: hostname is required\n# validation error at opnsense.interfaces.wan.ipaddr: IP address '300.300.300.300' must be a valid IP address\n</code></pre>"},{"location":"user-guide/usage/#common-validation-errors","title":"Common Validation Errors","text":""},{"location":"user-guide/usage/#missing-required-fields","title":"Missing Required Fields","text":"<pre><code># Error: hostname is required\nopndossier --validate convert incomplete-config.xml\n# Output: validation error at opnsense.system.hostname: hostname is required\n</code></pre>"},{"location":"user-guide/usage/#invalid-network-configuration","title":"Invalid Network Configuration","text":"<pre><code># Error: invalid IP address\nopndossier --validate convert bad-network-config.xml\n# Output: validation error at opnsense.interfaces.lan.ipaddr: IP address '256.256.256.256' must be a valid IP address\n</code></pre>"},{"location":"user-guide/usage/#aggregated-error-reports","title":"Aggregated Error Reports","text":"<pre><code># Multiple validation errors\nopndossier --validate convert multi-error-config.xml\n# Output: validation failed with 3 errors: hostname is required (and 2 more)\n#   - opnsense.system.hostname: hostname is required\n#   - opnsense.system.domain: domain is required\n#   - opnsense.interfaces.lan.subnet: subnet mask '35' must be valid (0-32)\n</code></pre>"},{"location":"user-guide/usage/#streaming-processing","title":"Streaming Processing","text":"<p>opnDossier handles large configuration files efficiently:</p> <pre><code># Process large configuration files\nopndossier convert large-config.xml  # Automatically uses streaming\n\n# Monitor memory usage during processing\nopndossier --verbose convert large-config.xml\n# Output shows memory cleanup after processing large sections\n</code></pre>"},{"location":"user-guide/usage/#advanced-usage","title":"Advanced Usage","text":""},{"location":"user-guide/usage/#configuration-precedence-testing","title":"Configuration Precedence Testing","text":"<p>Test how configuration precedence works:</p> <pre><code># Create test config file\ncat &gt; test-config.yaml &lt;&lt; EOF\nlog_level: \"warn\"\nlog_format: \"json\"\nverbose: false\nEOF\n\n# Test precedence: config file &lt; env vars &lt; CLI flags\nopndossier --config test-config.yaml convert config.xml  # Uses config file settings\nOPNDOSSIER_LOG_LEVEL=info opndossier --config test-config.yaml convert config.xml  # Env var overrides config\nopndossier --config test-config.yaml --log_level=debug convert config.xml  # CLI flag overrides all\n</code></pre>"},{"location":"user-guide/usage/#custom-output-locations","title":"Custom Output Locations","text":"<pre><code># Create output directory structure\nmkdir -p docs/network/{current,archive}\n\n# Generate documentation with custom paths\nopndossier convert config.xml -o docs/network/current/config.md\n\n# Use environment variables for paths\nexport OPNDOSSIER_OUTPUT_FILE=\"docs/network/current/config.md\"\nopndossier convert config.xml\n\n# Batch process to different locations\nfor config in configs/*.xml; do\n    name=$(basename \"$config\" .xml)\n    opndossier convert \"$config\" -o \"docs/${name}.md\"\ndone\n</code></pre>"},{"location":"user-guide/usage/#integration-with-other-tools","title":"Integration with Other Tools","text":""},{"location":"user-guide/usage/#git-integration","title":"Git Integration","text":"<pre><code># Document configuration changes\nopndossier convert config.xml -o current-config.md\ngit add current-config.md\ngit commit -m \"docs: update network configuration documentation\"\n</code></pre>"},{"location":"user-guide/usage/#cicd-pipeline-integration","title":"CI/CD Pipeline Integration","text":"<pre><code># .github/workflows/docs.yml\nname: Generate Documentation\non: [push, pull_request]\n\njobs:\n  docs:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v3\n\n      - name: Setup Go\n        uses: actions/setup-go@v3\n        with:\n          go-version: '1.21'\n      - name: Install opnDossier\n        run: go install github.com/EvilBit-Labs/opnDossier@latest\n\n      - name: Generate Documentation\n        env:\n          OPNDOSSIER_LOG_FORMAT: json\n          OPNDOSSIER_LOG_LEVEL: info\n        run: opndossier convert config.xml -o docs/network-config.md\n\n      - name: Commit Documentation\n        if: github.event_name == 'push'\n        run: |\n          git config --local user.email \"action@github.com\"\n          git config --local user.name \"GitHub Action\"\n          git add docs/network-config.md\n          git commit -m \"docs: update network configuration\" || exit 0\n          git push\n</code></pre>"},{"location":"user-guide/usage/#monitoring-integration","title":"Monitoring Integration","text":"<pre><code># Generate metrics for monitoring\nopndossier --log_format=json convert config.xml 2&gt; metrics.json\n\n# Parse logs for monitoring\njq '.level' metrics.json | sort | uniq -c\n\n# Health check script\n#!/bin/bash\nif opndossier convert config.xml -o /tmp/test.md &gt; /dev/null 2&gt;&amp;1; then\n    echo \"opnDossier: OK\"\n    exit 0\nelse\n    echo \"opnDossier: FAILED\"\n    exit 1\nfi\n</code></pre>"},{"location":"user-guide/usage/#error-handling-and-troubleshooting","title":"Error Handling and Troubleshooting","text":""},{"location":"user-guide/usage/#common-error-scenarios","title":"Common Error Scenarios","text":""},{"location":"user-guide/usage/#1-xml-parsing-errors","title":"1. XML Parsing Errors","text":"<pre><code># Invalid XML structure\nopndossier convert invalid-config.xml\n# Error: failed to parse XML from invalid-config.xml: XML syntax error on line 42\n\n# Debug XML issues\nopndossier --verbose convert invalid-config.xml\n</code></pre>"},{"location":"user-guide/usage/#2-file-permission-issues","title":"2. File Permission Issues","text":"<pre><code># Permission denied\nopndossier convert /root/config.xml\n# Error: failed to open file /root/config.xml: permission denied\n\n# Solution: copy file or adjust permissions\nsudo cp /root/config.xml ./config.xml\nopndossier convert config.xml\n</code></pre>"},{"location":"user-guide/usage/#3-configuration-validation-errors","title":"3. Configuration Validation Errors","text":"<pre><code># Conflicting flags\nopndossier --verbose --quiet convert config.xml\n# Error: verbose and quiet options are mutually exclusive\n\n# Invalid log level\nopndossier --log_level=trace convert config.xml\n# Error: invalid log level 'trace', must be one of: debug, info, warn, error\n</code></pre>"},{"location":"user-guide/usage/#debugging-tips","title":"Debugging Tips","text":"<ol> <li>Use verbose mode for detailed information:</li> </ol> <pre><code>opndossier --verbose convert config.xml\n</code></pre> <ol> <li>Check configuration precedence:</li> </ol> <pre><code>opndossier --verbose --config /path/to/config.yaml convert --help\n</code></pre> <ol> <li>Validate configuration files:</li> </ol> <pre><code># Test config file syntax\nopndossier --config test-config.yaml --help\n</code></pre> <ol> <li>Use JSON logging for automated analysis:</li> </ol> <pre><code>opndossier --log_format=json convert config.xml &gt; output.log 2&gt;&amp;1\njq '.' output.log  # Parse JSON logs\n</code></pre>"},{"location":"user-guide/usage/#performance-optimization","title":"Performance Optimization","text":""},{"location":"user-guide/usage/#large-file-processing","title":"Large File Processing","text":"<pre><code># Process large files efficiently\nopndossier --log_level=warn convert large-config.xml\n\n# Monitor memory usage\n/usr/bin/time -v opndossier convert large-config.xml\n</code></pre>"},{"location":"user-guide/usage/#batch-processing-optimization","title":"Batch Processing Optimization","text":"<pre><code># Process multiple files concurrently (built-in)\nopndossier convert config1.xml config2.xml config3.xml\n\n# Custom parallel processing\nfind /configs -name \"*.xml\" | xargs -P 4 -I {} opndossier convert {} -o {}.md\n</code></pre>"},{"location":"user-guide/usage/#best-practices","title":"Best Practices","text":""},{"location":"user-guide/usage/#1-configuration-management","title":"1. Configuration Management","text":"<ul> <li>Use configuration files for persistent settings</li> <li>Use environment variables for deployment-specific settings</li> <li>Use CLI flags for temporary overrides</li> </ul>"},{"location":"user-guide/usage/#2-file-organization","title":"2. File Organization","text":"<pre><code># Organize output files logically\nopndossier convert config.xml -o docs/network/$(date +%Y-%m-%d)-config.md\n\n# Archive old documentation\nmkdir -p docs/network/archive/$(date +%Y/%m)\nmv docs/network/*.md docs/network/archive/$(date +%Y/%m)/\n</code></pre>"},{"location":"user-guide/usage/#3-automation","title":"3. Automation","text":"<ul> <li>Always use error checking in scripts</li> <li>Use structured logging (JSON) for automated processing</li> <li>Implement health checks for monitoring</li> </ul>"},{"location":"user-guide/usage/#4-security","title":"4. Security","text":"<ul> <li>Keep configuration files in secure locations</li> <li>Use environment variables for sensitive settings (if any)</li> <li>Regularly audit generated documentation for sensitive information</li> </ul> <p>For more advanced examples and specific use cases, see our Examples section.</p>"}]}
{
  "device_type": "opnsense",
  "version": "1.0.0",
  "system": {
    "hostname": "comprehensive-firewall",
    "domain": "security.local",
    "optimization": "aggressive",
    "timezone": "America/New_York",
    "language": "en_US",
    "dnsAllowOverride": true,
    "dnsServers": ["1.1.1.1", "8.8.8.8"],
    "timeServers": ["time.nist.gov", "pool.ntp.org"],
    "ipv6Allow": true,
    "webGui": {
      "protocol": "https",
      "maxProcesses": "2",
      "sslCertRef": "5f7d1a8e9b2c4"
    },
    "ssh": {
      "group": "wheel",
      "port": "22",
      "enabled": true
    },
    "firmware": {
      "version": "24.1.2"
    },
    "bogons": {
      "interval": "weekly"
    }
  },
  "interfaces": [
    {
      "name": "wan",
      "physicalIf": "igb0",
      "enabled": true,
      "ipAddress": "203.0.113.10",
      "subnet": "28",
      "gateway": "203.0.113.1",
      "mtu": "1500",
      "blockPrivate": true,
      "blockBogons": true,
      "description": "WAN (Internet)"
    },
    {
      "name": "lan",
      "physicalIf": "igb1",
      "enabled": true,
      "ipAddress": "192.168.100.1",
      "subnet": "24",
      "mtu": "1500",
      "description": "LAN (Internal)"
    },
    {
      "name": "dmz",
      "physicalIf": "igb2",
      "enabled": true,
      "ipAddress": "10.0.100.1",
      "subnet": "24",
      "mtu": "1500",
      "blockPrivate": true,
      "blockBogons": true,
      "description": "DMZ (Servers)"
    },
    {
      "name": "guest",
      "physicalIf": "igb3",
      "enabled": true,
      "ipAddress": "172.16.1.1",
      "subnet": "24",
      "mtu": "1500",
      "blockPrivate": true,
      "blockBogons": true,
      "description": "Guest Network"
    }
  ],
  "firewallRules": [
    {
      "type": "block",
      "description": "Default deny all",
      "interfaces": ["wan"],
      "ipProtocol": "inet",
      "protocol": "any",
      "source": {
        "address": "any"
      },
      "destination": {
        "address": "any"
      }
    },
    {
      "type": "pass",
      "description": "Allow HTTP/HTTPS",
      "interfaces": ["wan"],
      "ipProtocol": "inet",
      "protocol": "tcp",
      "source": {
        "address": "any"
      },
      "destination": {
        "address": "wan",
        "port": "80,443"
      }
    },
    {
      "type": "pass",
      "description": "Allow LAN to any",
      "interfaces": ["lan"],
      "ipProtocol": "inet",
      "protocol": "any",
      "source": {
        "address": "lan"
      },
      "destination": {
        "address": "any"
      }
    },
    {
      "type": "pass",
      "description": "Allow DMZ to Internet",
      "interfaces": ["dmz"],
      "ipProtocol": "inet",
      "protocol": "tcp",
      "source": {
        "address": "dmz"
      },
      "destination": {
        "address": "!lan,!dmz,!guest"
      }
    },
    {
      "type": "block",
      "description": "Block Guest to LAN",
      "interfaces": ["guest"],
      "ipProtocol": "inet",
      "protocol": "any",
      "source": {
        "address": "guest"
      },
      "destination": {
        "address": "lan,dmz"
      }
    },
    {
      "type": "pass",
      "description": "Allow Guest Internet",
      "interfaces": ["guest"],
      "ipProtocol": "inet",
      "protocol": "tcp",
      "source": {
        "address": "guest"
      },
      "destination": {
        "address": "!lan,!dmz,!guest"
      }
    }
  ],
  "nat": {
    "outboundMode": "automatic",
    "outboundRules": [
      {
        "description": "Auto NAT for LAN",
        "interfaces": ["wan"],
        "source": {
          "address": "lan"
        },
        "destination": {
          "address": "any"
        },
        "target": "wan"
      }
    ],
    "inboundRules": [
      {
        "description": "HTTP to Web Server",
        "interfaces": ["wan"],
        "protocol": "tcp",
        "source": {
          "address": "any"
        },
        "destination": {
          "address": "wan",
          "port": "80"
        },
        "internalIp": "10.0.100.10",
        "localPort": "80"
      },
      {
        "description": "HTTPS to Web Server",
        "interfaces": ["wan"],
        "protocol": "tcp",
        "source": {
          "address": "any"
        },
        "destination": {
          "address": "wan",
          "port": "443"
        },
        "internalIp": "10.0.100.10",
        "localPort": "443"
      }
    ]
  },
  "dhcp": [
    {
      "interface": "lan",
      "enabled": true,
      "range": {
        "from": "192.168.100.50",
        "to": "192.168.100.199"
      },
      "gateway": "192.168.100.1",
      "dnsServer": "192.168.100.1"
    },
    {
      "interface": "guest",
      "enabled": true,
      "range": {
        "from": "172.16.1.50",
        "to": "172.16.1.199"
      },
      "gateway": "172.16.1.1",
      "dnsServer": "1.1.1.1"
    }
  ],
  "dns": {
    "unbound": {
      "enabled": true,
      "dnssec": true
    }
  },
  "snmp": {
    "sysLocation": "Primary Data Center - Rack 42",
    "sysContact": "security-team@company.com",
    "roCommunity": "public_readonly_v3"
  },
  "ntp": {
    "preferredServer": "time.nist.gov"
  },
  "loadBalancer": {
    "monitorTypes": [
      {
        "name": "http-health",
        "type": "http",
        "description": "HTTP Health Check",
        "options": {
          "path": "/health",
          "code": "200"
        }
      },
      {
        "name": "tcp-connect",
        "type": "tcp",
        "description": "TCP Connection Check",
        "options": {}
      },
      {
        "name": "icmp-ping",
        "type": "icmp",
        "description": "ICMP Ping Check",
        "options": {}
      }
    ]
  },
  "users": [
    {
      "name": "admin",
      "description": "System Administrator",
      "groupName": "wheel",
      "scope": "system"
    },
    {
      "name": "operator",
      "description": "Network Operator",
      "groupName": "admins",
      "scope": "local"
    },
    {
      "name": "auditor",
      "description": "Security Auditor",
      "groupName": "readonly",
      "scope": "local"
    }
  ],
  "groups": [
    {
      "name": "wheel",
      "description": "System Administrators",
      "scope": "system"
    },
    {
      "name": "admins",
      "description": "Network Administrators",
      "scope": "local"
    },
    {
      "name": "readonly",
      "description": "Read-only Users",
      "scope": "local"
    }
  ],
  "sysctl": [
    {
      "tunable": "net.inet.ip.forwarding",
      "value": "1",
      "description": "Enable IP forwarding for routing"
    },
    {
      "tunable": "net.inet6.ip6.forwarding",
      "value": "1",
      "description": "Enable IPv6 forwarding"
    },
    {
      "tunable": "net.inet.tcp.blackhole",
      "value": "2",
      "description": "Drop TCP packets to closed ports"
    },
    {
      "tunable": "net.inet.udp.blackhole",
      "value": "1",
      "description": "Drop UDP packets to closed ports"
    },
    {
      "tunable": "security.bsd.see_other_uids",
      "value": "0",
      "description": "Hide processes from other users"
    },
    {
      "tunable": "security.bsd.see_other_gids",
      "value": "0",
      "description": "Hide processes from other groups"
    },
    {
      "tunable": "kern.securelevel",
      "value": "1",
      "description": "Enable secure level 1"
    },
    {
      "tunable": "net.inet.tcp.syncookies",
      "value": "1",
      "description": "Enable SYN cookies for DDoS protection"
    },
    {
      "tunable": "net.inet.icmp.icmplim",
      "value": "50",
      "description": "Limit ICMP response rate"
    },
    {
      "tunable": "net.inet.tcp.always_keepalive",
      "value": "1",
      "description": "Enable TCP keepalive"
    }
  ]
}

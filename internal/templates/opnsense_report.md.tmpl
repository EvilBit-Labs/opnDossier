# OPNsense Configuration Summary

## System Information
- **Hostname**: {{ .System.Hostname }}
- **Domain**: {{ .System.Domain }}
- **Platform**: OPNsense {{ .System.Firmware.Version }}
- **Generated On**: {{ .Generated }}
- **Parsed By**: opnDossier v{{ .ToolVersion }}

---

## Table of Contents

- [Interfaces](#interfaces)
- [Firewall Rules](#firewall-rules)
- [NAT Rules](#nat-rules)
- [DHCP Services](#dhcp-services)
- [DNS Resolver](#dns-resolver)
- [OpenVPN](#openvpn)
- [Gateways](#gateways)
- [System Users](#system-users)
- [Services & Daemons](#services--daemons)
- [Tunables](#tunables)
- [System Notes](#system-notes)

---

## Interfaces

| Name | Description | IP Address | CIDR | Enabled |
|------|-------------|------------|------|---------|
{{- range $name, $iface := .Interfaces.Items }}
| `{{ $name }}` | `{{ if $iface.Descr }}{{ $iface.Descr }}{{ else }}{{ $iface.If }}{{ end }}` | `{{ $iface.IPAddr }}` | /{{ $iface.Subnet }} | {{ formatBoolean $iface.Enable }} |
{{- end }}

---

## Firewall Rules

| # | Interface | Action | IP Ver | Proto | Source | Destination | Target | Source Port | Enabled | Description |
|---|-----------|--------|--------|-------|--------|-------------|--------|-------------|---------|-------------|
{{- range $index, $rule := .Filter.Rule }}
| {{ add $index 1 }} | {{ $rule.Interface }} | {{ $rule.Type }} | {{ $rule.IPProtocol }} | {{ $rule.Protocol }} | {{ $rule.Source.Network }} | {{ $rule.Destination.Network }} | {{ if $rule.Target }}{{ $rule.Target }}{{ else }}-{{ end }} | {{ if $rule.SourcePort }}{{ $rule.SourcePort }}{{ else }}-{{ end }} | {{ formatBoolean (not $rule.Disabled) }} | {{ if $rule.Descr }}{{ $rule.Descr }}{{ else }}-{{ end }} |
{{- end }}

---

## NAT Rules

{{- if .Nat.Outbound.Mode }}
**Mode:** {{ .Nat.Outbound.Mode }}

{{- end }}
| Interface | IP Ver | Protocol | Source | Destination | Target | Source Port | Enabled | Description |
|-----------|--------|----------|--------|-------------|--------|-------------|---------|-------------|
{{- range $index, $rule := .Nat.Outbound.Rule }}
| {{ $rule.Interface }} | {{ $rule.IPProtocol }} | {{ $rule.Protocol }} | {{ $rule.Source.Network }} | {{ if $rule.Destination.Any }}any{{ else }}{{ $rule.Destination.Network }}{{ end }} | {{ $rule.Target }} | {{ $rule.SourcePort }} | {{ formatBoolean (not $rule.Disabled) }} | {{ if $rule.Descr }}{{ $rule.Descr }}{{ else }}-{{ end }} |
{{- end }}

---

## DHCP Services

| Interface | Start IP | End IP | Domain | DNS Servers |
|-----------|----------|--------|--------|--------------|
{{- range $name, $dhcp := .Dhcpd.Items }}
| {{ $name }} | {{ $dhcp.Range.From }} | {{ $dhcp.Range.To }} | - | - |
{{- end }}

### Static Leases

| Hostname | MAC Address | IP | Description |
|----------|-------------|----|-------------|
{{- $hasStaticLeases := false }}
{{- range $name, $dhcp := .Dhcpd.Items }}
{{- if $dhcp.Staticmap }}
{{- $hasStaticLeases = true }}
{{- range $dhcp.Staticmap }}
| `{{ .Hostname }}` | `{{ .Mac }}` | `{{ .IPAddr }}` | `{{ .Descr }}` |
{{- end }}
{{- end }}
{{- end }}
{{- if not $hasStaticLeases }}
| No static leases configured | - | - | - |
{{- end }}

---

## DNS Resolver

- **Enabled**: {{ formatBoolean .Unbound.Enable }}
{{- if .Unbound.Dnssec }}
- **DNSSEC**: {{ formatBoolean .Unbound.Dnssec }}
{{- end }}
{{- if .Unbound.Dnssecstripped }}
- **DNSSEC Stripped**: {{ formatBoolean .Unbound.Dnssecstripped }}
{{- end }}

---

## OpenVPN

| Name | Mode | Local IP | Remote Net | Enabled |
|------|------|----------|------------|---------|
{{- if .OpenVPN.Servers }}
{{- range .OpenVPN.Servers }}
| `{{ .Description }}` | {{ .Mode }} | {{ .Local_port }} | {{ .Remote_network }} | {{ formatBoolean true }} |
{{- end }}
{{- end }}
{{- if .OpenVPN.Clients }}
{{- range .OpenVPN.Clients }}
| `{{ .Description }}` | {{ .Mode }} | {{ .Server_addr }}:{{ .Server_port }} | - | {{ formatBoolean true }} |
{{- end }}
{{- end }}
{{- if and (not .OpenVPN.Servers) (not .OpenVPN.Clients) }}
| No OpenVPN configured | - | - | - | {{ formatBoolean false }} |
{{- end }}

---

## Gateways

| Name | Description | Interface | Gateway | Protocol | Default | Monitor Disable | Interval | Weight | Far Gateway |
|------|-------------|-----------|---------|----------|---------|-----------------|----------|--------|-------------|
{{- if .Gateways.Gateway }}
{{- range .Gateways.Gateway }}
| `{{ .Name }}` | `{{ .Descr }}` | {{ .Interface }} | `{{ .Gateway }}` | {{ .IPProtocol }} | {{ formatBoolean .DefaultGW }} | {{ formatBoolean .MonitorDisable }} | {{ .Interval }} | {{ .Weight }} | {{ formatBoolean .FarGW }} |
{{- end }}
{{- else }}
| No gateways configured | - | - | - | - | - | - | - | - | - |
{{- end }}

---

## System Users

| Username | UID | Group | Shell | Disabled |
|----------|-----|-------|--------|----------|
{{- range .System.User }}
| `{{ .Name }}` | {{ .UID }} | {{ .Groupname }} | - | {{ formatBoolean .Disabled }} |
{{- end }}

---

## Services & Daemons

| Service | Enabled | Notes |
|---------|---------|-------|
| SNMP | {{ formatBoolean .Snmpd.ROCommunity }} | Community: {{ .Snmpd.ROCommunity }} |
| Unbound DNS | {{ formatBoolean .Unbound.Enable }} | {{ if .Unbound.Dnssec }}DNSSEC: {{ formatBoolean .Unbound.Dnssec }}{{ if .Unbound.Dnssecstripped }}, Stripped: {{ formatBoolean .Unbound.Dnssecstripped }}{{ end }}{{ else }}DNSSEC: {{ formatBoolean false }}{{ end }} |
| NTP | {{ formatBoolean .Ntpd.Prefer }} | Prefer: {{ .Ntpd.Prefer }} |

---

## System Tunables

{{- $filteredTunables := filterTunables .Sysctl (index .CustomFields "IncludeTunables") }}
{{- if $filteredTunables }}
| Name | Value | Description |
|------|--------|-------------|
{{- range $filteredTunables }}
| `{{ .Tunable }}` | `{{ .Value }}` | `{{ truncateDescription .Descr 80 }}` |
{{- end }}
{{- else }}
*No customized system tunables found.*
{{- end }}

---

## System Notes

{{- if .System.Notes }}
{{- range .System.Notes }}
```text
{{ . }}
```
{{- end }}
{{- else }}
```text
No system notes configured
```
{{- end }}

---

*Generated by opnDossier. No telemetry. No nonsense.*

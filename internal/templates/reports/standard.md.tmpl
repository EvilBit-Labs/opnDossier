{{/* standard.md.tmpl — Detailed Config Summary */}}

# OpnDossier Summary Report

**Hostname:** `{{ .System.Hostname }}.{{ .System.Domain }}`
**Firmware:** {{ .System.Firmware.Version }}
**Serial:** {{ .System.Serial }}
**Last Revision:** {{ .Revision.Time }}

---

## Interfaces

| Name | Iface | IP | Netmask | Gateway | Enabled | Description |
|------|-------|----|---------|---------|---------|-------------|
{{- range .Interfaces }}
| {{ .Name }} | {{ .If }} | {{ .Ipaddr }} | {{ .Subnet }} | {{ .Gateway }} | {{ .Enabled }} | {{ escapeTableContent .Description }} |
{{- end }}

---

## Certificates

| CN | Expires | Self-Signed | Key Length |
|----|---------|-------------|------------|
{{- range .Certificates }}
| {{ .CN }} | {{ .NotAfter }} | {{ .SelfSigned }} | {{ .KeyLength }} |
{{- end }}

---

## NAT Configuration

{{- if .Nat.Outbound.Mode }}
### NAT Summary
- **NAT Mode**: `{{ .Nat.Outbound.Mode }}`{{- if eq .Nat.Outbound.Mode "automatic" }} *(Automatic outbound NAT generation)*{{- else if eq .Nat.Outbound.Mode "manual" }} *(Manual outbound NAT rules)*{{- else if eq .Nat.Outbound.Mode "advanced" }} *(Advanced outbound NAT rules)*{{- else if eq .Nat.Outbound.Mode "hybrid" }} *(Hybrid automatic/manual outbound NAT)*{{- else if eq .Nat.Outbound.Mode "disabled" }} *(Outbound NAT disabled)*{{- end }}

- **NAT Reflection**: {{ if eq .System.DisableNATReflection "yes" }}**Disabled** ✓{{- else }}**Enabled** ⚠️{{- end }}

- **Port Forward State Sharing**: {{ if eq .System.PfShareForward 1 }}**Enabled**{{- else }}**Disabled**{{- end }}

- **Outbound Rules**: {{ len .Nat.Outbound.Rule }} configured
- **Inbound Rules**: 0 configured

{{- if eq .System.DisableNATReflection "yes" }}
**Security Note**: NAT reflection is properly disabled, preventing potential security issues.
{{- else }}
**⚠️ Security Warning**: NAT reflection is enabled, which may allow internal clients to access internal services via external IP addresses.
{{- end }}
{{- end }}

### Outbound NAT Rules

### Inbound NAT Rules (Port Forwarding)
| # | Interface | External Port | Internal IP | Internal Port | Protocol | Description | Priority | Status |
|---|-----------|---------------|-------------|---------------|----------|-------------|----------|--------|
| - | - | - | - | - | - | No inbound NAT rules configured | - | - |

### Legacy NAT Rules

| Iface | Ext Port | Int IP | Int Port | Description |
|-------|----------|--------|----------|-------------|
{{- range .NAT }}
| {{ .Interface }} | {{ .ExternalPort }} | {{ .InternalIP }} | {{ .InternalPort }} | {{ escapeTableContent .Description }} |
{{- end }}

---

## Firewall Rules

| Iface | Action | Proto | Src → Dst | Target | Source Port | Comment |
|-------|--------|-------|------------|--------|-------------|---------|
{{- range .FirewallRules }}
| {{ .Interface }} | {{ .Action }} | {{ .Protocol }} | {{ .Source }} → {{ .Destination }} | {{ .Target }} | {{ .SourcePort }} | {{ escapeTableContent .Description }} |
{{- end }}

---

## Routes

| Destination | Gateway | Interface | Description |
|-------------|---------|-----------|-------------|
{{- range .Routes }}
| {{ .Destination }} | {{ .Gateway }} | {{ .Interface }} | {{ escapeTableContent .Description }} |
{{- end }}

---

## DHCP Configuration

| Iface | Enabled | Start → End | DNS | Lease Time |
|-------|---------|-------------|-----|------------|
{{- range .DHCP }}
| {{ .Interface }} | {{ .Enabled }} | {{ .RangeStart }} → {{ .RangeEnd }} | {{ .DNS }} | {{ .LeaseTime }} |
{{- end }}

---

## High Availability

- HA Enabled: {{ .HA.Enabled }}
- CARP Status: {{ .HA.CARPStatus }}

---

_This summary report was generated by OpnDossier._
